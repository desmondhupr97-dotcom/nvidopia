const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Dwi2cu_B.js","assets/recharts-BaYsFt1Q.js","assets/antd-5nuAtsbo.js"])))=>i.map(i=>d[i]);
var ti=Object.defineProperty;var or=e=>{throw TypeError(e)};var si=(e,s,n)=>s in e?ti(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n;var cr=(e,s,n)=>si(e,typeof s!="symbol"?s+"":s,n),on=(e,s,n)=>s.has(e)||or("Cannot "+n);var p=(e,s,n)=>(on(e,s,"read from private field"),n?n.call(e):s.get(e)),L=(e,s,n)=>s.has(e)?or("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,n),M=(e,s,n,r)=>(on(e,s,"write to private field"),r?r.call(e,n):s.set(e,n),n),U=(e,s,n)=>(on(e,s,"access private method"),n);var Ms=(e,s,n,r)=>({set _(a){M(e,s,a,n)},get _(){return p(e,s,r)}});import{r as m,M as As,B as Qr,L as xn,d as ni,e as ri,F as N,f as q,h as $t,S as H,I as J,i as Zs,j as Z,k as Se,E as le,l as rs,D as xs,T as Ie,m as K,s as X,n as Ot,C as z,o as ai,p as ae,q as O,t as A,A as jt,u as ii,v as qs,w as li,x as oi,y as ci,z as Gr,G as di,H as Jr,J as Nt,K as ui,N as cn,O as hi,P as Yr,U as mi,Q as Xr,V as Zr,W as ea,X as ta,Y as dr,Z as pi,_ as Lt,$ as dn,a0 as fi,a1 as yi,a2 as gi,a3 as xi,a4 as vi}from"./antd-5nuAtsbo.js";import{R as Tt,L as sa,C as as,X as vt,Y as Ve,T as Ae,a as rt,b as $n,B as Vs,c as Zt,d as es,e as ji,f as bi,P as Si,g as ki,h as _i,i as Ci,j as en,k as tn,S as wi,l as Ii,A as na,m as vn,n as Ri}from"./recharts-BaYsFt1Q.js";import{M as qn,T as Kn,P as vs,a as Bn,b as Un,C as jn,c as Ws,u as Fi,L as ts,d as Pi}from"./maps-fIP_TnRC.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var un={exports:{}},fs={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ur;function Ti(){if(ur)return fs;ur=1;var e=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function n(r,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var o in a)o!=="key"&&(i[o]=a[o])}else i=a;return a=i.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:i}}return fs.Fragment=s,fs.jsx=n,fs.jsxs=n,fs}var hr;function Ei(){return hr||(hr=1,un.exports=Ti()),un.exports}var t=Ei();/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var mr="popstate";function Mi(e={}){function s(r,a){let{pathname:i,search:l,hash:o}=r.location;return bn("",{pathname:i,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:js(a)}return Oi(s,n,null,e)}function ie(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function $e(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function Ai(){return Math.random().toString(36).substring(2,10)}function pr(e,s){return{usr:e.state,key:e.key,idx:s}}function bn(e,s,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof s=="string"?is(s):s,state:n,key:s&&s.key||r||Ai()}}function js({pathname:e="/",search:s="",hash:n=""}){return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function is(e){let s={};if(e){let n=e.indexOf("#");n>=0&&(s.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(s.search=e.substring(r),e=e.substring(0,r)),e&&(s.pathname=e)}return s}function Oi(e,s,n,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,l=a.history,o="POP",d=null,u=c();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function c(){return(l.state||{idx:null}).idx}function h(){o="POP";let b=c(),_=b==null?null:b-u;u=b,d&&d({action:o,location:v.location,delta:_})}function y(b,_){o="PUSH";let R=bn(v.location,b,_);u=c()+1;let C=pr(R,u),w=v.createHref(R);try{l.pushState(C,"",w)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(w)}i&&d&&d({action:o,location:v.location,delta:1})}function f(b,_){o="REPLACE";let R=bn(v.location,b,_);u=c();let C=pr(R,u),w=v.createHref(R);l.replaceState(C,"",w),i&&d&&d({action:o,location:v.location,delta:0})}function g(b){return zi(b)}let v={get action(){return o},get location(){return e(a,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(mr,h),d=b,()=>{a.removeEventListener(mr,h),d=null}},createHref(b){return s(a,b)},createURL:g,encodeLocation(b){let _=g(b);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:y,replace:f,go(b){return l.go(b)}};return v}function zi(e,s=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ie(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:js(e);return r=r.replace(/ $/,"%20"),!s&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function ra(e,s,n="/"){return Li(e,s,n,!1)}function Li(e,s,n,r){let a=typeof s=="string"?is(s):s,i=nt(a.pathname||"/",n);if(i==null)return null;let l=aa(e);Ni(l);let o=null;for(let d=0;o==null&&d<l.length;++d){let u=Gi(i);o=Hi(l[d],u,r)}return o}function aa(e,s=[],n=[],r="",a=!1){let i=(l,o,d=a,u)=>{let c={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(r)&&d)return;ie(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length)}let h=tt([r,c.relativePath]),y=n.concat(c);l.children&&l.children.length>0&&(ie(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),aa(l.children,s,y,h,d)),!(l.path==null&&!l.index)&&s.push({path:h,score:Vi(h,l.index),routesMeta:y})};return e.forEach((l,o)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))i(l,o);else for(let u of ia(l.path))i(l,o,!0,u)}),s}function ia(e){let s=e.split("/");if(s.length===0)return[];let[n,...r]=s,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let l=ia(r.join("/")),o=[];return o.push(...l.map(d=>d===""?i:[i,d].join("/"))),a&&o.push(...l),o.map(d=>e.startsWith("/")&&d===""?"/":d)}function Ni(e){e.sort((s,n)=>s.score!==n.score?n.score-s.score:Wi(s.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Di=/^:[\w-]+$/,$i=3,qi=2,Ki=1,Bi=10,Ui=-2,fr=e=>e==="*";function Vi(e,s){let n=e.split("/"),r=n.length;return n.some(fr)&&(r+=Ui),s&&(r+=qi),n.filter(a=>!fr(a)).reduce((a,i)=>a+(Di.test(i)?$i:i===""?Ki:Bi),r)}function Wi(e,s){return e.length===s.length&&e.slice(0,-1).every((r,a)=>r===s[a])?e[e.length-1]-s[s.length-1]:0}function Hi(e,s,n=!1){let{routesMeta:r}=e,a={},i="/",l=[];for(let o=0;o<r.length;++o){let d=r[o],u=o===r.length-1,c=i==="/"?s:s.slice(i.length)||"/",h=Hs({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},c),y=d.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=Hs({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},c)),!h)return null;Object.assign(a,h.params),l.push({params:a,pathname:tt([i,h.pathname]),pathnameBase:Zi(tt([i,h.pathnameBase])),route:y}),h.pathnameBase!=="/"&&(i=tt([i,h.pathnameBase]))}return l}function Hs(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Qi(e.path,e.caseSensitive,e.end),a=s.match(n);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((u,{paramName:c,isOptional:h},y)=>{if(c==="*"){let g=o[y]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const f=o[y];return h&&!f?u[c]=void 0:u[c]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:l,pattern:e}}function Qi(e,s=!1,n=!0){$e(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,d)=>(r.push({paramName:o,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,s?void 0:"i"),r]}function Gi(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return $e(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),e}}function nt(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}var Ji=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Yi(e,s="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?is(e):e,i;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?i=yr(n.substring(1),"/"):i=yr(n,s)):i=s,{pathname:i,search:el(r),hash:tl(a)}}function yr(e,s){let n=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function hn(e,s,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${s}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Xi(e){return e.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function Vn(e){let s=Xi(e);return s.map((n,r)=>r===s.length-1?n.pathname:n.pathnameBase)}function Wn(e,s,n,r=!1){let a;typeof e=="string"?a=is(e):(a={...e},ie(!a.pathname||!a.pathname.includes("?"),hn("?","pathname","search",a)),ie(!a.pathname||!a.pathname.includes("#"),hn("#","pathname","hash",a)),ie(!a.search||!a.search.includes("#"),hn("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=n;else{let h=s.length-1;if(!r&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),h-=1;a.pathname=y.join("/")}o=h>=0?s[h]:"/"}let d=Yi(a,o),u=l&&l!=="/"&&l.endsWith("/"),c=(i||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||c)&&(d.pathname+="/"),d}var tt=e=>e.join("/").replace(/\/\/+/g,"/"),Zi=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),el=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,tl=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,sl=class{constructor(e,s,n,r=!1){this.status=e,this.statusText=s||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function nl(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function rl(e){return e.map(s=>s.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var la=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function oa(e,s){let n=e;if(typeof n!="string"||!Ji.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,a=!1;if(la)try{let i=new URL(window.location.href),l=n.startsWith("//")?new URL(i.protocol+n):new URL(n),o=nt(l.pathname,s);l.origin===i.origin&&o!=null?n=o+l.search+l.hash:a=!0}catch{$e(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ca=["POST","PUT","PATCH","DELETE"];new Set(ca);var al=["GET",...ca];new Set(al);var ls=m.createContext(null);ls.displayName="DataRouter";var sn=m.createContext(null);sn.displayName="DataRouterState";var il=m.createContext(!1),da=m.createContext({isTransitioning:!1});da.displayName="ViewTransition";var ll=m.createContext(new Map);ll.displayName="Fetchers";var ol=m.createContext(null);ol.displayName="Await";var Fe=m.createContext(null);Fe.displayName="Navigation";var Is=m.createContext(null);Is.displayName="Location";var Oe=m.createContext({outlet:null,matches:[],isDataRoute:!1});Oe.displayName="Route";var Hn=m.createContext(null);Hn.displayName="RouteError";var ua="REACT_ROUTER_ERROR",cl="REDIRECT",dl="ROUTE_ERROR_RESPONSE";function ul(e){if(e.startsWith(`${ua}:${cl}:{`))try{let s=JSON.parse(e.slice(28));if(typeof s=="object"&&s&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.location=="string"&&typeof s.reloadDocument=="boolean"&&typeof s.replace=="boolean")return s}catch{}}function hl(e){if(e.startsWith(`${ua}:${dl}:{`))try{let s=JSON.parse(e.slice(40));if(typeof s=="object"&&s&&typeof s.status=="number"&&typeof s.statusText=="string")return new sl(s.status,s.statusText,s.data)}catch{}}function ml(e,{relative:s}={}){ie(os(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=m.useContext(Fe),{hash:a,pathname:i,search:l}=Rs(e,{relative:s}),o=i;return n!=="/"&&(o=i==="/"?n:tt([n,i])),r.createHref({pathname:o,search:l,hash:a})}function os(){return m.useContext(Is)!=null}function He(){return ie(os(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(Is).location}var ha="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ma(e){m.useContext(Fe).static||m.useLayoutEffect(e)}function zt(){let{isDataRoute:e}=m.useContext(Oe);return e?Rl():pl()}function pl(){ie(os(),"useNavigate() may be used only in the context of a <Router> component.");let e=m.useContext(ls),{basename:s,navigator:n}=m.useContext(Fe),{matches:r}=m.useContext(Oe),{pathname:a}=He(),i=JSON.stringify(Vn(r)),l=m.useRef(!1);return ma(()=>{l.current=!0}),m.useCallback((d,u={})=>{if($e(l.current,ha),!l.current)return;if(typeof d=="number"){n.go(d);return}let c=Wn(d,JSON.parse(i),a,u.relative==="path");e==null&&s!=="/"&&(c.pathname=c.pathname==="/"?s:tt([s,c.pathname])),(u.replace?n.replace:n.push)(c,u.state,u)},[s,n,i,a,e])}var fl=m.createContext(null);function yl(e){let s=m.useContext(Oe).outlet;return m.useMemo(()=>s&&m.createElement(fl.Provider,{value:e},s),[s,e])}function cs(){let{matches:e}=m.useContext(Oe),s=e[e.length-1];return s?s.params:{}}function Rs(e,{relative:s}={}){let{matches:n}=m.useContext(Oe),{pathname:r}=He(),a=JSON.stringify(Vn(n));return m.useMemo(()=>Wn(e,JSON.parse(a),r,s==="path"),[e,a,r,s])}function gl(e,s){return pa(e,s)}function pa(e,s,n,r,a){var R;ie(os(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=m.useContext(Fe),{matches:l}=m.useContext(Oe),o=l[l.length-1],d=o?o.params:{},u=o?o.pathname:"/",c=o?o.pathnameBase:"/",h=o&&o.route;{let C=h&&h.path||"";ya(u,!h||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let y=He(),f;if(s){let C=typeof s=="string"?is(s):s;ie(c==="/"||((R=C.pathname)==null?void 0:R.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${C.pathname}" was given in the \`location\` prop.`),f=C}else f=y;let g=f.pathname||"/",v=g;if(c!=="/"){let C=c.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(C.length).join("/")}let b=ra(e,{pathname:v});$e(h||b!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),$e(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=Sl(b&&b.map(C=>Object.assign({},C,{params:Object.assign({},d,C.params),pathname:tt([c,i.encodeLocation?i.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:tt([c,i.encodeLocation?i.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),l,n,r,a);return s&&_?m.createElement(Is.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},_):_}function xl(){let e=Il(),s=nl(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=m.createElement(m.Fragment,null,m.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:i},"ErrorBoundary")," or"," ",m.createElement("code",{style:i},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},s),n?m.createElement("pre",{style:a},n):null,l)}var vl=m.createElement(xl,null),fa=class extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location||s.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:s.error,location:s.location,revalidation:e.revalidation||s.revalidation}}componentDidCatch(e,s){this.props.onError?this.props.onError(e,s):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=hl(e.digest);n&&(e=n)}let s=e!==void 0?m.createElement(Oe.Provider,{value:this.props.routeContext},m.createElement(Hn.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?m.createElement(jl,{error:e},s):s}};fa.contextType=il;var mn=new WeakMap;function jl({children:e,error:s}){let{basename:n}=m.useContext(Fe);if(typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){let r=ul(s.digest);if(r){let a=mn.get(s);if(a)throw a;let i=oa(r.location,n);if(la&&!mn.get(s))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw mn.set(s,l),l}return m.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function bl({routeContext:e,match:s,children:n}){let r=m.useContext(ls);return r&&r.static&&r.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=s.route.id),m.createElement(Oe.Provider,{value:e},n)}function Sl(e,s=[],n=null,r=null,a=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(s.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,l=n==null?void 0:n.errors;if(l!=null){let c=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);ie(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,c+1))}let o=!1,d=-1;if(n)for(let c=0;c<i.length;c++){let h=i[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=c),h.route.id){let{loaderData:y,errors:f}=n,g=h.route.loader&&!y.hasOwnProperty(h.route.id)&&(!f||f[h.route.id]===void 0);if(h.route.lazy||g){o=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let u=n&&r?(c,h)=>{var y,f;r(c,{location:n.location,params:((f=(y=n.matches)==null?void 0:y[0])==null?void 0:f.params)??{},unstable_pattern:rl(n.matches),errorInfo:h})}:void 0;return i.reduceRight((c,h,y)=>{let f,g=!1,v=null,b=null;n&&(f=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||vl,o&&(d<0&&y===0?(ya("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,b=null):d===y&&(g=!0,b=h.route.hydrateFallbackElement||null)));let _=s.concat(i.slice(0,y+1)),R=()=>{let C;return f?C=v:g?C=b:h.route.Component?C=m.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=c,m.createElement(bl,{match:h,routeContext:{outlet:c,matches:_,isDataRoute:n!=null},children:C})};return n&&(h.route.ErrorBoundary||h.route.errorElement||y===0)?m.createElement(fa,{location:n.location,revalidation:n.revalidation,component:v,error:f,children:R(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:u}):R()},null)}function Qn(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kl(e){let s=m.useContext(ls);return ie(s,Qn(e)),s}function _l(e){let s=m.useContext(sn);return ie(s,Qn(e)),s}function Cl(e){let s=m.useContext(Oe);return ie(s,Qn(e)),s}function Gn(e){let s=Cl(e),n=s.matches[s.matches.length-1];return ie(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function wl(){return Gn("useRouteId")}function Il(){var r;let e=m.useContext(Hn),s=_l("useRouteError"),n=Gn("useRouteError");return e!==void 0?e:(r=s.errors)==null?void 0:r[n]}function Rl(){let{router:e}=kl("useNavigate"),s=Gn("useNavigate"),n=m.useRef(!1);return ma(()=>{n.current=!0}),m.useCallback(async(a,i={})=>{$e(n.current,ha),n.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:s,...i}))},[e,s])}var gr={};function ya(e,s,n){!s&&!gr[e]&&(gr[e]=!0,$e(!1,n))}m.memo(Fl);function Fl({routes:e,future:s,state:n,onError:r}){return pa(e,void 0,n,r,s)}function Pl({to:e,replace:s,state:n,relative:r}){ie(os(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=m.useContext(Fe);$e(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=m.useContext(Oe),{pathname:l}=He(),o=zt(),d=Wn(e,Vn(i),l,r==="path"),u=JSON.stringify(d);return m.useEffect(()=>{o(JSON.parse(u),{replace:s,state:n,relative:r})},[o,u,r,s,n]),null}function Tl(e){return yl(e.context)}function ue(e){ie(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function El({basename:e="/",children:s=null,location:n,navigationType:r="POP",navigator:a,static:i=!1,unstable_useTransitions:l}){ie(!os(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),d=m.useMemo(()=>({basename:o,navigator:a,static:i,unstable_useTransitions:l,future:{}}),[o,a,i,l]);typeof n=="string"&&(n=is(n));let{pathname:u="/",search:c="",hash:h="",state:y=null,key:f="default"}=n,g=m.useMemo(()=>{let v=nt(u,o);return v==null?null:{location:{pathname:v,search:c,hash:h,state:y,key:f},navigationType:r}},[o,u,c,h,y,f,r]);return $e(g!=null,`<Router basename="${o}"> is not able to match the URL "${u}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:m.createElement(Fe.Provider,{value:d},m.createElement(Is.Provider,{children:s,value:g}))}function Ml({children:e,location:s}){return gl(Sn(e),s)}function Sn(e,s=[]){let n=[];return m.Children.forEach(e,(r,a)=>{if(!m.isValidElement(r))return;let i=[...s,a];if(r.type===m.Fragment){n.push.apply(n,Sn(r.props.children,i));return}ie(r.type===ue,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ie(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Sn(r.props.children,i)),n.push(l)}),n}var Ks="get",Bs="application/x-www-form-urlencoded";function nn(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Al(e){return nn(e)&&e.tagName.toLowerCase()==="button"}function Ol(e){return nn(e)&&e.tagName.toLowerCase()==="form"}function zl(e){return nn(e)&&e.tagName.toLowerCase()==="input"}function Ll(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Nl(e,s){return e.button===0&&(!s||s==="_self")&&!Ll(e)}var Os=null;function Dl(){if(Os===null)try{new FormData(document.createElement("form"),0),Os=!1}catch{Os=!0}return Os}var $l=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pn(e){return e!=null&&!$l.has(e)?($e(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bs}"`),null):e}function ql(e,s){let n,r,a,i,l;if(Ol(e)){let o=e.getAttribute("action");r=o?nt(o,s):null,n=e.getAttribute("method")||Ks,a=pn(e.getAttribute("enctype"))||Bs,i=new FormData(e)}else if(Al(e)||zl(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||o.getAttribute("action");if(r=d?nt(d,s):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||Ks,a=pn(e.getAttribute("formenctype"))||pn(o.getAttribute("enctype"))||Bs,i=new FormData(o,e),!Dl()){let{name:u,type:c,value:h}=e;if(c==="image"){let y=u?`${u}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else u&&i.append(u,h)}}else{if(nn(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ks,r=null,a=Bs,l=e}return i&&a==="text/plain"&&(l=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Jn(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function Kl(e,s,n,r){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${r}`:a.pathname=`${a.pathname}.${r}`:a.pathname==="/"?a.pathname=`_root.${r}`:s&&nt(a.pathname,s)==="/"?a.pathname=`${s.replace(/\/$/,"")}/_root.${r}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${r}`,a}async function Bl(e,s){if(e.id in s)return s[e.id];try{let n=await import(e.module);return s[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ul(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Vl(e,s,n){let r=await Promise.all(e.map(async a=>{let i=s.routes[a.route.id];if(i){let l=await Bl(i,n);return l.links?l.links():[]}return[]}));return Gl(r.flat(1).filter(Ul).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function xr(e,s,n,r,a,i){let l=(d,u)=>n[u]?d.route.id!==n[u].route.id:!0,o=(d,u)=>{var c;return n[u].pathname!==d.pathname||((c=n[u].route.path)==null?void 0:c.endsWith("*"))&&n[u].params["*"]!==d.params["*"]};return i==="assets"?s.filter((d,u)=>l(d,u)||o(d,u)):i==="data"?s.filter((d,u)=>{var h;let c=r.routes[d.route.id];if(!c||!c.hasLoader)return!1;if(l(d,u)||o(d,u))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function Wl(e,s,{includeHydrateFallback:n}={}){return Hl(e.map(r=>{let a=s.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function Hl(e){return[...new Set(e)]}function Ql(e){let s={},n=Object.keys(e).sort();for(let r of n)s[r]=e[r];return s}function Gl(e,s){let n=new Set;return new Set(s),e.reduce((r,a)=>{let i=JSON.stringify(Ql(a));return n.has(i)||(n.add(i),r.push({key:i,link:a})),r},[])}function ga(){let e=m.useContext(ls);return Jn(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Jl(){let e=m.useContext(sn);return Jn(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Yn=m.createContext(void 0);Yn.displayName="FrameworkContext";function xa(){let e=m.useContext(Yn);return Jn(e,"You must render this element inside a <HydratedRouter> element"),e}function Yl(e,s){let n=m.useContext(Yn),[r,a]=m.useState(!1),[i,l]=m.useState(!1),{onFocus:o,onBlur:d,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=s,y=m.useRef(null);m.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let v=_=>{_.forEach(R=>{l(R.isIntersecting)})},b=new IntersectionObserver(v,{threshold:.5});return y.current&&b.observe(y.current),()=>{b.disconnect()}}},[e]),m.useEffect(()=>{if(r){let v=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(v)}}},[r]);let f=()=>{a(!0)},g=()=>{a(!1),l(!1)};return n?e!=="intent"?[i,y,{}]:[i,y,{onFocus:ys(o,f),onBlur:ys(d,g),onMouseEnter:ys(u,f),onMouseLeave:ys(c,g),onTouchStart:ys(h,f)}]:[!1,y,{}]}function ys(e,s){return n=>{e&&e(n),n.defaultPrevented||s(n)}}function Xl({page:e,...s}){let{router:n}=ga(),r=m.useMemo(()=>ra(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?m.createElement(eo,{page:e,matches:r,...s}):null}function Zl(e){let{manifest:s,routeModules:n}=xa(),[r,a]=m.useState([]);return m.useEffect(()=>{let i=!1;return Vl(e,s,n).then(l=>{i||a(l)}),()=>{i=!0}},[e,s,n]),r}function eo({page:e,matches:s,...n}){let r=He(),{future:a,manifest:i,routeModules:l}=xa(),{basename:o}=ga(),{loaderData:d,matches:u}=Jl(),c=m.useMemo(()=>xr(e,s,u,i,r,"data"),[e,s,u,i,r]),h=m.useMemo(()=>xr(e,s,u,i,r,"assets"),[e,s,u,i,r]),y=m.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let v=new Set,b=!1;if(s.forEach(R=>{var w;let C=i.routes[R.route.id];!C||!C.hasLoader||(!c.some(F=>F.route.id===R.route.id)&&R.route.id in d&&((w=l[R.route.id])!=null&&w.shouldRevalidate)||C.hasClientLoader?b=!0:v.add(R.route.id))}),v.size===0)return[];let _=Kl(e,o,a.unstable_trailingSlashAwareDataRequests,"data");return b&&v.size>0&&_.searchParams.set("_routes",s.filter(R=>v.has(R.route.id)).map(R=>R.route.id).join(",")),[_.pathname+_.search]},[o,a.unstable_trailingSlashAwareDataRequests,d,r,i,c,s,e,l]),f=m.useMemo(()=>Wl(h,i),[h,i]),g=Zl(h);return m.createElement(m.Fragment,null,y.map(v=>m.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...n})),f.map(v=>m.createElement("link",{key:v,rel:"modulepreload",href:v,...n})),g.map(({key:v,link:b})=>m.createElement("link",{key:v,nonce:n.nonce,...b,crossOrigin:b.crossOrigin??n.crossOrigin})))}function to(...e){return s=>{e.forEach(n=>{typeof n=="function"?n(s):n!=null&&(n.current=s)})}}var so=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{so&&(window.__reactRouterVersion="7.13.0")}catch{}function no({basename:e,children:s,unstable_useTransitions:n,window:r}){let a=m.useRef();a.current==null&&(a.current=Mi({window:r,v5Compat:!0}));let i=a.current,[l,o]=m.useState({action:i.action,location:i.location}),d=m.useCallback(u=>{n===!1?o(u):m.startTransition(()=>o(u))},[n]);return m.useLayoutEffect(()=>i.listen(d),[i,d]),m.createElement(El,{basename:e,children:s,location:l.location,navigationType:l.action,navigator:i,unstable_useTransitions:n})}var va=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ss=m.forwardRef(function({onClick:s,discover:n="render",prefetch:r="none",relative:a,reloadDocument:i,replace:l,state:o,target:d,to:u,preventScrollReset:c,viewTransition:h,unstable_defaultShouldRevalidate:y,...f},g){let{basename:v,unstable_useTransitions:b}=m.useContext(Fe),_=typeof u=="string"&&va.test(u),R=oa(u,v);u=R.to;let C=ml(u,{relative:a}),[w,F,j]=Yl(r,f),S=lo(u,{replace:l,state:o,target:d,preventScrollReset:c,relative:a,viewTransition:h,unstable_defaultShouldRevalidate:y,unstable_useTransitions:b});function I(k){s&&s(k),k.defaultPrevented||S(k)}let T=m.createElement("a",{...f,...j,href:R.absoluteURL||C,onClick:R.isExternal||i?s:I,ref:to(g,F),target:d,"data-discover":!_&&n==="render"?"true":void 0});return w&&!_?m.createElement(m.Fragment,null,T,m.createElement(Xl,{page:C})):T});ss.displayName="Link";var ro=m.forwardRef(function({"aria-current":s="page",caseSensitive:n=!1,className:r="",end:a=!1,style:i,to:l,viewTransition:o,children:d,...u},c){let h=Rs(l,{relative:u.relative}),y=He(),f=m.useContext(sn),{navigator:g,basename:v}=m.useContext(Fe),b=f!=null&&mo(h)&&o===!0,_=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,R=y.pathname,C=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(R=R.toLowerCase(),C=C?C.toLowerCase():null,_=_.toLowerCase()),C&&v&&(C=nt(C,v)||C);const w=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let F=R===_||!a&&R.startsWith(_)&&R.charAt(w)==="/",j=C!=null&&(C===_||!a&&C.startsWith(_)&&C.charAt(_.length)==="/"),S={isActive:F,isPending:j,isTransitioning:b},I=F?s:void 0,T;typeof r=="function"?T=r(S):T=[r,F?"active":null,j?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let k=typeof i=="function"?i(S):i;return m.createElement(ss,{...u,"aria-current":I,className:T,ref:c,style:k,to:l,viewTransition:o},typeof d=="function"?d(S):d)});ro.displayName="NavLink";var ao=m.forwardRef(({discover:e="render",fetcherKey:s,navigate:n,reloadDocument:r,replace:a,state:i,method:l=Ks,action:o,onSubmit:d,relative:u,preventScrollReset:c,viewTransition:h,unstable_defaultShouldRevalidate:y,...f},g)=>{let{unstable_useTransitions:v}=m.useContext(Fe),b=uo(),_=ho(o,{relative:u}),R=l.toLowerCase()==="get"?"get":"post",C=typeof o=="string"&&va.test(o),w=F=>{if(d&&d(F),F.defaultPrevented)return;F.preventDefault();let j=F.nativeEvent.submitter,S=(j==null?void 0:j.getAttribute("formmethod"))||l,I=()=>b(j||F.currentTarget,{fetcherKey:s,method:S,navigate:n,replace:a,state:i,relative:u,preventScrollReset:c,viewTransition:h,unstable_defaultShouldRevalidate:y});v&&n!==!1?m.startTransition(()=>I()):I()};return m.createElement("form",{ref:g,method:R,action:_,onSubmit:r?d:w,...f,"data-discover":!C&&e==="render"?"true":void 0})});ao.displayName="Form";function io(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ja(e){let s=m.useContext(ls);return ie(s,io(e)),s}function lo(e,{target:s,replace:n,state:r,preventScrollReset:a,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:o,unstable_useTransitions:d}={}){let u=zt(),c=He(),h=Rs(e,{relative:i});return m.useCallback(y=>{if(Nl(y,s)){y.preventDefault();let f=n!==void 0?n:js(c)===js(h),g=()=>u(e,{replace:f,state:r,preventScrollReset:a,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:o});d?m.startTransition(()=>g()):g()}},[c,u,h,n,r,s,e,a,i,l,o,d])}var oo=0,co=()=>`__${String(++oo)}__`;function uo(){let{router:e}=ja("useSubmit"),{basename:s}=m.useContext(Fe),n=wl(),r=e.fetch,a=e.navigate;return m.useCallback(async(i,l={})=>{let{action:o,method:d,encType:u,formData:c,body:h}=ql(i,s);if(l.navigate===!1){let y=l.fetcherKey||co();await r(y,n,l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:c,body:h,formMethod:l.method||d,formEncType:l.encType||u,flushSync:l.flushSync})}else await a(l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:c,body:h,formMethod:l.method||d,formEncType:l.encType||u,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,a,s,n])}function ho(e,{relative:s}={}){let{basename:n}=m.useContext(Fe),r=m.useContext(Oe);ie(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...Rs(e||".",{relative:s})},l=He();if(e==null){i.search=l.search;let o=new URLSearchParams(i.search),d=o.getAll("index");if(d.some(c=>c==="")){o.delete("index"),d.filter(h=>h).forEach(h=>o.append("index",h));let c=o.toString();i.search=c?`?${c}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:tt([n,i.pathname])),js(i)}function mo(e,{relative:s}={}){let n=m.useContext(da);ie(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=ja("useViewTransitionState"),a=Rs(e,{relative:s});if(!n.isTransitioning)return!1;let i=nt(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=nt(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Hs(a.pathname,l)!=null||Hs(a.pathname,i)!=null}var ds=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},po={setTimeout:(e,s)=>setTimeout(e,s),clearTimeout:e=>clearTimeout(e),setInterval:(e,s)=>setInterval(e,s),clearInterval:e=>clearInterval(e)},ot,Dn,Lr,fo=(Lr=class{constructor(){L(this,ot,po);L(this,Dn,!1)}setTimeoutProvider(e){M(this,ot,e)}setTimeout(e,s){return p(this,ot).setTimeout(e,s)}clearTimeout(e){p(this,ot).clearTimeout(e)}setInterval(e,s){return p(this,ot).setInterval(e,s)}clearInterval(e){p(this,ot).clearInterval(e)}},ot=new WeakMap,Dn=new WeakMap,Lr),bt=new fo;function yo(e){setTimeout(e,0)}var Mt=typeof window>"u"||"Deno"in globalThis;function je(){}function go(e,s){return typeof e=="function"?e(s):e}function kn(e){return typeof e=="number"&&e>=0&&e!==1/0}function ba(e,s){return Math.max(e+(s||0)-Date.now(),0)}function xt(e,s){return typeof e=="function"?e(s):e}function Te(e,s){return typeof e=="function"?e(s):e}function vr(e,s){const{type:n="all",exact:r,fetchStatus:a,predicate:i,queryKey:l,stale:o}=e;if(l){if(r){if(s.queryHash!==Xn(l,s.options))return!1}else if(!bs(s.queryKey,l))return!1}if(n!=="all"){const d=s.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof o=="boolean"&&s.isStale()!==o||a&&a!==s.state.fetchStatus||i&&!i(s))}function jr(e,s){const{exact:n,status:r,predicate:a,mutationKey:i}=e;if(i){if(!s.options.mutationKey)return!1;if(n){if(At(s.options.mutationKey)!==At(i))return!1}else if(!bs(s.options.mutationKey,i))return!1}return!(r&&s.state.status!==r||a&&!a(s))}function Xn(e,s){return((s==null?void 0:s.queryKeyHashFn)||At)(e)}function At(e){return JSON.stringify(e,(s,n)=>_n(n)?Object.keys(n).sort().reduce((r,a)=>(r[a]=n[a],r),{}):n)}function bs(e,s){return e===s?!0:typeof e!=typeof s?!1:e&&s&&typeof e=="object"&&typeof s=="object"?Object.keys(s).every(n=>bs(e[n],s[n])):!1}var xo=Object.prototype.hasOwnProperty;function Sa(e,s,n=0){if(e===s)return e;if(n>500)return s;const r=br(e)&&br(s);if(!r&&!(_n(e)&&_n(s)))return s;const i=(r?e:Object.keys(e)).length,l=r?s:Object.keys(s),o=l.length,d=r?new Array(o):{};let u=0;for(let c=0;c<o;c++){const h=r?c:l[c],y=e[h],f=s[h];if(y===f){d[h]=y,(r?c<i:xo.call(e,h))&&u++;continue}if(y===null||f===null||typeof y!="object"||typeof f!="object"){d[h]=f;continue}const g=Sa(y,f,n+1);d[h]=g,g===y&&u++}return i===o&&u===i?e:d}function Qs(e,s){if(!s||Object.keys(e).length!==Object.keys(s).length)return!1;for(const n in e)if(e[n]!==s[n])return!1;return!0}function br(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function _n(e){if(!Sr(e))return!1;const s=e.constructor;if(s===void 0)return!0;const n=s.prototype;return!(!Sr(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Sr(e){return Object.prototype.toString.call(e)==="[object Object]"}function vo(e){return new Promise(s=>{bt.setTimeout(s,e)})}function Cn(e,s,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,s):n.structuralSharing!==!1?Sa(e,s):s}function jo(e,s,n=0){const r=[...e,s];return n&&r.length>n?r.slice(1):r}function bo(e,s,n=0){const r=[s,...e];return n&&r.length>n?r.slice(0,-1):r}var Zn=Symbol();function ka(e,s){return!e.queryFn&&(s!=null&&s.initialPromise)?()=>s.initialPromise:!e.queryFn||e.queryFn===Zn?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function er(e,s){return typeof e=="function"?e(...s):!!e}function So(e,s,n){let r=!1,a;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(a??(a=s()),r||(r=!0,a.aborted?n():a.addEventListener("abort",n,{once:!0})),a)}),e}var St,ct,qt,Nr,ko=(Nr=class extends ds{constructor(){super();L(this,St);L(this,ct);L(this,qt);M(this,qt,s=>{if(!Mt&&window.addEventListener){const n=()=>s();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){p(this,ct)||this.setEventListener(p(this,qt))}onUnsubscribe(){var s;this.hasListeners()||((s=p(this,ct))==null||s.call(this),M(this,ct,void 0))}setEventListener(s){var n;M(this,qt,s),(n=p(this,ct))==null||n.call(this),M(this,ct,s(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(s){p(this,St)!==s&&(M(this,St,s),this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(n=>{n(s)})}isFocused(){var s;return typeof p(this,St)=="boolean"?p(this,St):((s=globalThis.document)==null?void 0:s.visibilityState)!=="hidden"}},St=new WeakMap,ct=new WeakMap,qt=new WeakMap,Nr),tr=new ko;function wn(){let e,s;const n=new Promise((a,i)=>{e=a,s=i});n.status="pending",n.catch(()=>{});function r(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{r({status:"fulfilled",value:a}),e(a)},n.reject=a=>{r({status:"rejected",reason:a}),s(a)},n}var _o=yo;function Co(){let e=[],s=0,n=o=>{o()},r=o=>{o()},a=_o;const i=o=>{s?e.push(o):a(()=>{n(o)})},l=()=>{const o=e;e=[],o.length&&a(()=>{r(()=>{o.forEach(d=>{n(d)})})})};return{batch:o=>{let d;s++;try{d=o()}finally{s--,s||l()}return d},batchCalls:o=>(...d)=>{i(()=>{o(...d)})},schedule:i,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{a=o}}}var me=Co(),Kt,dt,Bt,Dr,wo=(Dr=class extends ds{constructor(){super();L(this,Kt,!0);L(this,dt);L(this,Bt);M(this,Bt,s=>{if(!Mt&&window.addEventListener){const n=()=>s(!0),r=()=>s(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){p(this,dt)||this.setEventListener(p(this,Bt))}onUnsubscribe(){var s;this.hasListeners()||((s=p(this,dt))==null||s.call(this),M(this,dt,void 0))}setEventListener(s){var n;M(this,Bt,s),(n=p(this,dt))==null||n.call(this),M(this,dt,s(this.setOnline.bind(this)))}setOnline(s){p(this,Kt)!==s&&(M(this,Kt,s),this.listeners.forEach(r=>{r(s)}))}isOnline(){return p(this,Kt)}},Kt=new WeakMap,dt=new WeakMap,Bt=new WeakMap,Dr),Gs=new wo;function Io(e){return Math.min(1e3*2**e,3e4)}function _a(e){return(e??"online")==="online"?Gs.isOnline():!0}var In=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Ca(e){let s=!1,n=0,r;const a=wn(),i=()=>a.status!=="pending",l=v=>{var b;if(!i()){const _=new In(v);y(_),(b=e.onCancel)==null||b.call(e,_)}},o=()=>{s=!0},d=()=>{s=!1},u=()=>tr.isFocused()&&(e.networkMode==="always"||Gs.isOnline())&&e.canRun(),c=()=>_a(e.networkMode)&&e.canRun(),h=v=>{i()||(r==null||r(),a.resolve(v))},y=v=>{i()||(r==null||r(),a.reject(v))},f=()=>new Promise(v=>{var b;r=_=>{(i()||u())&&v(_)},(b=e.onPause)==null||b.call(e)}).then(()=>{var v;r=void 0,i()||(v=e.onContinue)==null||v.call(e)}),g=()=>{if(i())return;let v;const b=n===0?e.initialPromise:void 0;try{v=b??e.fn()}catch(_){v=Promise.reject(_)}Promise.resolve(v).then(h).catch(_=>{var j;if(i())return;const R=e.retry??(Mt?0:3),C=e.retryDelay??Io,w=typeof C=="function"?C(n,_):C,F=R===!0||typeof R=="number"&&n<R||typeof R=="function"&&R(n,_);if(s||!F){y(_);return}n++,(j=e.onFail)==null||j.call(e,n,_),vo(w).then(()=>u()?void 0:f()).then(()=>{s?y(_):g()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(r==null||r(),a),cancelRetry:o,continueRetry:d,canStart:c,start:()=>(c()?g():f().then(g),a)}}var kt,$r,wa=($r=class{constructor(){L(this,kt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),kn(this.gcTime)&&M(this,kt,bt.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Mt?1/0:300*1e3))}clearGcTimeout(){p(this,kt)&&(bt.clearTimeout(p(this,kt)),M(this,kt,void 0))}},kt=new WeakMap,$r),_t,Ut,Pe,Ct,pe,Ss,wt,Le,Qe,qr,Ro=(qr=class extends wa{constructor(s){super();L(this,Le);L(this,_t);L(this,Ut);L(this,Pe);L(this,Ct);L(this,pe);L(this,Ss);L(this,wt);M(this,wt,!1),M(this,Ss,s.defaultOptions),this.setOptions(s.options),this.observers=[],M(this,Ct,s.client),M(this,Pe,p(this,Ct).getQueryCache()),this.queryKey=s.queryKey,this.queryHash=s.queryHash,M(this,_t,_r(this.options)),this.state=s.state??p(this,_t),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var s;return(s=p(this,pe))==null?void 0:s.promise}setOptions(s){if(this.options={...p(this,Ss),...s},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=_r(this.options);n.data!==void 0&&(this.setState(kr(n.data,n.dataUpdatedAt)),M(this,_t,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&p(this,Pe).remove(this)}setData(s,n){const r=Cn(this.state.data,s,this.options);return U(this,Le,Qe).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(s,n){U(this,Le,Qe).call(this,{type:"setState",state:s,setStateOptions:n})}cancel(s){var r,a;const n=(r=p(this,pe))==null?void 0:r.promise;return(a=p(this,pe))==null||a.cancel(s),n?n.then(je).catch(je):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(p(this,_t))}isActive(){return this.observers.some(s=>Te(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Zn||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>xt(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!ba(this.state.dataUpdatedAt,s)}onFocus(){var n;const s=this.observers.find(r=>r.shouldFetchOnWindowFocus());s==null||s.refetch({cancelRefetch:!1}),(n=p(this,pe))==null||n.continue()}onOnline(){var n;const s=this.observers.find(r=>r.shouldFetchOnReconnect());s==null||s.refetch({cancelRefetch:!1}),(n=p(this,pe))==null||n.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),p(this,Pe).notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(n=>n!==s),this.observers.length||(p(this,pe)&&(p(this,wt)?p(this,pe).cancel({revert:!0}):p(this,pe).cancelRetry()),this.scheduleGc()),p(this,Pe).notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||U(this,Le,Qe).call(this,{type:"invalidate"})}async fetch(s,n){var d,u,c,h,y,f,g,v,b,_,R,C;if(this.state.fetchStatus!=="idle"&&((d=p(this,pe))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(p(this,pe))return p(this,pe).continueRetry(),p(this,pe).promise}if(s&&this.setOptions(s),!this.options.queryFn){const w=this.observers.find(F=>F.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(M(this,wt,!0),r.signal)})},i=()=>{const w=ka(this.options,n),j=(()=>{const S={client:p(this,Ct),queryKey:this.queryKey,meta:this.meta};return a(S),S})();return M(this,wt,!1),this.options.persister?this.options.persister(w,j,this):w(j)},o=(()=>{const w={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:p(this,Ct),state:this.state,fetchFn:i};return a(w),w})();(u=this.options.behavior)==null||u.onFetch(o,this),M(this,Ut,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&U(this,Le,Qe).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),M(this,pe,Ca({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,onCancel:w=>{w instanceof In&&w.revert&&this.setState({...p(this,Ut),fetchStatus:"idle"}),r.abort()},onFail:(w,F)=>{U(this,Le,Qe).call(this,{type:"failed",failureCount:w,error:F})},onPause:()=>{U(this,Le,Qe).call(this,{type:"pause"})},onContinue:()=>{U(this,Le,Qe).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=await p(this,pe).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(f=(y=p(this,Pe).config).onSuccess)==null||f.call(y,w,this),(v=(g=p(this,Pe).config).onSettled)==null||v.call(g,w,this.state.error,this),w}catch(w){if(w instanceof In){if(w.silent)return p(this,pe).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw U(this,Le,Qe).call(this,{type:"error",error:w}),(_=(b=p(this,Pe).config).onError)==null||_.call(b,w,this),(C=(R=p(this,Pe).config).onSettled)==null||C.call(R,this.state.data,w,this),w}finally{this.scheduleGc()}}},_t=new WeakMap,Ut=new WeakMap,Pe=new WeakMap,Ct=new WeakMap,pe=new WeakMap,Ss=new WeakMap,wt=new WeakMap,Le=new WeakSet,Qe=function(s){const n=r=>{switch(s.type){case"failed":return{...r,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...Ia(r.data,this.options),fetchMeta:s.meta??null};case"success":const a={...r,...kr(s.data,s.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return M(this,Ut,s.manual?a:void 0),a;case"error":const i=s.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...s.state}}};this.state=n(this.state),me.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),p(this,Pe).notify({query:this,type:"updated",action:s})})},qr);function Ia(e,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_a(s.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function kr(e,s){return{data:e,dataUpdatedAt:s??Date.now(),error:null,isInvalidated:!1,status:"success"}}function _r(e){const s=typeof e.initialData=="function"?e.initialData():e.initialData,n=s!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var _e,Q,ks,ve,It,Vt,Ge,ut,_s,Wt,Ht,Rt,Ft,ht,Qt,ee,gs,Rn,Fn,Pn,Tn,En,Mn,An,Ra,Kr,Fo=(Kr=class extends ds{constructor(s,n){super();L(this,ee);L(this,_e);L(this,Q);L(this,ks);L(this,ve);L(this,It);L(this,Vt);L(this,Ge);L(this,ut);L(this,_s);L(this,Wt);L(this,Ht);L(this,Rt);L(this,Ft);L(this,ht);L(this,Qt,new Set);this.options=n,M(this,_e,s),M(this,ut,null),M(this,Ge,wn()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(p(this,Q).addObserver(this),Cr(p(this,Q),this.options)?U(this,ee,gs).call(this):this.updateResult(),U(this,ee,Tn).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return On(p(this,Q),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return On(p(this,Q),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,U(this,ee,En).call(this),U(this,ee,Mn).call(this),p(this,Q).removeObserver(this)}setOptions(s){const n=this.options,r=p(this,Q);if(this.options=p(this,_e).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Te(this.options.enabled,p(this,Q))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");U(this,ee,An).call(this),p(this,Q).setOptions(this.options),n._defaulted&&!Qs(this.options,n)&&p(this,_e).getQueryCache().notify({type:"observerOptionsUpdated",query:p(this,Q),observer:this});const a=this.hasListeners();a&&wr(p(this,Q),r,this.options,n)&&U(this,ee,gs).call(this),this.updateResult(),a&&(p(this,Q)!==r||Te(this.options.enabled,p(this,Q))!==Te(n.enabled,p(this,Q))||xt(this.options.staleTime,p(this,Q))!==xt(n.staleTime,p(this,Q)))&&U(this,ee,Rn).call(this);const i=U(this,ee,Fn).call(this);a&&(p(this,Q)!==r||Te(this.options.enabled,p(this,Q))!==Te(n.enabled,p(this,Q))||i!==p(this,ht))&&U(this,ee,Pn).call(this,i)}getOptimisticResult(s){const n=p(this,_e).getQueryCache().build(p(this,_e),s),r=this.createResult(n,s);return To(this,r)&&(M(this,ve,r),M(this,Vt,this.options),M(this,It,p(this,Q).state)),r}getCurrentResult(){return p(this,ve)}trackResult(s,n){return new Proxy(s,{get:(r,a)=>(this.trackProp(a),n==null||n(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&p(this,Ge).status==="pending"&&p(this,Ge).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,a))})}trackProp(s){p(this,Qt).add(s)}getCurrentQuery(){return p(this,Q)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const n=p(this,_e).defaultQueryOptions(s),r=p(this,_e).getQueryCache().build(p(this,_e),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(s){return U(this,ee,gs).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),p(this,ve)))}createResult(s,n){var T;const r=p(this,Q),a=this.options,i=p(this,ve),l=p(this,It),o=p(this,Vt),u=s!==r?s.state:p(this,ks),{state:c}=s;let h={...c},y=!1,f;if(n._optimisticResults){const k=this.hasListeners(),x=!k&&Cr(s,n),E=k&&wr(s,r,n,a);(x||E)&&(h={...h,...Ia(c.data,s.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:v,status:b}=h;f=h.data;let _=!1;if(n.placeholderData!==void 0&&f===void 0&&b==="pending"){let k;i!=null&&i.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(k=i.data,_=!0):k=typeof n.placeholderData=="function"?n.placeholderData((T=p(this,Ht))==null?void 0:T.state.data,p(this,Ht)):n.placeholderData,k!==void 0&&(b="success",f=Cn(i==null?void 0:i.data,k,n),y=!0)}if(n.select&&f!==void 0&&!_)if(i&&f===(l==null?void 0:l.data)&&n.select===p(this,_s))f=p(this,Wt);else try{M(this,_s,n.select),f=n.select(f),f=Cn(i==null?void 0:i.data,f,n),M(this,Wt,f),M(this,ut,null)}catch(k){M(this,ut,k)}p(this,ut)&&(g=p(this,ut),f=p(this,Wt),v=Date.now(),b="error");const R=h.fetchStatus==="fetching",C=b==="pending",w=b==="error",F=C&&R,j=f!==void 0,I={status:b,fetchStatus:h.fetchStatus,isPending:C,isSuccess:b==="success",isError:w,isInitialLoading:F,isLoading:F,data:f,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:R,isRefetching:R&&!C,isLoadingError:w&&!j,isPaused:h.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:w&&j,isStale:sr(s,n),refetch:this.refetch,promise:p(this,Ge),isEnabled:Te(n.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const k=I.data!==void 0,x=I.status==="error"&&!k,E=ce=>{x?ce.reject(I.error):k&&ce.resolve(I.data)},$=()=>{const ce=M(this,Ge,I.promise=wn());E(ce)},se=p(this,Ge);switch(se.status){case"pending":s.queryHash===r.queryHash&&E(se);break;case"fulfilled":(x||I.data!==se.value)&&$();break;case"rejected":(!x||I.error!==se.reason)&&$();break}}return I}updateResult(){const s=p(this,ve),n=this.createResult(p(this,Q),this.options);if(M(this,It,p(this,Q).state),M(this,Vt,this.options),p(this,It).data!==void 0&&M(this,Ht,p(this,Q)),Qs(n,s))return;M(this,ve,n);const r=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!p(this,Qt).size)return!0;const l=new Set(i??p(this,Qt));return this.options.throwOnError&&l.add("error"),Object.keys(p(this,ve)).some(o=>{const d=o;return p(this,ve)[d]!==s[d]&&l.has(d)})};U(this,ee,Ra).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&U(this,ee,Tn).call(this)}},_e=new WeakMap,Q=new WeakMap,ks=new WeakMap,ve=new WeakMap,It=new WeakMap,Vt=new WeakMap,Ge=new WeakMap,ut=new WeakMap,_s=new WeakMap,Wt=new WeakMap,Ht=new WeakMap,Rt=new WeakMap,Ft=new WeakMap,ht=new WeakMap,Qt=new WeakMap,ee=new WeakSet,gs=function(s){U(this,ee,An).call(this);let n=p(this,Q).fetch(this.options,s);return s!=null&&s.throwOnError||(n=n.catch(je)),n},Rn=function(){U(this,ee,En).call(this);const s=xt(this.options.staleTime,p(this,Q));if(Mt||p(this,ve).isStale||!kn(s))return;const r=ba(p(this,ve).dataUpdatedAt,s)+1;M(this,Rt,bt.setTimeout(()=>{p(this,ve).isStale||this.updateResult()},r))},Fn=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(p(this,Q)):this.options.refetchInterval)??!1},Pn=function(s){U(this,ee,Mn).call(this),M(this,ht,s),!(Mt||Te(this.options.enabled,p(this,Q))===!1||!kn(p(this,ht))||p(this,ht)===0)&&M(this,Ft,bt.setInterval(()=>{(this.options.refetchIntervalInBackground||tr.isFocused())&&U(this,ee,gs).call(this)},p(this,ht)))},Tn=function(){U(this,ee,Rn).call(this),U(this,ee,Pn).call(this,U(this,ee,Fn).call(this))},En=function(){p(this,Rt)&&(bt.clearTimeout(p(this,Rt)),M(this,Rt,void 0))},Mn=function(){p(this,Ft)&&(bt.clearInterval(p(this,Ft)),M(this,Ft,void 0))},An=function(){const s=p(this,_e).getQueryCache().build(p(this,_e),this.options);if(s===p(this,Q))return;const n=p(this,Q);M(this,Q,s),M(this,ks,s.state),this.hasListeners()&&(n==null||n.removeObserver(this),s.addObserver(this))},Ra=function(s){me.batch(()=>{s.listeners&&this.listeners.forEach(n=>{n(p(this,ve))}),p(this,_e).getQueryCache().notify({query:p(this,Q),type:"observerResultsUpdated"})})},Kr);function Po(e,s){return Te(s.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&s.retryOnMount===!1)}function Cr(e,s){return Po(e,s)||e.state.data!==void 0&&On(e,s,s.refetchOnMount)}function On(e,s,n){if(Te(s.enabled,e)!==!1&&xt(s.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&sr(e,s)}return!1}function wr(e,s,n,r){return(e!==s||Te(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&sr(e,n)}function sr(e,s){return Te(s.enabled,e)!==!1&&e.isStaleByTime(xt(s.staleTime,e))}function To(e,s){return!Qs(e.getCurrentResult(),s)}function Ir(e){return{onFetch:(s,n)=>{var c,h,y,f,g;const r=s.options,a=(y=(h=(c=s.fetchOptions)==null?void 0:c.meta)==null?void 0:h.fetchMore)==null?void 0:y.direction,i=((f=s.state.data)==null?void 0:f.pages)||[],l=((g=s.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},d=0;const u=async()=>{let v=!1;const b=C=>{So(C,()=>s.signal,()=>v=!0)},_=ka(s.options,s.fetchOptions),R=async(C,w,F)=>{if(v)return Promise.reject();if(w==null&&C.pages.length)return Promise.resolve(C);const S=(()=>{const x={client:s.client,queryKey:s.queryKey,pageParam:w,direction:F?"backward":"forward",meta:s.options.meta};return b(x),x})(),I=await _(S),{maxPages:T}=s.options,k=F?bo:jo;return{pages:k(C.pages,I,T),pageParams:k(C.pageParams,w,T)}};if(a&&i.length){const C=a==="backward",w=C?Eo:Rr,F={pages:i,pageParams:l},j=w(r,F);o=await R(F,j,C)}else{const C=e??i.length;do{const w=d===0?l[0]??r.initialPageParam:Rr(r,o);if(d>0&&w==null)break;o=await R(o,w),d++}while(d<C)}return o};s.options.persister?s.fetchFn=()=>{var v,b;return(b=(v=s.options).persister)==null?void 0:b.call(v,u,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},n)}:s.fetchFn=u}}}function Rr(e,{pages:s,pageParams:n}){const r=s.length-1;return s.length>0?e.getNextPageParam(s[r],s,n[r],n):void 0}function Eo(e,{pages:s,pageParams:n}){var r;return s.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,s[0],s,n[0],n):void 0}var Cs,Ke,ye,Pt,Be,lt,Br,Mo=(Br=class extends wa{constructor(s){super();L(this,Be);L(this,Cs);L(this,Ke);L(this,ye);L(this,Pt);M(this,Cs,s.client),this.mutationId=s.mutationId,M(this,ye,s.mutationCache),M(this,Ke,[]),this.state=s.state||Fa(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){p(this,Ke).includes(s)||(p(this,Ke).push(s),this.clearGcTimeout(),p(this,ye).notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){M(this,Ke,p(this,Ke).filter(n=>n!==s)),this.scheduleGc(),p(this,ye).notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){p(this,Ke).length||(this.state.status==="pending"?this.scheduleGc():p(this,ye).remove(this))}continue(){var s;return((s=p(this,Pt))==null?void 0:s.continue())??this.execute(this.state.variables)}async execute(s){var l,o,d,u,c,h,y,f,g,v,b,_,R,C,w,F,j,S;const n=()=>{U(this,Be,lt).call(this,{type:"continue"})},r={client:p(this,Cs),meta:this.options.meta,mutationKey:this.options.mutationKey};M(this,Pt,Ca({fn:()=>this.options.mutationFn?this.options.mutationFn(s,r):Promise.reject(new Error("No mutationFn found")),onFail:(I,T)=>{U(this,Be,lt).call(this,{type:"failed",failureCount:I,error:T})},onPause:()=>{U(this,Be,lt).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>p(this,ye).canRun(this)}));const a=this.state.status==="pending",i=!p(this,Pt).canStart();try{if(a)n();else{U(this,Be,lt).call(this,{type:"pending",variables:s,isPaused:i}),p(this,ye).config.onMutate&&await p(this,ye).config.onMutate(s,this,r);const T=await((o=(l=this.options).onMutate)==null?void 0:o.call(l,s,r));T!==this.state.context&&U(this,Be,lt).call(this,{type:"pending",context:T,variables:s,isPaused:i})}const I=await p(this,Pt).start();return await((u=(d=p(this,ye).config).onSuccess)==null?void 0:u.call(d,I,s,this.state.context,this,r)),await((h=(c=this.options).onSuccess)==null?void 0:h.call(c,I,s,this.state.context,r)),await((f=(y=p(this,ye).config).onSettled)==null?void 0:f.call(y,I,null,this.state.variables,this.state.context,this,r)),await((v=(g=this.options).onSettled)==null?void 0:v.call(g,I,null,s,this.state.context,r)),U(this,Be,lt).call(this,{type:"success",data:I}),I}catch(I){try{await((_=(b=p(this,ye).config).onError)==null?void 0:_.call(b,I,s,this.state.context,this,r))}catch(T){Promise.reject(T)}try{await((C=(R=this.options).onError)==null?void 0:C.call(R,I,s,this.state.context,r))}catch(T){Promise.reject(T)}try{await((F=(w=p(this,ye).config).onSettled)==null?void 0:F.call(w,void 0,I,this.state.variables,this.state.context,this,r))}catch(T){Promise.reject(T)}try{await((S=(j=this.options).onSettled)==null?void 0:S.call(j,void 0,I,s,this.state.context,r))}catch(T){Promise.reject(T)}throw U(this,Be,lt).call(this,{type:"error",error:I}),I}finally{p(this,ye).runNext(this)}}},Cs=new WeakMap,Ke=new WeakMap,ye=new WeakMap,Pt=new WeakMap,Be=new WeakSet,lt=function(s){const n=r=>{switch(s.type){case"failed":return{...r,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...r,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:s.error,failureCount:r.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=n(this.state),me.batch(()=>{p(this,Ke).forEach(r=>{r.onMutationUpdate(s)}),p(this,ye).notify({mutation:this,type:"updated",action:s})})},Br);function Fa(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Je,Ne,ws,Ur,Ao=(Ur=class extends ds{constructor(s={}){super();L(this,Je);L(this,Ne);L(this,ws);this.config=s,M(this,Je,new Set),M(this,Ne,new Map),M(this,ws,0)}build(s,n,r){const a=new Mo({client:s,mutationCache:this,mutationId:++Ms(this,ws)._,options:s.defaultMutationOptions(n),state:r});return this.add(a),a}add(s){p(this,Je).add(s);const n=zs(s);if(typeof n=="string"){const r=p(this,Ne).get(n);r?r.push(s):p(this,Ne).set(n,[s])}this.notify({type:"added",mutation:s})}remove(s){if(p(this,Je).delete(s)){const n=zs(s);if(typeof n=="string"){const r=p(this,Ne).get(n);if(r)if(r.length>1){const a=r.indexOf(s);a!==-1&&r.splice(a,1)}else r[0]===s&&p(this,Ne).delete(n)}}this.notify({type:"removed",mutation:s})}canRun(s){const n=zs(s);if(typeof n=="string"){const r=p(this,Ne).get(n),a=r==null?void 0:r.find(i=>i.state.status==="pending");return!a||a===s}else return!0}runNext(s){var r;const n=zs(s);if(typeof n=="string"){const a=(r=p(this,Ne).get(n))==null?void 0:r.find(i=>i!==s&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){me.batch(()=>{p(this,Je).forEach(s=>{this.notify({type:"removed",mutation:s})}),p(this,Je).clear(),p(this,Ne).clear()})}getAll(){return Array.from(p(this,Je))}find(s){const n={exact:!0,...s};return this.getAll().find(r=>jr(n,r))}findAll(s={}){return this.getAll().filter(n=>jr(s,n))}notify(s){me.batch(()=>{this.listeners.forEach(n=>{n(s)})})}resumePausedMutations(){const s=this.getAll().filter(n=>n.state.isPaused);return me.batch(()=>Promise.all(s.map(n=>n.continue().catch(je))))}},Je=new WeakMap,Ne=new WeakMap,ws=new WeakMap,Ur);function zs(e){var s;return(s=e.options.scope)==null?void 0:s.id}var Ye,mt,Ce,Xe,st,Us,zn,Vr,Oo=(Vr=class extends ds{constructor(n,r){super();L(this,st);L(this,Ye);L(this,mt);L(this,Ce);L(this,Xe);M(this,Ye,n),this.setOptions(r),this.bindMethods(),U(this,st,Us).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const r=this.options;this.options=p(this,Ye).defaultMutationOptions(n),Qs(this.options,r)||p(this,Ye).getMutationCache().notify({type:"observerOptionsUpdated",mutation:p(this,Ce),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&At(r.mutationKey)!==At(this.options.mutationKey)?this.reset():((a=p(this,Ce))==null?void 0:a.state.status)==="pending"&&p(this,Ce).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=p(this,Ce))==null||n.removeObserver(this)}onMutationUpdate(n){U(this,st,Us).call(this),U(this,st,zn).call(this,n)}getCurrentResult(){return p(this,mt)}reset(){var n;(n=p(this,Ce))==null||n.removeObserver(this),M(this,Ce,void 0),U(this,st,Us).call(this),U(this,st,zn).call(this)}mutate(n,r){var a;return M(this,Xe,r),(a=p(this,Ce))==null||a.removeObserver(this),M(this,Ce,p(this,Ye).getMutationCache().build(p(this,Ye),this.options)),p(this,Ce).addObserver(this),p(this,Ce).execute(n)}},Ye=new WeakMap,mt=new WeakMap,Ce=new WeakMap,Xe=new WeakMap,st=new WeakSet,Us=function(){var r;const n=((r=p(this,Ce))==null?void 0:r.state)??Fa();M(this,mt,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},zn=function(n){me.batch(()=>{var r,a,i,l,o,d,u,c;if(p(this,Xe)&&this.hasListeners()){const h=p(this,mt).variables,y=p(this,mt).context,f={client:p(this,Ye),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(a=(r=p(this,Xe)).onSuccess)==null||a.call(r,n.data,h,y,f)}catch(g){Promise.reject(g)}try{(l=(i=p(this,Xe)).onSettled)==null||l.call(i,n.data,null,h,y,f)}catch(g){Promise.reject(g)}}else if((n==null?void 0:n.type)==="error"){try{(d=(o=p(this,Xe)).onError)==null||d.call(o,n.error,h,y,f)}catch(g){Promise.reject(g)}try{(c=(u=p(this,Xe)).onSettled)==null||c.call(u,void 0,n.error,h,y,f)}catch(g){Promise.reject(g)}}}this.listeners.forEach(h=>{h(p(this,mt))})})},Vr),Ue,Wr,zo=(Wr=class extends ds{constructor(s={}){super();L(this,Ue);this.config=s,M(this,Ue,new Map)}build(s,n,r){const a=n.queryKey,i=n.queryHash??Xn(a,n);let l=this.get(i);return l||(l=new Ro({client:s,queryKey:a,queryHash:i,options:s.defaultQueryOptions(n),state:r,defaultOptions:s.getQueryDefaults(a)}),this.add(l)),l}add(s){p(this,Ue).has(s.queryHash)||(p(this,Ue).set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const n=p(this,Ue).get(s.queryHash);n&&(s.destroy(),n===s&&p(this,Ue).delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){me.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return p(this,Ue).get(s)}getAll(){return[...p(this,Ue).values()]}find(s){const n={exact:!0,...s};return this.getAll().find(r=>vr(n,r))}findAll(s={}){const n=this.getAll();return Object.keys(s).length>0?n.filter(r=>vr(s,r)):n}notify(s){me.batch(()=>{this.listeners.forEach(n=>{n(s)})})}onFocus(){me.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){me.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},Ue=new WeakMap,Wr),oe,pt,ft,Gt,Jt,yt,Yt,Xt,Hr,Lo=(Hr=class{constructor(e={}){L(this,oe);L(this,pt);L(this,ft);L(this,Gt);L(this,Jt);L(this,yt);L(this,Yt);L(this,Xt);M(this,oe,e.queryCache||new zo),M(this,pt,e.mutationCache||new Ao),M(this,ft,e.defaultOptions||{}),M(this,Gt,new Map),M(this,Jt,new Map),M(this,yt,0)}mount(){Ms(this,yt)._++,p(this,yt)===1&&(M(this,Yt,tr.subscribe(async e=>{e&&(await this.resumePausedMutations(),p(this,oe).onFocus())})),M(this,Xt,Gs.subscribe(async e=>{e&&(await this.resumePausedMutations(),p(this,oe).onOnline())})))}unmount(){var e,s;Ms(this,yt)._--,p(this,yt)===0&&((e=p(this,Yt))==null||e.call(this),M(this,Yt,void 0),(s=p(this,Xt))==null||s.call(this),M(this,Xt,void 0))}isFetching(e){return p(this,oe).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return p(this,pt).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const s=this.defaultQueryOptions({queryKey:e});return(n=p(this,oe).get(s.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const s=this.defaultQueryOptions(e),n=p(this,oe).build(this,s),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(xt(s.staleTime,n))&&this.prefetchQuery(s),Promise.resolve(r))}getQueriesData(e){return p(this,oe).findAll(e).map(({queryKey:s,state:n})=>{const r=n.data;return[s,r]})}setQueryData(e,s,n){const r=this.defaultQueryOptions({queryKey:e}),a=p(this,oe).get(r.queryHash),i=a==null?void 0:a.state.data,l=go(s,i);if(l!==void 0)return p(this,oe).build(this,r).setData(l,{...n,manual:!0})}setQueriesData(e,s,n){return me.batch(()=>p(this,oe).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,s,n)]))}getQueryState(e){var n;const s=this.defaultQueryOptions({queryKey:e});return(n=p(this,oe).get(s.queryHash))==null?void 0:n.state}removeQueries(e){const s=p(this,oe);me.batch(()=>{s.findAll(e).forEach(n=>{s.remove(n)})})}resetQueries(e,s){const n=p(this,oe);return me.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},s)))}cancelQueries(e,s={}){const n={revert:!0,...s},r=me.batch(()=>p(this,oe).findAll(e).map(a=>a.cancel(n)));return Promise.all(r).then(je).catch(je)}invalidateQueries(e,s={}){return me.batch(()=>(p(this,oe).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},s)))}refetchQueries(e,s={}){const n={...s,cancelRefetch:s.cancelRefetch??!0},r=me.batch(()=>p(this,oe).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,n);return n.throwOnError||(i=i.catch(je)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(je)}fetchQuery(e){const s=this.defaultQueryOptions(e);s.retry===void 0&&(s.retry=!1);const n=p(this,oe).build(this,s);return n.isStaleByTime(xt(s.staleTime,n))?n.fetch(s):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(je).catch(je)}fetchInfiniteQuery(e){return e.behavior=Ir(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(je).catch(je)}ensureInfiniteQueryData(e){return e.behavior=Ir(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Gs.isOnline()?p(this,pt).resumePausedMutations():Promise.resolve()}getQueryCache(){return p(this,oe)}getMutationCache(){return p(this,pt)}getDefaultOptions(){return p(this,ft)}setDefaultOptions(e){M(this,ft,e)}setQueryDefaults(e,s){p(this,Gt).set(At(e),{queryKey:e,defaultOptions:s})}getQueryDefaults(e){const s=[...p(this,Gt).values()],n={};return s.forEach(r=>{bs(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,s){p(this,Jt).set(At(e),{mutationKey:e,defaultOptions:s})}getMutationDefaults(e){const s=[...p(this,Jt).values()],n={};return s.forEach(r=>{bs(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const s={...p(this,ft).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return s.queryHash||(s.queryHash=Xn(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===Zn&&(s.enabled=!1),s}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...p(this,ft).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){p(this,oe).clear(),p(this,pt).clear()}},oe=new WeakMap,pt=new WeakMap,ft=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,yt=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,Hr),Pa=m.createContext(void 0),qe=e=>{const s=m.useContext(Pa);if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},No=({client:e,children:s})=>(m.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(Pa.Provider,{value:e,children:s})),Ta=m.createContext(!1),Do=()=>m.useContext(Ta);Ta.Provider;function $o(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var qo=m.createContext($o()),Ko=()=>m.useContext(qo),Bo=(e,s,n)=>{const r=n!=null&&n.state.error&&typeof e.throwOnError=="function"?er(e.throwOnError,[n.state.error,n]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(s.isReset()||(e.retryOnMount=!1))},Uo=e=>{m.useEffect(()=>{e.clearReset()},[e])},Vo=({result:e,errorResetBoundary:s,throwOnError:n,query:r,suspense:a})=>e.isError&&!s.isReset()&&!e.isFetching&&r&&(a&&e.data===void 0||er(n,[e.error,r])),Wo=e=>{if(e.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...a)=>n(r(...a)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Ho=(e,s)=>e.isLoading&&e.isFetching&&!s,Qo=(e,s)=>(e==null?void 0:e.suspense)&&s.isPending,Fr=(e,s,n)=>s.fetchOptimistic(e).catch(()=>{n.clearReset()});function Go(e,s,n){var y,f,g,v;const r=Do(),a=Ko(),i=qe(),l=i.defaultQueryOptions(e);(f=(y=i.getDefaultOptions().queries)==null?void 0:y._experimental_beforeQuery)==null||f.call(y,l);const o=i.getQueryCache().get(l.queryHash);l._optimisticResults=r?"isRestoring":"optimistic",Wo(l),Bo(l,a,o),Uo(a);const d=!i.getQueryCache().get(l.queryHash),[u]=m.useState(()=>new s(i,l)),c=u.getOptimisticResult(l),h=!r&&e.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(b=>{const _=h?u.subscribe(me.batchCalls(b)):je;return u.updateResult(),_},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),m.useEffect(()=>{u.setOptions(l)},[l,u]),Qo(l,c))throw Fr(l,u,a);if(Vo({result:c,errorResetBoundary:a,throwOnError:l.throwOnError,query:o,suspense:l.suspense}))throw c.error;if((v=(g=i.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||v.call(g,l,c),l.experimental_prefetchInRender&&!Mt&&Ho(c,r)){const b=d?Fr(l,u,a):o==null?void 0:o.promise;b==null||b.catch(je).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function B(e,s){return Go(e,Fo)}function fe(e,s){const n=qe(),[r]=m.useState(()=>new Oo(n,e));m.useEffect(()=>{r.setOptions(e)},[r,e]);const a=m.useSyncExternalStore(m.useCallback(l=>r.subscribe(me.batchCalls(l)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=m.useCallback((l,o)=>{r.mutate(l,o).catch(je)},[r]);if(a.error&&er(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ea=(...e)=>e.filter((s,n,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===n).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=m.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:l,...o},d)=>m.createElement("svg",{ref:d,...Yo,width:s,height:s,stroke:e,strokeWidth:r?Number(n)*24/Number(s):n,className:Ea("lucide",a),...o},[...l.map(([u,c])=>m.createElement(u,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=(e,s)=>{const n=m.forwardRef(({className:r,...a},i)=>m.createElement(Xo,{ref:i,iconNode:s,className:Ea(`lucide-${Jo(e)}`,r),...a}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=te("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=te("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=te("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=te("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=te("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=te("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=te("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=te("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=te("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=te("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=te("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=te("GitGraph",[["circle",{cx:"5",cy:"6",r:"3",key:"1qnov2"}],["path",{d:"M5 9v6",key:"158jrl"}],["circle",{cx:"5",cy:"18",r:"3",key:"104gr9"}],["path",{d:"M12 3v18",key:"108xh3"}],["circle",{cx:"19",cy:"6",r:"3",key:"108a5v"}],["path",{d:"M16 15.7A9 9 0 0 0 19 9",key:"1e3vqb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=te("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=te("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=te("MonitorPlay",[["path",{d:"M10 7.75a.75.75 0 0 1 1.142-.638l3.664 2.249a.75.75 0 0 1 0 1.278l-3.664 2.25a.75.75 0 0 1-1.142-.64z",key:"1pctta"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",key:"x3v2xh"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oc=te("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=te("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=te("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=te("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=te("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=te("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=te("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=te("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=te("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=te("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=te("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=te("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),De={width:14,height:14,strokeWidth:1.8},gc=[{key:"/projects",icon:t.jsx(Oa,{...De}),label:"Projects"},{key:"/tasks",icon:t.jsx(za,{...De}),label:"Tasks"},{key:"/runs",icon:t.jsx(rn,{...De}),label:"Runs"},{key:"/issues",icon:t.jsx(Ma,{...De}),label:"Issues"},{key:"/kpi",icon:t.jsx(Aa,{...De}),label:"KPI Dashboard"},{key:"/traceability",icon:t.jsx(ic,{...De}),label:"Traceability"}],xc=[{key:"/fleet",icon:t.jsx(fc,{...De}),label:"Fleet Overview"},{key:"/fleet/trajectory",icon:t.jsx(uc,{...De}),label:"Trajectory"},{key:"/fleet/issues-map",icon:t.jsx(La,{...De}),label:"Issue Map"}],vc=[{key:"/simulation",icon:t.jsx(oc,{...De}),label:"Simulation"}],jc=[{key:"/auto-triage",icon:t.jsx(hc,{...De}),label:t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:6},children:["Auto-Triage",t.jsx(Qr,{count:"WIP",style:{backgroundColor:"rgba(0,255,65,0.1)",color:"#00FF41",fontSize:8,fontWeight:600,boxShadow:"none",letterSpacing:"0.04em",fontFamily:"var(--font-mono)"}})]})}],Pr={padding:"2px 20px 2px",fontSize:9,color:"#00FF41",textTransform:"uppercase",letterSpacing:"0.1em",fontFamily:"var(--font-mono)",fontWeight:600,opacity:.5},fn={height:1,background:"rgba(0,255,65,0.06)",margin:"8px 16px"};function bc(){const e=He(),s=zt(),n=e.pathname.split("/").filter(Boolean),r=n[0]==="fleet"&&n.length>1?`/${n[0]}/${n[1]}`:"/"+n[0],a=({key:i})=>{s(i)};return t.jsxs("div",{className:"glass-sidebar",style:{display:"flex",flexDirection:"column",height:"100%"},children:[t.jsxs("div",{className:"sidebar-brand",children:[t.jsx("div",{className:"sidebar-logo",children:"N"}),t.jsx("span",{className:"sidebar-title",children:"NVIDOPIA"})]}),t.jsxs("div",{style:{flex:1,paddingTop:4,overflow:"auto"},children:[t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[r],onClick:a,items:gc,style:{borderInlineEnd:"none"}}),t.jsx("div",{style:fn}),t.jsx("div",{style:Pr,children:"// fleet"}),t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[r],onClick:a,items:xc,style:{borderInlineEnd:"none"}}),t.jsx("div",{style:fn}),t.jsx("div",{style:Pr,children:"// simulation"}),t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[r],onClick:a,items:vc,style:{borderInlineEnd:"none"}}),t.jsx("div",{style:fn}),t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[r],onClick:a,items:jc,style:{borderInlineEnd:"none"}})]}),t.jsx("div",{className:"sidebar-footer",children:t.jsxs("div",{className:"sidebar-footer-text",children:[t.jsx("span",{style:{color:"#00FF41"},children:"$"})," nvidopia ",t.jsx("span",{style:{color:"#3d6b3d"},children:"v0.1"})]})})]})}const{Sider:Sc,Header:kc,Content:_c}=xn,Cc={projects:"Projects",tasks:"Tasks",runs:"Runs",issues:"Issues",kpi:"KPI Dashboard",traceability:"Traceability","auto-triage":"Auto-Triage",simulation:"Simulation"};function wc(){const{pathname:e}=He(),s=e.split("/").filter(Boolean),n=[{title:t.jsx(ss,{to:"/",children:t.jsx(ni,{style:{fontSize:14}})})},...s.map((r,a)=>{const i="/"+s.slice(0,a+1).join("/"),l=Cc[r]??r;return{title:a===s.length-1?t.jsx("span",{children:l}):t.jsx(ss,{to:i,children:l})}})];return t.jsx(ri,{items:n})}function Ic(){return t.jsxs(xn,{style:{minHeight:"100vh",position:"relative",zIndex:1},children:[t.jsx(Sc,{width:260,style:{position:"fixed",left:0,top:0,bottom:0,zIndex:10,overflow:"auto"},children:t.jsx(bc,{})}),t.jsxs(xn,{style:{marginLeft:260},children:[t.jsx(kc,{className:"glass-header",style:{position:"sticky",top:0,zIndex:9,display:"flex",alignItems:"center",padding:"0 28px",height:64},children:t.jsx(wc,{})}),t.jsx(_c,{style:{padding:"28px",minHeight:"calc(100vh - 64px)"},children:t.jsx("div",{className:"animate-fade-in",children:t.jsx(Tl,{})})})]})]})}const Rc="/api";class Fc extends Error{constructor(s,n){super(n),this.status=s,this.name="ApiError"}}function Y(e,s=""){return typeof e=="string"?e:s}function V(e){return typeof e=="string"?e:void 0}function Ze(e){return typeof e=="number"?e:void 0}function an(e,s){const n={};for(const[r,a]of Object.entries(e))!s.has(r)&&!r.startsWith("_")&&(n[r]=a);return e.extra&&typeof e.extra=="object"&&Object.assign(n,e.extra),n}const Pc=new Set(["id","project_id","name","description","status","vehicle_platform","soc_architecture","sensor_suite_version","software_baseline_version","target_mileage_km","start_date","end_date","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Ka(e){return{id:Y(e.id??e.project_id),name:Y(e.name,"Unnamed Project"),description:V(e.description),status:Y(e.status,"Planning"),vehicle_platform:V(e.vehicle_platform),soc_architecture:V(e.soc_architecture),sensor_suite_version:V(e.sensor_suite_version),software_baseline_version:V(e.software_baseline_version),target_mileage_km:Ze(e.target_mileage_km),start_date:V(e.start_date),extra:an(e,Pc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}const Tc=new Set(["id","task_id","project_id","projectId","name","title","description","stage","status","task_type","taskType","priority","assignee","assigned_to","execution_region","executionRegion","target_vehicle_count","targetVehicleCount","simulation_ref","simulation_status","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Ba(e){return{id:Y(e.id??e.task_id),projectId:Y(e.projectId??e.project_id),title:Y(e.title??e.name??e.task_id,"Untitled Task"),description:V(e.description),stage:Y(e.stage??e.status,"Pending"),taskType:V(e.task_type??e.taskType),priority:Y(e.priority,"Medium"),assignee:V(e.assignee??e.assigned_to),executionRegion:V(e.execution_region??e.executionRegion),targetVehicleCount:Ze(e.target_vehicle_count??e.targetVehicleCount),extra:an(e,Tc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}const Ec=new Set(["id","run_id","task_id","taskId","vehicle_vin","vehicleIds","driver_id","start_time","startedAt","end_time","completedAt","total_auto_mileage_km","software_version_hash","hardware_heartbeat_version","status","result","simulation_ref","simulation_status","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Ua(e){const s=V(e.vehicle_vin);return{id:Y(e.id??e.run_id),taskId:Y(e.taskId??e.task_id),status:Y(e.status,"Scheduled"),vehicleIds:Array.isArray(e.vehicleIds)?e.vehicleIds:s?[s]:[],startedAt:V(e.startedAt??e.start_time),completedAt:V(e.completedAt??e.end_time),totalAutoMileageKm:Ze(e.total_auto_mileage_km),result:V(e.result),extra:an(e,Ec),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}const Mc=new Set(["id","issue_id","run_id","runId","task_id","taskId","title","description","status","severity","category","assignee","assigned_to","module","assigned_module","takeover_type","takeoverType","gps_coordinates","gps_lat","gps_lng","data_snapshot_uri","data_snapshot_url","trigger_timestamp","fault_codes","environment_tags","triage_mode","triage_hint","triage_source","fix_commit_id","fix_version_hash","rejection_reason","vehicle_dynamics","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Va(e){const s=Y(e.id??e.issue_id),n=V(e.category),r=e.gps_coordinates;return{id:s,title:Y(e.title,n?`${n} (${s})`:`Issue ${s}`),description:V(e.description),status:Y(e.status,"New"),severity:Y(e.severity,"Medium"),category:n,runId:V(e.runId??e.run_id),taskId:V(e.taskId??e.task_id),assignee:V(e.assignee??e.assigned_to),module:V(e.module??e.assigned_module),takeoverType:V(e.takeover_type??e.takeoverType),gpsLat:Ze(e.gps_lat)??Ze(r==null?void 0:r.lat),gpsLng:Ze(e.gps_lng)??Ze(r==null?void 0:r.lng),dataSnapshotUri:V(e.data_snapshot_uri??e.data_snapshot_url),triggerTimestamp:V(e.trigger_timestamp),faultCodes:Array.isArray(e.fault_codes)?e.fault_codes:void 0,environmentTags:Array.isArray(e.environment_tags)?e.environment_tags:void 0,triageMode:V(e.triage_mode),triageHint:V(e.triage_hint),fixCommitId:V(e.fix_commit_id),rejectionReason:V(e.rejection_reason),vehicleDynamics:e.vehicle_dynamics,extra:an(e,Mc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}function Ac(e){return{id:Y(e.id??e.transition_id),fromStatus:Y(e.from_status??e.fromStatus??e.from),toStatus:Y(e.to_status??e.toStatus??e.to),triggeredBy:Y(e.triggered_by??e.triggeredBy),transitionedAt:V(e.transitioned_at??e.created_at),reason:V(e.reason)}}async function D(e,s){const n=await fetch(`${Rc}${e}`,{...s,headers:{"Content-Type":"application/json",...s==null?void 0:s.headers}});if(!n.ok){const r=await n.text().catch(()=>"");throw new Fc(n.status,r||n.statusText)}if(n.status!==204)return n.json()}function ge(e){if(!e)return"";const s={projectId:"project_id",taskId:"task_id",runId:"run_id",vehicleVin:"vehicle_vin",startDate:"start_date",endDate:"end_date",timeRange:"time_range"},n=Object.fromEntries(Object.entries(e).filter(([,a])=>a!==void 0&&a!=="").map(([a,i])=>[s[a]??a,i])),r=new URLSearchParams(n).toString();return r?`?${r}`:""}async function us(e){const s=ge(e),n=await D(`/projects${s}`);return(Array.isArray(n)?n:n.data??n.items??[]).map(a=>Ka(a))}function Wa(e){return D(`/projects/${e}`).then(Ka)}function Oc(e){return D("/projects",{method:"POST",body:JSON.stringify(e)})}function zc(e,s){return D(`/projects/${e}`,{method:"PUT",body:JSON.stringify(s)})}async function Fs(e){const s=ge(e),n=await D(`/tasks${s}`);return(Array.isArray(n)?n:n.data??[]).map(a=>Ba(a))}function Lc(e){return D(`/tasks/${e}`).then(Ba)}function Nc(e){return D("/tasks",{method:"POST",body:JSON.stringify(e)})}function Dc(e){return D(`/tasks/${e}/advance-stage`,{method:"PUT"})}async function Ps(e){const s=ge(e),n=await D(`/runs${s}`);return(Array.isArray(n)?n:n.data??[]).map(a=>Ua(a))}function $c(e){return D(`/runs/${e}`).then(Ua)}function Ha(e){return{id:Y(e.vin??e._id??e.id),vin:Y(e.vin),name:Y(e.vin??e.name,"Unknown"),status:Y(e.current_status??e.status,"Offline"),platform:V(e.vehicle_platform??e.platform),plateType:V(e.plate_type),modelCode:V(e.model_code),socArchitecture:V(e.soc_architecture),sensorSuiteVersion:V(e.sensor_suite_version),componentVersions:e.component_versions,currentSpeed:Ze(e.current_speed_mps),drivingMode:V(e.driving_mode),currentLocation:e.current_location,fuelOrBatteryLevel:Ze(e.fuel_or_battery_level),lastHeartbeat:V(e.last_heartbeat),updatedAt:V(e.updated_at??e.updatedAt)}}async function nr(e){const s=ge(e),n=await D(`/vehicles${s}`);return(Array.isArray(n)?n:n.data??[]).map(a=>Ha(a))}function qc(e){return D(`/vehicles/${e}`).then(Ha)}function Kc(e,s){return D(`/vehicles/${e}/status-distribution${ge(s)}`)}function Bc(e,s){return D(`/vehicles/${e}/trajectory${ge(s)}`)}function Uc(){return D("/fleet/distribution")}function Vc(){return D("/fleet/status-distribution")}function Wc(e){return D(`/trajectory/query${ge(e)}`)}function Hc(e){return D(`/trajectory/issues${ge(e)}`)}async function Qc(e){const s=ge(e),n=await D(`/issues${s}`);return(Array.isArray(n)?n:n.data??[]).map(a=>Va(a))}function Gc(e){return D(`/issues/${e}`).then(Va)}function Jc(e,s){return D(`/issues/${e}/transition`,{method:"PUT",body:JSON.stringify(s)})}function Yc(e,s){return D(`/issues/${e}/triage`,{method:"POST",body:JSON.stringify({assigned_to:s.assignee,assigned_module:s.module,triggered_by:s.triggered_by??"ui-user"})})}async function Xc(e){const s=await D(`/issues/${e}/transitions`);return{items:(Array.isArray(s)?s:s.items??[]).map(Ac)}}function Zc(e){return D(`/traceability/forward/${e}`)}function ed(e){return D(`/traceability/backward/${e}`)}const td=Zc,sd=ed;function nd(e){return D("/traceability/coverage").then(s=>({total:Number(s.total??s.total_requirements??0),covered:Number(s.covered??s.covered_requirements??0),percentage:Number(s.percentage??s.coverage_percentage??0),details:Array.isArray(s.details)?s.details:[]}))}function rd(e){return D(`/kpi/mpi${ge(e)}`)}function ad(e){return D(`/kpi/mttr${ge(e)}`)}function id(e){return D(`/kpi/regression-pass-rate${ge(e)}`)}function ld(e){return D(`/kpi/fleet-utilization${ge(e)}`)}function od(e){return D(`/kpi/issue-convergence${ge(e)}`).then(s=>{const n=Array.isArray(s.series)?s.series:[];return{value:Number(s.value??0),unit:Y(s.unit,""),points:n.map(r=>({timestamp:Y(r.date),value:Number(r.new_issues??0),dimensions:{open_count:Number(r.new_issues??0),closed_count:Number(r.closed_issues??0)}})),...s}})}function cd(e){return D(`/issues/${e}/snapshot`)}function dd(e){return D(`/issues/${e}/timeseries`)}function ud(e){const s=e?`/schema/fields/${e}`:"/schema/fields";return D(s)}function hd(){return D("/kpi/definitions")}function md(e){return D("/kpi/definitions",{method:"POST",body:JSON.stringify(e)})}function pd(e,s){return D(`/kpi/definitions/${e}`,{method:"PUT",body:JSON.stringify(s)})}function fd(e){return D(`/kpi/definitions/${e}`,{method:"DELETE"})}function yd(e,s){return D(`/kpi/custom/${e}/evaluate${ge(s)}`)}function gd(e){return D("/kpi/custom/preview",{method:"POST",body:JSON.stringify(e)})}function xd(e){return D("/kpi/definitions/import",{method:"POST",body:JSON.stringify(e)})}function vd(e){return D(`/simulations${ge(e)}`)}function jd(e){return D(`/simulations/${e}`)}function bd(e){return D("/simulations",{method:"POST",body:JSON.stringify(e)})}function Sd(e){return D(`/simulations/${e}`,{method:"DELETE"})}function Nn(e){return D(`/simulations/${e}/start`,{method:"POST"})}function kd(e){return D(`/simulations/${e}/pause`,{method:"POST"})}function _d(e){return D(`/simulations/${e}/resume`,{method:"POST"})}function Cd(e){return D(`/simulations/${e}/stop`,{method:"POST"})}function wd(e){return D(`/simulations/${e}/stats`)}function Id(e,s=30){return D(`/simulations/${e}/vehicles?tail=${s}`)}function Rd(e){return D("/simulations/generate-routes",{method:"POST",body:JSON.stringify(e)})}function Fd(e){return D("/simulations/generate-fleet",{method:"POST",body:JSON.stringify(e)})}function Pd(e){return D("/simulations/snap-routes",{method:"POST",body:JSON.stringify({routes:e})})}const Ee={Planning:"blue",Active:"purple",Completed:"green",Archived:"default",Frozen:"cyan",Pending:"default",InProgress:"gold",Cancelled:"default",Scheduled:"blue",Aborted:"red",New:"blue",Triage:"purple",Assigned:"geekblue",Fixed:"green",RegressionTracking:"cyan",Closed:"default",Reopened:"orange",Rejected:"red",backlog:"default",ready:"blue","in-progress":"gold",review:"purple",done:"green",pending:"default",queued:"blue",running:"gold",passed:"green",failed:"red",cancelled:"default",open:"blue",triaged:"purple",fixed:"green",verified:"cyan",closed:"default","wont-fix":"red",duplicate:"default"},Ys={Pending:"default",Smoke:"cyan",Gray:"gold",Freeze:"orange",GoLive:"green",backlog:"default",ready:"blue","in-progress":"gold",review:"purple",done:"green"},Xs={Critical:"red",High:"orange",Medium:"gold",Low:"blue",critical:"red",high:"orange",medium:"gold",low:"blue"},Qa={Blocker:"red",Critical:"red",High:"orange",Medium:"gold",Low:"blue",Trivial:"green",blocker:"red",critical:"red",high:"orange",medium:"gold",low:"blue",trivial:"green",Minor:"gold",Major:"orange"},Td={Triage:"gold",Assigned:"geekblue",InProgress:"purple",Fixed:"green",RegressionTracking:"cyan",Closed:"default",Reopened:"orange",Rejected:"red"};function at({title:e,subtitle:s,action:n}){return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:e}),s&&t.jsx("p",{className:"page-subtitle",children:s})]}),n]})}function We({to:e,children:s,mono:n,style:r}){return t.jsx(ss,{to:e,style:{color:"#818cf8",fontWeight:500,...n?{fontFamily:"monospace"}:{},...r},children:s})}function Ed(){const[e,s]=m.useState(""),[n,r]=m.useState(),[a,i]=m.useState(!1),[l]=N.useForm(),o=qe(),{data:d,isLoading:u}=B({queryKey:["projects"],queryFn:()=>us()}),c=fe({mutationFn:f=>{var v;const g=`PROJ-${crypto.randomUUID().slice(0,6).toUpperCase()}`;return Oc({project_id:g,name:f.name,vehicle_platform:f.vehicle_platform,soc_architecture:f.soc_architecture,sensor_suite_version:f.sensor_suite_version,software_baseline_version:f.software_baseline_version,start_date:(v=f.start_date)==null?void 0:v.toISOString(),target_mileage_km:f.target_mileage_km,status:f.status??"Planning"})},onSuccess:()=>{o.invalidateQueries({queryKey:["projects"]}),i(!1),l.resetFields(),X.success("Project created")},onError:f=>{X.error(f.message||"Failed to create project")}}),h=d==null?void 0:d.filter(f=>!(e&&!f.name.toLowerCase().includes(e.toLowerCase())||n&&f.status!==n)),y=[{title:"Name",dataIndex:"name",key:"name",render:(f,g)=>t.jsx(We,{to:`/projects/${g.id}`,children:f})},{title:"Status",dataIndex:"status",key:"status",width:130,render:f=>t.jsx(K,{color:Ee[f]??"default",children:f})},{title:"Created",dataIndex:"createdAt",key:"createdAt",width:140,render:f=>new Date(f).toLocaleDateString()},{title:"Updated",dataIndex:"updatedAt",key:"updatedAt",width:140,render:f=>new Date(f).toLocaleDateString()}];return t.jsxs("div",{children:[t.jsx(at,{title:"Projects",subtitle:"Manage autonomous driving test projects",action:t.jsx(q,{type:"primary",icon:t.jsx($t,{}),size:"large",onClick:()=>i(!0),children:"New Project"})}),t.jsxs(H,{direction:"vertical",size:16,style:{width:"100%"},children:[t.jsxs(H,{wrap:!0,children:[t.jsx(J,{placeholder:"Search projects...",prefix:t.jsx(Zs,{style:{color:"var(--text-muted)"}}),value:e,onChange:f=>s(f.target.value),allowClear:!0,style:{width:280}}),t.jsx(Z,{placeholder:"Filter by status",allowClear:!0,value:n,onChange:r,style:{width:160},options:[{value:"Planning",label:"Planning"},{value:"Active",label:"Active"},{value:"Frozen",label:"Frozen"},{value:"Completed",label:"Completed"},{value:"Archived",label:"Archived"}]})]}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:y,dataSource:h,rowKey:"id",loading:u,pagination:{pageSize:15,showSizeChanger:!1},locale:{emptyText:t.jsx(le,{image:t.jsx(Oa,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No projects yet. Create your first project to get started."})})}})})]}),t.jsx(rs,{title:"New Project",open:a,onCancel:()=>i(!1),onOk:()=>l.submit(),confirmLoading:c.isPending,okText:"Create",width:600,children:t.jsxs(N,{form:l,layout:"vertical",onFinish:f=>c.mutate(f),children:[t.jsx(N.Item,{name:"name",label:"Project Name",rules:[{required:!0,message:"Please enter project name"}],children:t.jsx(J,{placeholder:"e.g. V2.0 Urban Pilot"})}),t.jsx(N.Item,{name:"vehicle_platform",label:"Vehicle Platform",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. EP40"})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"soc_architecture",label:"SoC Architecture",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. Orin-X Dual"})}),t.jsx(N.Item,{name:"sensor_suite_version",label:"Sensor Suite Version",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. SS-4.0"})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"software_baseline_version",label:"SW Baseline Version",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. v3.1.0-rc1"})}),t.jsx(N.Item,{name:"start_date",label:"Start Date",rules:[{required:!0}],children:t.jsx(xs,{style:{width:"100%"}})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"target_mileage_km",label:"Target Mileage (km)",children:t.jsx(Ie,{min:0,style:{width:"100%"},placeholder:"Optional"})}),t.jsx(N.Item,{name:"status",label:"Initial Status",initialValue:"Planning",children:t.jsx(Z,{options:[{value:"Planning",label:"Planning"},{value:"Active",label:"Active"}]})})]})]})})]})}function Ts(){return t.jsx("div",{style:{display:"flex",justifyContent:"center",padding:80},children:t.jsx(Ot,{size:"large"})})}function rr({entity:e}){return t.jsx(le,{description:`${e} not found`,style:{padding:80}})}function he(){return t.jsx("span",{style:{color:"var(--text-muted)"},children:"â€”"})}function et({children:e}){return t.jsx("span",{className:"font-display",style:{fontWeight:600},children:e})}function Md({icon:e,iconColor:s,title:n,description:r,features:a,featuresLabel:i="Planned Features"}){return t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:t.jsxs(z,{className:"glass-panel-elevated",style:{maxWidth:480,width:"100%",textAlign:"center",padding:"20px 0"},children:[t.jsx("div",{style:{width:72,height:72,borderRadius:20,background:`${s}1f`,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",boxShadow:`0 0 24px ${s}33`},children:t.jsx(e,{size:36,style:{color:s}})}),t.jsx("h1",{style:{fontFamily:"var(--font-mono)",fontSize:"1.3rem",fontWeight:700,color:"var(--text-primary)",margin:0,textTransform:"uppercase",letterSpacing:"0.03em"},children:n}),t.jsx("p",{style:{fontSize:16,fontWeight:600,color:s,marginTop:4},children:"Coming Soon"}),t.jsx("p",{style:{color:"var(--text-secondary)",fontSize:14,lineHeight:1.7,marginTop:16,padding:"0 12px"},children:r}),t.jsxs("div",{style:{textAlign:"left",padding:"0 24px",marginTop:32},children:[t.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.06em",marginBottom:16},children:i}),t.jsx(H,{direction:"vertical",size:12,style:{width:"100%"},children:a.map(l=>t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx(Ln,{size:16,style:{color:"var(--text-muted)",opacity:.4,flexShrink:0}}),t.jsx("span",{style:{color:"var(--text-secondary)",fontSize:14},children:l})]},l))})]})]})})}class Ad extends m.Component{constructor(){super(...arguments);cr(this,"state",{hasError:!1})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("[ErrorBoundary]",n,r.componentStack)}render(){var n;return this.state.hasError?t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:t.jsx(ai,{status:"error",title:"Something went wrong",subTitle:((n=this.state.error)==null?void 0:n.message)??"An unexpected error occurred",extra:t.jsx(q,{type:"primary",onClick:()=>{this.setState({hasError:!1,error:void 0}),window.location.reload()},children:"Reload Page"})})}):this.props.children}}function ar(e,s,n){const{data:r,isLoading:a,error:i}=B({queryKey:[e,s],queryFn:()=>n(s),enabled:!!s});return{data:r,isLoading:a,error:i}}const Od={Planning:["Active"],Active:["Frozen","Completed"],Frozen:["Active","Completed"],Completed:["Archived"],Archived:[]};function zd(){const{id:e}=cs(),s=qe(),{data:n,isLoading:r}=ar("project",e,Wa),{data:a}=B({queryKey:["tasks",{projectId:e}],queryFn:()=>Fs({projectId:e}),enabled:!!e}),i=fe({mutationFn:d=>zc(e,{status:d}),onSuccess:()=>{s.invalidateQueries({queryKey:["project",e]}),s.invalidateQueries({queryKey:["projects"]}),X.success("Status updated")},onError:d=>X.error(d.message||"Failed to update status")});if(r)return t.jsx(Ts,{});if(!n)return t.jsx(rr,{entity:"Project"});const l=Od[n.status]??[],o=[{title:"Title",dataIndex:"title",key:"title",render:(d,u)=>t.jsx(We,{to:`/tasks/${u.id}`,children:d})},{title:"Stage",dataIndex:"stage",key:"stage",width:120,render:d=>t.jsx(K,{color:Ys[d]??"default",children:d})},{title:"Priority",dataIndex:"priority",key:"priority",width:110,render:d=>t.jsx(K,{color:Xs[d]??"default",children:d})},{title:"Type",dataIndex:"taskType",key:"taskType",width:100,render:d=>d?t.jsx(K,{children:d}):t.jsx(he,{})}];return t.jsxs("div",{children:[t.jsx(at,{title:n.name,subtitle:n.description??"No description",action:t.jsxs(H,{children:[t.jsx(K,{color:Ee[n.status]??"blue",style:{fontSize:14,padding:"4px 12px"},children:n.status}),l.map(d=>t.jsxs(q,{size:"small",loading:i.isPending,onClick:()=>i.mutate(d),style:{borderColor:"var(--glass-border-light)",color:"var(--text-secondary)"},children:["â†’ ",d]},d))]})}),t.jsxs(ae,{gutter:[24,24],children:[t.jsx(O,{xs:24,lg:16,children:t.jsx(z,{title:t.jsx(et,{children:"Tasks"}),className:"glass-panel",extra:t.jsx(We,{to:"/tasks",style:{fontSize:13},children:"View All"}),styles:{body:{padding:0}},children:t.jsx(Se,{columns:o,dataSource:a,rowKey:"id",pagination:!1,locale:{emptyText:t.jsx(le,{description:"No tasks for this project yet"})}})})}),t.jsx(O,{xs:24,lg:8,children:t.jsx(z,{title:t.jsx(et,{children:"Details"}),className:"glass-panel",children:t.jsxs(A,{column:1,size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Ee[n.status]??"blue",children:n.status})}),t.jsx(A.Item,{label:"Vehicle Platform",children:n.vehicle_platform??t.jsx(he,{})}),t.jsx(A.Item,{label:"SoC Architecture",children:n.soc_architecture??t.jsx(he,{})}),t.jsx(A.Item,{label:"Sensor Suite",children:n.sensor_suite_version??t.jsx(he,{})}),t.jsx(A.Item,{label:"SW Baseline",children:n.software_baseline_version??t.jsx(he,{})}),t.jsx(A.Item,{label:"Target Mileage",children:n.target_mileage_km!=null?`${n.target_mileage_km.toLocaleString()} km`:t.jsx(he,{})}),t.jsx(A.Item,{label:"Start Date",children:n.start_date?new Date(n.start_date).toLocaleDateString():t.jsx(he,{})}),t.jsx(A.Item,{label:"Created",children:new Date(n.createdAt).toLocaleString()}),t.jsx(A.Item,{label:"Last Updated",children:new Date(n.updatedAt).toLocaleString()})]})})})]})]})}function Ld(){const[e,s]=m.useState(""),[n,r]=m.useState(),[a,i]=m.useState(!1),[l]=N.useForm(),o=qe(),{data:d,isLoading:u}=B({queryKey:["tasks"],queryFn:()=>Fs()}),{data:c}=B({queryKey:["projects"],queryFn:()=>us()}),h=fe({mutationFn:g=>{const v=`TASK-${crypto.randomUUID().slice(0,6).toUpperCase()}`;return Nc({task_id:v,project_id:g.project_id,name:g.name,task_type:g.task_type,priority:g.priority??"Medium",execution_region:g.execution_region,target_vehicle_count:g.target_vehicle_count})},onSuccess:()=>{o.invalidateQueries({queryKey:["tasks"]}),i(!1),l.resetFields(),X.success("Task created")},onError:g=>{X.error(g.message||"Failed to create task")}}),y=d==null?void 0:d.filter(g=>!(e&&!g.title.toLowerCase().includes(e.toLowerCase())||n&&g.stage!==n)),f=[{title:"Title",dataIndex:"title",key:"title",render:(g,v)=>t.jsx(We,{to:`/tasks/${v.id}`,children:g})},{title:"Stage",dataIndex:"stage",key:"stage",width:130,render:g=>t.jsx(K,{color:Ys[g]??"default",children:g})},{title:"Priority",dataIndex:"priority",key:"priority",width:110,render:g=>t.jsx(K,{color:Xs[g]??"default",children:g})},{title:"Assignee",dataIndex:"assignee",key:"assignee",width:140,render:g=>g??t.jsx(he,{})},{title:"Updated",dataIndex:"updatedAt",key:"updatedAt",width:140,render:g=>new Date(g).toLocaleDateString()}];return t.jsxs("div",{children:[t.jsx(at,{title:"Tasks",subtitle:"Track test campaign tasks through their lifecycle",action:t.jsx(q,{type:"primary",icon:t.jsx($t,{}),size:"large",onClick:()=>i(!0),children:"New Task"})}),t.jsxs(H,{direction:"vertical",size:16,style:{width:"100%"},children:[t.jsxs(H,{wrap:!0,children:[t.jsx(J,{placeholder:"Search tasks...",prefix:t.jsx(Zs,{style:{color:"var(--text-muted)"}}),value:e,onChange:g=>s(g.target.value),allowClear:!0,style:{width:280}}),t.jsx(Z,{placeholder:"Filter by status",allowClear:!0,value:n,onChange:r,style:{width:160},options:[{value:"Pending",label:"Pending"},{value:"InProgress",label:"In Progress"},{value:"Completed",label:"Completed"},{value:"Cancelled",label:"Cancelled"}]})]}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:f,dataSource:y,rowKey:"id",loading:u,pagination:{pageSize:15,showSizeChanger:!1},locale:{emptyText:t.jsx(le,{image:t.jsx(za,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No tasks yet. Create tasks to plan and track your test activities."})})}})})]}),t.jsx(rs,{title:"New Task",open:a,onCancel:()=>i(!1),onOk:()=>l.submit(),confirmLoading:h.isPending,okText:"Create",width:560,children:t.jsxs(N,{form:l,layout:"vertical",onFinish:g=>h.mutate(g),children:[t.jsx(N.Item,{name:"project_id",label:"Project",rules:[{required:!0,message:"Please select a project"}],children:t.jsx(Z,{placeholder:"Select project",showSearch:!0,optionFilterProp:"label",options:(c??[]).map(g=>({value:g.id,label:g.name}))})}),t.jsx(N.Item,{name:"name",label:"Task Name",rules:[{required:!0,message:"Please enter task name"}],children:t.jsx(J,{placeholder:"e.g. Highway Daily Mileage"})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"task_type",label:"Task Type",rules:[{required:!0,message:"Please select type"}],children:t.jsx(Z,{placeholder:"Select type",options:[{value:"Daily",label:"Daily"},{value:"Smoke",label:"Smoke"},{value:"Gray",label:"Gray"},{value:"Freeze",label:"Freeze"},{value:"Retest",label:"Retest"}]})}),t.jsx(N.Item,{name:"priority",label:"Priority",initialValue:"Medium",children:t.jsx(Z,{options:[{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"},{value:"Critical",label:"Critical"}]})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"execution_region",label:"Execution Region",children:t.jsx(J,{placeholder:"e.g. Shanghai Lingang"})}),t.jsx(N.Item,{name:"target_vehicle_count",label:"Target Vehicle Count",children:t.jsx(Ie,{min:1,style:{width:"100%"},placeholder:"Optional"})})]})]})})]})}const Nd=["Completed","Cancelled"];function Dd(){const{id:e}=cs(),s=qe(),{data:n,isLoading:r}=ar("task",e,Lc),{data:a}=B({queryKey:["runs",{taskId:e}],queryFn:()=>Ps({taskId:e}),enabled:!!e}),{data:i}=B({queryKey:["project",n==null?void 0:n.projectId],queryFn:()=>Wa(n.projectId),enabled:!!(n!=null&&n.projectId)}),l=fe({mutationFn:()=>Dc(e),onSuccess:()=>{s.invalidateQueries({queryKey:["task",e]}),s.invalidateQueries({queryKey:["tasks"]}),X.success("Status advanced")},onError:u=>X.error(u.message||"Failed to advance status")});if(r)return t.jsx(Ts,{});if(!n)return t.jsx(rr,{entity:"Task"});const o=!Nd.includes(n.stage),d=[{title:"Run ID",dataIndex:"id",key:"id",width:120,render:u=>t.jsx(We,{to:`/runs/${u}`,mono:!0,children:u.slice(0,8)})},{title:"Status",dataIndex:"status",key:"status",width:120,render:u=>t.jsx(K,{color:Ee[u]??"default",children:u})},{title:"Result",dataIndex:"result",key:"result",width:100,render:u=>u??t.jsx(he,{})},{title:"Started",dataIndex:"startedAt",key:"startedAt",render:u=>u?new Date(u).toLocaleString():t.jsx(he,{})}];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:n.title}),t.jsx("p",{className:"page-subtitle",children:n.description??"No description"})]}),t.jsxs(H,{children:[t.jsx(K,{color:Ys[n.stage]??"default",style:{fontSize:13,padding:"3px 10px"},children:n.stage}),t.jsx(K,{color:Xs[n.priority]??"default",style:{fontSize:13,padding:"3px 10px"},children:n.priority}),o&&t.jsx(q,{size:"small",loading:l.isPending,onClick:()=>l.mutate(),style:{borderColor:"var(--glass-border-light)",color:"var(--text-secondary)"},children:"Advance Status â†’"})]})]}),t.jsxs(ae,{gutter:[24,24],children:[t.jsx(O,{xs:24,lg:16,children:t.jsx(z,{title:t.jsx(et,{children:"Test Runs"}),className:"glass-panel",styles:{body:{padding:0}},children:t.jsx(Se,{columns:d,dataSource:a,rowKey:"id",pagination:!1,locale:{emptyText:t.jsx(le,{description:"No runs executed yet"})}})})}),t.jsx(O,{xs:24,lg:8,children:t.jsx(z,{title:t.jsx(et,{children:"Details"}),className:"glass-panel",children:t.jsxs(A,{column:1,size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Ys[n.stage]??"default",children:n.stage})}),t.jsx(A.Item,{label:"Task Type",children:n.taskType?t.jsx(K,{children:n.taskType}):t.jsx(he,{})}),t.jsx(A.Item,{label:"Priority",children:t.jsx(K,{color:Xs[n.priority]??"default",children:n.priority})}),t.jsx(A.Item,{label:"Project",children:n.projectId?t.jsx(We,{to:`/projects/${n.projectId}`,children:(i==null?void 0:i.name)??n.projectId}):t.jsx(he,{})}),t.jsx(A.Item,{label:"Execution Region",children:n.executionRegion??t.jsx(he,{})}),t.jsx(A.Item,{label:"Target Vehicles",children:n.targetVehicleCount??t.jsx(he,{})}),t.jsx(A.Item,{label:"Created",children:new Date(n.createdAt).toLocaleString()}),t.jsx(A.Item,{label:"Updated",children:new Date(n.updatedAt).toLocaleString()})]})})})]})]})}function $d(){const{data:e,isLoading:s}=B({queryKey:["runs"],queryFn:()=>Ps()}),n=[{title:"Run ID",dataIndex:"id",key:"id",width:120,render:r=>t.jsx(We,{to:`/runs/${r}`,mono:!0,children:r.slice(0,8)})},{title:"Task",dataIndex:"taskId",key:"taskId",width:120,render:r=>r?t.jsx(We,{to:`/tasks/${r}`,mono:!0,children:r.slice(0,8)}):t.jsx(he,{})},{title:"Status",dataIndex:"status",key:"status",width:120,render:r=>t.jsx(K,{color:Ee[r]??"default",children:r})},{title:"Result",dataIndex:"result",key:"result",width:100,render:r=>r??t.jsx(he,{})},{title:"Vehicles",dataIndex:"vehicleIds",key:"vehicles",width:90,render:r=>(r==null?void 0:r.length)??0},{title:"Started",dataIndex:"startedAt",key:"startedAt",width:160,render:r=>r?new Date(r).toLocaleString():t.jsx(he,{})},{title:"Completed",dataIndex:"completedAt",key:"completedAt",width:160,render:r=>r?new Date(r).toLocaleString():t.jsx(he,{})}];return t.jsxs("div",{children:[t.jsx(at,{title:"Test Runs",subtitle:"Monitor and manage test execution runs"}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:n,dataSource:e,rowKey:"id",loading:s,pagination:{pageSize:15,showSizeChanger:!1},scroll:{x:900},locale:{emptyText:t.jsx(le,{image:t.jsx(rn,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No test runs yet. Runs will appear here once tasks are executed."})})}})})]})}function qd(){var r;const{id:e}=cs(),{data:s,isLoading:n}=ar("run",e,$c);return n?t.jsx(Ts,{}):s?t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"page-title",children:["Run ",s.id.slice(0,8)]}),t.jsx("p",{className:"page-subtitle",children:"Detailed execution information"})]}),t.jsx(K,{color:Ee[s.status]??"default",style:{fontSize:14,padding:"4px 12px"},children:s.status})]}),t.jsx(ae,{gutter:[24,24],children:t.jsx(O,{xs:24,lg:16,children:t.jsx(z,{title:t.jsx(et,{children:"Run Overview"}),className:"glass-panel",children:t.jsxs(A,{column:{xs:1,sm:2},size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Run ID",children:t.jsx("code",{style:{color:"#818cf8",fontSize:13},children:s.id})}),t.jsx(A.Item,{label:"Task",children:s.taskId?t.jsx(We,{to:`/tasks/${s.taskId}`,mono:!0,children:s.taskId}):"â€”"}),t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Ee[s.status]??"default",children:s.status})}),t.jsx(A.Item,{label:"Result",children:s.result??"â€”"}),t.jsx(A.Item,{label:"Vehicles",children:((r=s.vehicleIds)==null?void 0:r.length)??0}),t.jsx(A.Item,{label:"Started",children:s.startedAt?new Date(s.startedAt).toLocaleString():"â€”"}),t.jsx(A.Item,{label:"Completed",children:s.completedAt?new Date(s.completedAt).toLocaleString():"â€”"})]})})})})]}):t.jsx(rr,{entity:"Run"})}function Kd(){const[e,s]=m.useState(""),[n,r]=m.useState(),[a,i]=m.useState(),{data:l,isLoading:o}=B({queryKey:["issues"],queryFn:()=>Qc()}),d=l==null?void 0:l.filter(c=>!(e&&!c.title.toLowerCase().includes(e.toLowerCase())||n&&c.status!==n||a&&c.severity!==a)),u=[{title:"Title",dataIndex:"title",key:"title",ellipsis:!0,render:(c,h)=>t.jsx(We,{to:`/issues/${h.id}`,children:c})},{title:"Status",dataIndex:"status",key:"status",width:150,render:c=>t.jsx(K,{color:Ee[c]??"default",children:c})},{title:"Severity",dataIndex:"severity",key:"severity",width:110,render:c=>t.jsx(K,{color:Qa[c]??"default",children:c})},{title:"Assignee",dataIndex:"assignee",key:"assignee",width:140,render:c=>c??t.jsx(he,{})},{title:"Updated",dataIndex:"updatedAt",key:"updatedAt",width:140,render:c=>new Date(c).toLocaleDateString()}];return t.jsxs("div",{children:[t.jsx(at,{title:"Issues",subtitle:"Track defects and issues found during testing",action:t.jsx(q,{type:"primary",icon:t.jsx($t,{}),size:"large",children:"Report Issue"})}),t.jsxs(H,{direction:"vertical",size:16,style:{width:"100%"},children:[t.jsxs(H,{wrap:!0,children:[t.jsx(J,{placeholder:"Search issues...",prefix:t.jsx(Zs,{style:{color:"var(--text-muted)"}}),value:e,onChange:c=>s(c.target.value),allowClear:!0,style:{width:280}}),t.jsx(Z,{placeholder:"Status",allowClear:!0,value:n,onChange:r,style:{width:160},options:[{value:"New",label:"New"},{value:"Triage",label:"Triage"},{value:"Assigned",label:"Assigned"},{value:"InProgress",label:"In Progress"},{value:"Fixed",label:"Fixed"},{value:"RegressionTracking",label:"Regression"},{value:"Closed",label:"Closed"},{value:"Reopened",label:"Reopened"},{value:"Rejected",label:"Rejected"}]}),t.jsx(Z,{placeholder:"Severity",allowClear:!0,value:a,onChange:i,style:{width:140},options:[{value:"Critical",label:"Critical"},{value:"High",label:"High"},{value:"Medium",label:"Medium"},{value:"Low",label:"Low"},{value:"Trivial",label:"Trivial"}]})]}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:u,dataSource:d,rowKey:"id",loading:o,pagination:{pageSize:15,showSizeChanger:!1},locale:{emptyText:t.jsx(le,{image:t.jsx(Ma,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No issues reported. Issues from test runs will appear here."})})}})})]})]})}const Tr=["#818cf8","#34d399","#f472b6","#fbbf24","#60a5fa","#f87171","#a78bfa","#22d3ee"];function Bd({channel:e}){const{chartData:s,valueKeys:n}=m.useMemo(()=>{const r=new Set;return{chartData:e.data_points.map(i=>{const l={t:i.t/1e3};for(const[o,d]of Object.entries(i.values))typeof d=="number"&&(l[o]=d,r.add(o));return l}),valueKeys:Array.from(r)}},[e.data_points]);return n.length===0?t.jsx(le,{description:"No numeric data",image:le.PRESENTED_IMAGE_SIMPLE}):t.jsx(Tt,{width:"100%",height:250,children:t.jsxs(sa,{data:s,children:[t.jsx(as,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),t.jsx(vt,{dataKey:"t",tick:{fill:"#64748b",fontSize:11},unit:"s"}),t.jsx(Ve,{tick:{fill:"#64748b",fontSize:11}}),t.jsx(Ae,{contentStyle:{background:"rgba(15,23,42,0.9)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8},labelStyle:{color:"#94a3b8"}}),t.jsx(rt,{}),n.map((r,a)=>t.jsx($n,{type:"monotone",dataKey:r,stroke:Tr[a%Tr.length],dot:!1,strokeWidth:1.5},r))]})})}const Ud={New:["Triage","Rejected"],Triage:["Assigned","Rejected"],Assigned:["InProgress"],InProgress:["Fixed"],Fixed:["RegressionTracking"],RegressionTracking:["Closed","Reopened"],Reopened:["InProgress"],Closed:[],Rejected:[]};function Vd(){var C,w,F,j,S,I,T,k;const{id:e}=cs(),s=qe(),[n,r]=m.useState(!1),[a]=N.useForm(),[i,l]=m.useState(""),{data:o,isLoading:d,error:u}=B({queryKey:["issue",e],queryFn:()=>Gc(e),enabled:!!e}),{data:c}=B({queryKey:["issue-transitions",e],queryFn:()=>Xc(e),enabled:!!e}),h=fe({mutationFn:({toStatus:x,reason:E})=>Jc(e,{to_status:x,triggered_by:"ui-user",reason:E}),onSuccess:()=>{s.invalidateQueries({queryKey:["issue",e]}),s.invalidateQueries({queryKey:["issue-transitions",e]}),l("")}}),y=fe({mutationFn:x=>Yc(e,x),onSuccess:()=>{s.invalidateQueries({queryKey:["issue",e]}),s.invalidateQueries({queryKey:["issue-transitions",e]}),r(!1),a.resetFields()}}),{data:f}=B({queryKey:["issue-snapshot",e],queryFn:()=>cd(e),enabled:!!e}),{data:g}=B({queryKey:["issue-timeseries",e],queryFn:()=>dd(e),enabled:!!e}),v=m.useMemo(()=>{if(!g)return{};const x={};for(const E of g){const $=E.channel_type||"other";(x[$]??(x[$]=[])).push(E)}return x},[g]);if(d)return t.jsx(Ts,{});if(u||!o)return t.jsx(jt,{type:"error",message:"Failed to load issue",showIcon:!0,style:{borderRadius:12}});const b=o.status,_=Ud[b]??[],R=b==="Triage";return t.jsxs("div",{children:[t.jsxs(ss,{to:"/issues",style:{display:"inline-flex",alignItems:"center",gap:6,color:"var(--text-secondary)",marginBottom:20,fontSize:13},children:[t.jsx(ii,{})," Back to Issues"]}),t.jsxs(z,{className:"glass-panel",style:{marginBottom:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[t.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[t.jsx($a,{size:24,style:{color:"#6366f1"}}),t.jsxs("div",{children:[t.jsxs("h1",{style:{fontFamily:"var(--font-mono)",fontSize:"1.15rem",fontWeight:700,color:"var(--text-primary)",margin:0,textTransform:"uppercase",letterSpacing:"0.02em"},children:["Issue ",o.id.slice(0,12)]}),t.jsx("code",{style:{fontSize:12,color:"var(--text-muted)"},children:o.id})]})]}),t.jsxs(H,{children:[t.jsx(K,{color:Qa[o.severity]??"default",style:{fontSize:13,padding:"2px 10px"},children:o.severity}),t.jsx(K,{color:Ee[b]??"default",style:{fontSize:13,padding:"2px 10px"},children:b})]})]}),o.description&&t.jsx("p",{style:{marginTop:16,color:"var(--text-secondary)",fontSize:14},children:o.description}),t.jsx(qs,{style:{borderColor:"rgba(255,255,255,0.06)",margin:"20px 0"}}),t.jsxs(A,{column:{xs:1,sm:2,lg:4},size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Category",children:o.category??"â€”"}),t.jsx(A.Item,{label:"Takeover Type",children:o.takeoverType??"â€”"}),t.jsx(A.Item,{label:"Assignee",children:o.assignee??"â€”"}),t.jsx(A.Item,{label:"Module",children:o.module??"â€”"}),o.gpsLat!=null&&o.gpsLng!=null&&t.jsx(A.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(li,{})," GPS"]}),children:t.jsxs("code",{children:[Number(o.gpsLat).toFixed(6),", ",Number(o.gpsLng).toFixed(6)]})}),o.dataSnapshotUri&&t.jsx(A.Item,{label:"Snapshot",children:t.jsxs("a",{href:o.dataSnapshotUri,target:"_blank",rel:"noopener noreferrer",style:{color:"#818cf8"},children:["View ",t.jsx(oi,{})]})}),t.jsx(A.Item,{label:"Run",children:t.jsx("code",{children:o.runId?o.runId.slice(0,8):"â€”"})}),t.jsx(A.Item,{label:"Triggered At",children:o.triggerTimestamp?new Date(o.triggerTimestamp).toLocaleString():"â€”"})]}),o.faultCodes&&o.faultCodes.length>0&&t.jsxs("div",{style:{marginTop:16},children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",marginBottom:8},children:"Fault Codes"}),t.jsx(H,{wrap:!0,children:o.faultCodes.map(x=>t.jsx(K,{color:"red",style:{fontFamily:"monospace"},children:x},x))})]}),o.environmentTags&&o.environmentTags.length>0&&t.jsxs("div",{style:{marginTop:12},children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",marginBottom:8},children:"Environment Tags"}),t.jsx(H,{wrap:!0,children:o.environmentTags.map(x=>t.jsx(K,{children:x},x))})]}),(o.triageMode||o.triageHint)&&t.jsx(jt,{type:"warning",style:{marginTop:16,borderRadius:10},message:"Triage Hints",description:t.jsxs(H,{direction:"vertical",size:4,children:[o.triageMode&&t.jsxs("span",{children:["Mode: ",t.jsx("strong",{children:o.triageMode})]}),o.triageHint&&t.jsxs("span",{children:["Hint: ",t.jsx("strong",{children:o.triageHint})]})]})})]}),t.jsxs(ae,{gutter:[24,24],children:[_.length>0&&t.jsx(O,{xs:24,lg:12,children:t.jsxs(z,{title:t.jsx(et,{children:"Transition"}),className:"glass-panel",children:[t.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:13,marginBottom:16},children:["Current: ",t.jsx(K,{color:Ee[b],children:b})," â€” Choose next state:"]}),t.jsx(J,{placeholder:"Reason (optional)",value:i,onChange:x=>l(x.target.value),style:{marginBottom:16,maxWidth:400}}),t.jsx(H,{wrap:!0,children:_.map(x=>R&&x==="Assigned"?t.jsx(ci,{title:"Assign owner and module",children:t.jsx(q,{type:"primary",onClick:()=>r(!0),children:"Assign (Triage)"})},x):t.jsx(q,{onClick:()=>h.mutate({toStatus:x,reason:i||void 0}),loading:h.isPending,style:{borderColor:"rgba(255,255,255,0.15)"},children:t.jsx(K,{color:Td[x],style:{margin:0},children:x})},x))}),h.isError&&t.jsx(jt,{type:"error",message:"Transition failed",style:{marginTop:12,borderRadius:8}})]})}),t.jsx(O,{xs:24,lg:_.length>0?12:24,children:t.jsx(z,{title:t.jsx(et,{children:"Audit Trail"}),className:"glass-panel",children:c!=null&&c.items&&c.items.length>0?t.jsx(Gr,{items:c.items.map(x=>({dot:t.jsx(di,{style:{color:"#6366f1"}}),children:t.jsxs("div",{children:[t.jsxs(H,{size:4,children:[t.jsx(K,{color:Ee[x.fromStatus]??"default",style:{fontSize:11},children:x.fromStatus}),t.jsx("span",{style:{color:"var(--text-muted)"},children:"â†’"}),t.jsx(K,{color:Ee[x.toStatus]??"default",style:{fontSize:11},children:x.toStatus})]}),t.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:["by ",t.jsx("span",{style:{color:"var(--text-secondary)"},children:x.triggeredBy})," at ",x.transitionedAt?new Date(x.transitionedAt).toLocaleString():"â€”"]}),x.reason&&t.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",fontStyle:"italic",marginTop:2},children:["â€œ",x.reason,"â€"]})]})}))}):t.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:"No transitions recorded yet."})})})]}),t.jsx(z,{title:t.jsx(et,{children:"Vehicle Dynamics Snapshot"}),className:"glass-panel",style:{marginTop:24},children:f?t.jsxs(A,{column:{xs:1,sm:2,lg:4},size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Speed (m/s)",children:((C=f.speed_mps)==null?void 0:C.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Acceleration (m/sÂ²)",children:((w=f.acceleration_mps2)==null?void 0:w.toFixed(3))??"â€”"}),t.jsx(A.Item,{label:"Lateral Accel (m/sÂ²)",children:((F=f.lateral_acceleration_mps2)==null?void 0:F.toFixed(3))??"â€”"}),t.jsx(A.Item,{label:"Yaw Rate (Â°/s)",children:((j=f.yaw_rate_dps)==null?void 0:j.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Heading (Â°)",children:((S=f.heading_deg)==null?void 0:S.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Steering Angle (Â°)",children:((I=f.steering_angle_deg)==null?void 0:I.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Throttle (%)",children:((T=f.throttle_pct)==null?void 0:T.toFixed(1))??"â€”"}),t.jsx(A.Item,{label:"Brake (bar)",children:((k=f.brake_pressure_bar)==null?void 0:k.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Gear",children:f.gear??"â€”"}),t.jsx(A.Item,{label:"Quaternion",children:f.quaternion?`${f.quaternion.w.toFixed(4)}, ${f.quaternion.x.toFixed(4)}, ${f.quaternion.y.toFixed(4)}, ${f.quaternion.z.toFixed(4)}`:"â€”"})]}):t.jsx(le,{description:"No snapshot data",image:le.PRESENTED_IMAGE_SIMPLE})}),g&&g.length>0&&t.jsx(z,{title:t.jsx(et,{children:"Time-Series Data"}),className:"glass-panel",style:{marginTop:24},children:t.jsx(Jr,{items:Object.entries(v).map(([x,E])=>({key:x,label:t.jsx(K,{children:x}),children:t.jsx(H,{direction:"vertical",size:16,style:{width:"100%"},children:E.map($=>t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--text-secondary)",marginBottom:8},children:$.channel}),t.jsx(Bd,{channel:$})]},$.channel))})}))})}),t.jsx(rs,{title:"Triage Assignment",open:n,onCancel:()=>r(!1),onOk:()=>a.submit(),confirmLoading:y.isPending,okText:"Assign & Transition",children:t.jsxs(N,{form:a,layout:"vertical",onFinish:x=>y.mutate(x),children:[t.jsx(N.Item,{name:"assignee",label:"Assign To",rules:[{required:!0,message:"Please enter assignee"}],children:t.jsx(J,{placeholder:"Developer name"})}),t.jsx(N.Item,{name:"module",label:"Module",rules:[{required:!0,message:"Please enter module"}],children:t.jsx(J,{placeholder:"e.g. perception, planning"})})]})})]})}const ns=["#00FF41","#00cc33","#33ff66","#FFB000","#00c8ff","#aa66ff","#ff6644","#88ff44","#44ddaa","#ffaa00"],be="rgba(0,255,65,0.04)",Re="#3d6b3d",hs={contentStyle:{background:"rgba(0,0,0,0.95)",border:"1px solid rgba(0,255,65,0.15)",borderRadius:2,backdropFilter:"blur(8px)",color:"#b8d4b8",fontFamily:"'JetBrains Mono', monospace",fontSize:11,boxShadow:"0 0 12px rgba(0,255,65,0.06)"}};function Me(e,s){return e.color||ns[s%ns.length]}function Wd(e){return e.some(s=>s.axisId==="right")}function ir({thresholds:e}){return!e||e.length===0?null:t.jsx(t.Fragment,{children:e.map((s,n)=>t.jsx(Ri,{y:s.value,yAxisId:"left",stroke:s.color||"#ff0044",strokeDasharray:"6 3",strokeWidth:1.5,label:{value:s.label??`${s.value}`,fill:s.color||"#ff0044",fontSize:10,position:"right"}},n))})}function lr({xField:e,yFields:s,children:n,thresholds:r}){const a=Wd(s);return t.jsxs(t.Fragment,{children:[t.jsx(as,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:e,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"left",tick:{fontSize:11,fill:Re},stroke:be}),a&&t.jsx(Ve,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(rt,{}),t.jsx(ir,{thresholds:r}),n]})}function Hd({data:e,xField:s,yFields:n,thresholds:r}){return t.jsx(Vs,{data:e,children:t.jsx(lr,{xField:s,yFields:n,thresholds:r,children:n.map((a,i)=>t.jsx(Zt,{dataKey:a.key,name:a.label||a.key,fill:Me(a,i),yAxisId:a.axisId||"left",radius:[2,2,0,0],fillOpacity:.85},a.key))})})}function Qd({data:e,xField:s,yFields:n,thresholds:r}){return t.jsx(sa,{data:e,children:t.jsx(lr,{xField:s,yFields:n,thresholds:r,children:n.map((a,i)=>t.jsx($n,{type:"monotone",dataKey:a.key,name:a.label||a.key,stroke:Me(a,i),yAxisId:a.axisId||"left",strokeWidth:2,dot:{r:3,fill:Me(a,i)},activeDot:{r:5,stroke:Me(a,i),filter:`drop-shadow(0 0 4px ${Me(a,i)})`}},a.key))})})}function Gd({data:e,xField:s,yFields:n,thresholds:r}){return t.jsxs(na,{data:e,children:[t.jsx("defs",{children:n.map((a,i)=>{const l=Me(a,i);return t.jsxs("linearGradient",{id:`areaGrad-${a.key}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:l,stopOpacity:.3}),t.jsx("stop",{offset:"100%",stopColor:l,stopOpacity:0})]},a.key)})}),t.jsx(lr,{xField:s,yFields:n,thresholds:r,children:n.map((a,i)=>t.jsx(vn,{type:"monotone",dataKey:a.key,name:a.label||a.key,stroke:Me(a,i),fill:`url(#areaGrad-${a.key})`,yAxisId:a.axisId||"left",strokeWidth:2},a.key))})]})}function Jd({data:e,xField:s,yFields:n}){var r,a,i;return t.jsxs(wi,{children:[t.jsx(as,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:s,name:s,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{dataKey:(r=n[0])==null?void 0:r.key,name:((a=n[0])==null?void 0:a.label)||((i=n[0])==null?void 0:i.key),tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(rt,{}),n.map((l,o)=>t.jsx(Ii,{name:l.label||l.key,data:e,fill:Me(l,o),fillOpacity:.7},l.key))]})}function Yd({data:e,xField:s,yFields:n}){var a;const r=((a=n[0])==null?void 0:a.key)??"value";return t.jsxs(en,{children:[t.jsx(Ae,{...hs}),t.jsx(rt,{}),t.jsx(tn,{data:e,dataKey:r,nameKey:s||"name",cx:"50%",cy:"50%",innerRadius:"40%",outerRadius:"75%",strokeWidth:1,stroke:"rgba(0,255,65,0.06)",label:({name:i,percent:l})=>`${i} ${(l*100).toFixed(0)}%`,children:e.map((i,l)=>t.jsx(es,{fill:ns[l%ns.length],fillOpacity:.85},l))})]})}function Xd({data:e,yFields:s}){var o,d,u;const n=Number(((d=e[0])==null?void 0:d[((o=s[0])==null?void 0:o.key)??"value"])??0),a=Math.min(100,Math.max(0,n/100*100)),i=a>=80?"#00FF41":a>=50?"#FFB000":"#FF0033",l=[{name:"value",value:a},{name:"remaining",value:100-a}];return t.jsxs(en,{children:[t.jsxs(tn,{data:l,cx:"50%",cy:"70%",startAngle:180,endAngle:0,innerRadius:"60%",outerRadius:"85%",dataKey:"value",strokeWidth:0,children:[t.jsx(es,{fill:i}),t.jsx(es,{fill:"rgba(0,255,65,0.04)"})]}),t.jsx("text",{x:"50%",y:"62%",textAnchor:"middle",fill:i,style:{fontSize:24,fontFamily:"'JetBrains Mono', monospace",fontWeight:700},children:n.toFixed(1)}),t.jsx("text",{x:"50%",y:"78%",textAnchor:"middle",fill:"#3d6b3d",style:{fontSize:11,fontFamily:"'JetBrains Mono', monospace"},children:((u=s[0])==null?void 0:u.label)||"Value"})]})}function Zd({data:e,xField:s,yFields:n}){return t.jsxs(bi,{data:e,cx:"50%",cy:"50%",outerRadius:"75%",children:[t.jsx(Si,{stroke:be}),t.jsx(ki,{dataKey:s,tick:{fontSize:11,fill:Re}}),t.jsx(_i,{tick:{fontSize:10,fill:Re}}),t.jsx(Ae,{...hs}),t.jsx(rt,{}),n.map((r,a)=>t.jsx(Ci,{name:r.label||r.key,dataKey:r.key,stroke:Me(r,a),fill:Me(r,a),fillOpacity:.2,strokeWidth:2},r.key))]})}function eu({data:e,xField:s,yFields:n,thresholds:r}){return t.jsxs(ji,{data:e,children:[t.jsx(as,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:s,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"left",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(rt,{}),t.jsx(ir,{thresholds:r}),n.map((a,i)=>{const l=a.axisId||(i===0?"left":"right");return i===0?t.jsx(Zt,{dataKey:a.key,name:a.label||a.key,fill:Me(a,i),yAxisId:l,radius:[2,2,0,0],fillOpacity:.85},a.key):t.jsx($n,{type:"monotone",dataKey:a.key,name:a.label||a.key,stroke:Me(a,i),yAxisId:l,strokeWidth:2,dot:{r:3}},a.key)})]})}function tu({data:e,xField:s,yFields:n}){var l,o;const r=((l=n[0])==null?void 0:l.key)??"value",a=[...e].sort((d,u)=>Number(u[r]??0)-Number(d[r]??0)),i=Number(((o=a[0])==null?void 0:o[r])??1);return t.jsx("div",{style:{padding:"20px 0"},children:a.map((d,u)=>{const c=Number(d[r]??0),h=Math.max(10,c/i*100),y=ns[u%ns.length];return t.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8,justifyContent:"center"},children:[t.jsx("span",{style:{width:100,textAlign:"right",paddingRight:12,fontSize:11,color:Re,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontFamily:"'JetBrains Mono', monospace"},children:String(d[s||"name"]??`Step ${u+1}`)}),t.jsx("div",{style:{width:`${h}%`,maxWidth:400,height:28,background:y,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",color:"#000",fontSize:10,fontWeight:700,opacity:.85,transition:"width 0.3s ease",fontFamily:"'JetBrains Mono', monospace",boxShadow:`0 0 8px ${y}40`},children:c})]},u)})})}function su({data:e,xField:s,yFields:n,thresholds:r}){var o,d;const a=((o=n[0])==null?void 0:o.key)??"value";let i=0;const l=e.map(u=>{const c=Number(u[a]??0),h=i;return i+=c,{...u,_wf_start:h,_wf_end:i,_wf_value:c}});return t.jsxs(Vs,{data:l,children:[t.jsx(as,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:s,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"left",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(rt,{}),t.jsx(ir,{thresholds:r}),t.jsx(Zt,{dataKey:"_wf_start",stackId:"wf",fill:"transparent",yAxisId:"left"}),t.jsx(Zt,{dataKey:"_wf_value",stackId:"wf",name:((d=n[0])==null?void 0:d.label)||a,yAxisId:"left",radius:[2,2,0,0],children:l.map((u,c)=>t.jsx(es,{fill:Number(u._wf_value)>=0?"#00FF41":"#FF0033",fillOpacity:.85},c))})]})}const nu={bar:Hd,line:Qd,area:Gd,scatter:Jd,pie:Yd,gauge:Xd,radar:Zd,dual_axes:eu,funnel:tu,waterfall:su};function ru(e){const{chartType:s,data:n,title:r}=e,a=nu[s];return!a||!n.length?t.jsx(z,{className:"glass-panel hud-corners",children:t.jsx(le,{description:n.length===0?"No data":`Unknown chart type: ${s}`})}):t.jsx(z,{className:"glass-panel hud-corners",title:r?t.jsx("span",{className:"font-display",style:{fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em"},children:r}):void 0,children:t.jsx(Tt,{width:"100%",height:340,children:t.jsx(a,{...e})})})}function Er({title:e,value:s,unit:n,loading:r}){return t.jsx(z,{className:"glass-panel hud-corners glow-accent-hover",style:{height:"100%"},children:r?t.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:t.jsx(Ot,{})}):t.jsx(Nt,{title:t.jsx("span",{className:"font-display",style:{fontWeight:600,fontSize:9,textTransform:"uppercase",letterSpacing:"0.06em"},children:e}),value:s??void 0,precision:2,suffix:n?t.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:n}):void 0,valueStyle:{fontFamily:"var(--font-mono)",fontWeight:700,color:"#00FF41",textShadow:"0 0 8px rgba(0,255,65,0.25)"},formatter:a=>a==null?"â€”":String(a)})})}function au({groups:e,title:s}){const n=m.useMemo(()=>{const a=new Set;return e.forEach(l=>Object.keys(l.group).forEach(o=>a.add(o))),[...[...a].map(l=>({title:t.jsx("span",{style:{fontFamily:"var(--font-mono)"},children:l}),dataIndex:["group",l],key:l,render:o=>String(o??"â€”")})),{title:t.jsx("span",{style:{fontFamily:"var(--font-mono)"},children:"Value"}),dataIndex:"value",key:"_value",align:"right",render:l=>t.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:600,color:"#00FF41"},children:l.toLocaleString(void 0,{maximumFractionDigits:2})})}]},[e]),r=m.useMemo(()=>e.map((a,i)=>({...a,_key:String(i)})),[e]);return t.jsx(z,{className:"glass-panel",title:s?t.jsx("span",{className:"font-display",style:{fontWeight:600},children:s}):void 0,children:t.jsx(Se,{dataSource:r,columns:n,rowKey:"_key",pagination:e.length>20?{pageSize:20,size:"small"}:!1,size:"small"})})}function Ga(e,s=""){return e.map(n=>{const r=s?`${s}.${n.name}`:n.name,a=n.children&&n.children.length>0;return{title:`${n.name} (${n.type})`,value:r,selectable:!a,children:a?Ga(n.children,r):void 0}})}function iu({entity:e,value:s,onChange:n}){const{data:r,isLoading:a}=B({queryKey:["schema-fields",e],queryFn:()=>ud(e),enabled:!!e}),i=m.useMemo(()=>{if(!r)return[];const l="fields"in r?r:void 0;return l?Ga(l.fields):[]},[r]);return t.jsx(ui,{value:s||void 0,onChange:n,treeData:i,loading:a,placeholder:e?"Select field...":"Choose entity first",disabled:!e,showSearch:!0,treeDefaultExpandAll:!0,style:{width:"100%"},dropdownStyle:{maxHeight:360,overflow:"auto"},popupClassName:"glass-panel-elevated"})}const Mr=[{value:"project",label:"Project"},{value:"task",label:"Task"},{value:"run",label:"Run"},{value:"issue",label:"Issue"},{value:"cross",label:"Cross-Entity"}],lu=[{value:"sum",label:"Sum"},{value:"avg",label:"Average"},{value:"count",label:"Count"},{value:"min",label:"Min"},{value:"max",label:"Max"},{value:"distinct_count",label:"Distinct Count"},{value:"raw",label:"Raw"},{value:"percentile_50",label:"P50 (Median)"},{value:"percentile_90",label:"P90"},{value:"percentile_99",label:"P99"},{value:"stddev",label:"Std Dev"}],ou=[{value:"stat",label:"Stat Card"},{value:"table",label:"Table"},{value:"bar",label:"Bar Chart"},{value:"line",label:"Line Chart"},{value:"area",label:"Area Chart"},{value:"scatter",label:"Scatter Plot"},{value:"pie",label:"Pie Chart"},{value:"gauge",label:"Gauge"},{value:"radar",label:"Radar"},{value:"dual_axes",label:"Dual Axes (Bar+Line)"},{value:"funnel",label:"Funnel"},{value:"waterfall",label:"Waterfall"}],cu=[{label:"+",value:" + ",title:"Add"},{label:"âˆ’",value:" - ",title:"Subtract"},{label:"Ã—",value:" * ",title:"Multiply"},{label:"Ã·",value:" / ",title:"Divide"},{label:"(",value:"(",title:"Open paren"},{label:")",value:")",title:"Close paren"},{label:"âˆš",value:"sqrt(",title:"Square root"},{label:"xÂ²",value:"^2",title:"Square"},{label:"pow",value:"pow(",title:"Power"},{label:"abs",value:"abs(",title:"Absolute value"},{label:"log",value:"log(",title:"Natural log"},{label:"round",value:"round(",title:"Round"},{label:"ceil",value:"ceil(",title:"Ceiling"},{label:"floor",value:"floor(",title:"Floor"},{label:"min",value:"min(",title:"Minimum"},{label:"max",value:"max(",title:"Maximum"}],du=[{name:"Issue Count by Category (Bar)",template:{name:"Issue Count by Category",data_source:"issue",formula:"issue_count",variables:[{name:"issue_count",source_entity:"issue",field:"issue_id",aggregation:"count"}],visualization:{chart_type:"bar",x_axis:{field:"category"},y_axes:[{variable:"value",label:"Issues"}]}}},{name:"Issue Severity Distribution (Pie)",template:{name:"Issue Severity Distribution",data_source:"issue",formula:"severity_count",variables:[{name:"severity_count",source_entity:"issue",field:"issue_id",aggregation:"count"}],visualization:{chart_type:"pie",x_axis:{field:"severity"},y_axes:[{variable:"value",label:"Count"}]}}},{name:"Total Mileage by Task (Bar)",template:{name:"Total Mileage by Task",data_source:"run",formula:"total_km",variables:[{name:"total_km",source_entity:"run",field:"total_auto_mileage_km",aggregation:"sum"}],visualization:{chart_type:"bar",x_axis:{field:"task_id"},y_axes:[{variable:"value",label:"Mileage (km)"}]}}},{name:"Fleet Utilization Gauge",template:{name:"Fleet Utilization",data_source:"run",formula:"utilization",variables:[{name:"utilization",source_entity:"run",field:"total_auto_mileage_km",aggregation:"avg"}],visualization:{chart_type:"gauge",y_axes:[{variable:"value",label:"Utilization %"}]}}}],uu=[{value:"left",label:"Left"},{value:"right",label:"Right"}],xe={fontFamily:"var(--font-mono)",fontWeight:500};function Ls(){return{name:"",source_entity:"",field:"",aggregation:"count"}}function Ns(){return{variable:"",label:"",color:"",axis_id:"left"}}function hu({open:e,onClose:s,onSaved:n,editingDef:r}){const[a]=N.useForm(),[i,l]=m.useState(!1),[o,d]=m.useState(!1),[u,c]=m.useState(null),[h,y]=m.useState([Ls()]),[f,g]=m.useState([Ns()]),[v,b]=m.useState("issue"),[_,R]=m.useState([]);m.useEffect(()=>{var k,x;e&&(r?(a.setFieldsValue({name:r.name,description:r.description,data_source:r.data_source,formula:r.formula,chart_type:r.visualization.chart_type,x_axis_field:(k=r.visualization.x_axis)==null?void 0:k.field}),b(r.data_source),y(r.variables.length>0?r.variables.map(E=>({...E})):[Ls()]),g(r.visualization.y_axes&&r.visualization.y_axes.length>0?r.visualization.y_axes.map(E=>({variable:E.variable,label:E.label??"",color:E.color??"",axis_id:E.axis_id??"left"})):[Ns()]),R(((x=r.visualization.thresholds)==null?void 0:x.map(E=>({value:E.value,label:E.label??"",color:E.color??"#ef4444"})))??[])):(a.resetFields(),y([Ls()]),g([Ns()]),R([]),b("issue"),c(null)))},[e,r,a]);const C=(k,x)=>{y(E=>E.map(($,se)=>se===k?{...$,...x}:$))},w=k=>{y(x=>x.length<=1?x:x.filter((E,$)=>$!==k))},F=(k,x)=>{g(E=>E.map(($,se)=>se===k?{...$,...x}:$))},j=k=>{g(x=>x.length<=1?x:x.filter((E,$)=>$!==k))},S=()=>{const k=a.getFieldsValue();return{name:k.name,description:k.description,data_source:k.data_source,formula:k.formula,variables:h.filter(x=>x.name&&x.field),visualization:{chart_type:k.chart_type||"stat",x_axis:k.x_axis_field?{field:k.x_axis_field}:void 0,y_axes:f.filter(x=>x.variable).map(x=>({variable:x.variable,label:x.label||void 0,color:x.color||void 0,axis_id:x.axis_id||void 0})),thresholds:_.length>0?_.filter(x=>x.value!=null).map(x=>({value:x.value,label:x.label||void 0,color:x.color||"#ef4444"})):void 0,format:k.format_suffix?{suffix:k.format_suffix,precision:k.format_precision}:void 0},enabled:!0}},I=async()=>{try{const k=a.getFieldsValue();if(!k.formula){X.warning("Enter a formula first");return}d(!0);const x=await gd({formula:k.formula,variables:h.filter(E=>E.name&&E.field)});c(x)}catch(k){const x=k instanceof Error?k.message:"Preview failed";X.error(x)}finally{d(!1)}},T=async()=>{try{await a.validateFields(),l(!0);const k=S();r?(await pd(r.kpi_id,k),X.success("KPI definition updated")):(await md(k),X.success("KPI definition created")),n(),s()}catch(k){if(k&&typeof k=="object"&&"errorFields"in k)return;const x=k instanceof Error?k.message:"Save failed";X.error(x)}finally{l(!1)}};return t.jsx(rs,{open:e,onCancel:s,title:t.jsx("span",{className:"font-display",style:{fontWeight:600},children:r?"Edit KPI Definition":"New KPI Definition"}),width:780,footer:t.jsxs(H,{children:[t.jsx(q,{onClick:s,children:"Cancel"}),t.jsx(q,{icon:t.jsx(hi,{}),onClick:I,loading:o,children:"Preview"}),t.jsx(q,{type:"primary",onClick:T,loading:i,children:r?"Update":"Create"})]}),destroyOnClose:!0,children:t.jsxs(N,{form:a,layout:"vertical",requiredMark:"optional",children:[!r&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("div",{style:{...xe,fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Quick Start from Template"}),t.jsx(H,{wrap:!0,size:[6,6],children:du.map(k=>t.jsx(q,{size:"small",onClick:()=>{var E,$,se,ce;const x=k.template;a.setFieldsValue({name:x.name,data_source:x.data_source,formula:x.formula,chart_type:(E=x.visualization)==null?void 0:E.chart_type,x_axis_field:(se=($=x.visualization)==null?void 0:$.x_axis)==null?void 0:se.field}),x.data_source&&b(x.data_source),x.variables&&y(x.variables.map(de=>({...de}))),(ce=x.visualization)!=null&&ce.y_axes&&g(x.visualization.y_axes.map(de=>({variable:de.variable??"",label:de.label??"",color:de.color??"",axis_id:de.axis_id??"left"})))},children:k.name},k.name))})]}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:16,children:t.jsx(N.Item,{name:"name",label:t.jsx("span",{style:xe,children:"Name"}),rules:[{required:!0,message:"Name is required"}],children:t.jsx(J,{placeholder:"e.g. Issue Resolution Rate"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"data_source",label:t.jsx("span",{style:xe,children:"Data Source"}),rules:[{required:!0}],initialValue:"issue",children:t.jsx(Z,{options:Mr,onChange:k=>b(k)})})})]}),t.jsx(N.Item,{name:"description",label:t.jsx("span",{style:xe,children:"Description"}),children:t.jsx(J.TextArea,{rows:2,placeholder:"What does this KPI measure?"})}),t.jsx(qs,{titlePlacement:"left",style:{...xe,fontSize:13},children:"Variables"}),h.map((k,x)=>t.jsx(z,{size:"small",className:"glass-panel",style:{marginBottom:12},extra:h.length>1&&t.jsx(q,{type:"text",size:"small",icon:t.jsx(cn,{}),danger:!0,onClick:()=>w(x)}),children:t.jsxs(ae,{gutter:12,children:[t.jsx(O,{span:5,children:t.jsx(J,{placeholder:"Variable name",value:k.name,onChange:E=>C(x,{name:E.target.value})})}),t.jsx(O,{span:5,children:t.jsx(Z,{value:k.source_entity||void 0,onChange:E=>C(x,{source_entity:E,field:""}),placeholder:"Entity",options:Mr,style:{width:"100%"}})}),t.jsx(O,{span:8,children:t.jsx(iu,{entity:k.source_entity||v,value:k.field,onChange:E=>C(x,{field:E})})}),t.jsx(O,{span:6,children:t.jsx(Z,{value:k.aggregation,onChange:E=>C(x,{aggregation:E}),options:lu,style:{width:"100%"}})})]})},x)),t.jsx(q,{type:"dashed",icon:t.jsx($t,{}),onClick:()=>y(k=>[...k,Ls()]),block:!0,style:{marginBottom:16},children:"Add Variable"}),t.jsx(N.Item,{name:"formula",label:t.jsx("span",{style:xe,children:"Formula"}),rules:[{required:!0,message:"Formula is required"}],extra:t.jsx("span",{style:{color:"var(--text-muted)",fontSize:12},children:"Reference variables by name, e.g. closed_count / total_count * 100"}),children:t.jsx(J.TextArea,{rows:2,placeholder:"closed_count / total_count * 100",style:{fontFamily:"monospace"}})}),t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("div",{style:{...xe,fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Operator Palette"}),t.jsxs(H,{wrap:!0,size:[4,4],children:[cu.map(k=>t.jsx(q,{size:"small",title:k.title,style:{fontFamily:"monospace",minWidth:36},onClick:()=>{const x=a.getFieldValue("formula")||"";a.setFieldsValue({formula:x+k.value})},children:k.label},k.value)),h.filter(k=>k.name).map(k=>t.jsx(q,{size:"small",type:"dashed",style:{fontFamily:"monospace",color:"#00FF41"},onClick:()=>{const x=a.getFieldValue("formula")||"";a.setFieldsValue({formula:x+k.name})},children:k.name},`var-${k.name}`))]})]}),t.jsx(qs,{titlePlacement:"left",style:{...xe,fontSize:13},children:"Visualization"}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"chart_type",label:t.jsx("span",{style:xe,children:"Chart Type"}),initialValue:"stat",children:t.jsx(Z,{options:ou})})}),t.jsx(O,{span:16,children:t.jsx(N.Item,{name:"x_axis_field",label:t.jsx("span",{style:xe,children:"X-Axis Field"}),children:t.jsx(J,{placeholder:"e.g. date, category, status"})})})]}),t.jsx("div",{style:{...xe,fontSize:13,marginBottom:8},children:"Y-Axes"}),f.map((k,x)=>t.jsx(z,{size:"small",className:"glass-panel",style:{marginBottom:12},extra:f.length>1&&t.jsx(q,{type:"text",size:"small",icon:t.jsx(cn,{}),danger:!0,onClick:()=>j(x)}),children:t.jsxs(ae,{gutter:12,children:[t.jsx(O,{span:7,children:t.jsx(J,{placeholder:"Variable ref",value:k.variable,onChange:E=>F(x,{variable:E.target.value})})}),t.jsx(O,{span:7,children:t.jsx(J,{placeholder:"Label",value:k.label,onChange:E=>F(x,{label:E.target.value})})}),t.jsx(O,{span:5,children:t.jsx(J,{placeholder:"#6366f1",value:k.color,onChange:E=>F(x,{color:E.target.value})})}),t.jsx(O,{span:5,children:t.jsx(Z,{value:k.axis_id,onChange:E=>F(x,{axis_id:E}),options:uu,style:{width:"100%"}})})]})},x)),t.jsx(q,{type:"dashed",icon:t.jsx($t,{}),onClick:()=>g(k=>[...k,Ns()]),block:!0,style:{marginBottom:16},children:"Add Y-Axis"}),t.jsx("div",{style:{...xe,fontSize:13,marginBottom:8},children:"Thresholds (Reference Lines)"}),_.map((k,x)=>t.jsx(z,{size:"small",className:"glass-panel",style:{marginBottom:8},children:t.jsxs(ae,{gutter:8,children:[t.jsx(O,{span:8,children:t.jsx(J,{type:"number",placeholder:"Value",value:k.value,onChange:E=>{const $=[..._];$[x]={...$[x],value:Number(E.target.value)},R($)}})}),t.jsx(O,{span:8,children:t.jsx(J,{placeholder:"Label",value:k.label,onChange:E=>{const $=[..._];$[x]={...$[x],label:E.target.value},R($)}})}),t.jsx(O,{span:5,children:t.jsx(J,{placeholder:"#ef4444",value:k.color,onChange:E=>{const $=[..._];$[x]={...$[x],color:E.target.value},R($)}})}),t.jsx(O,{span:3,children:t.jsx(q,{type:"text",danger:!0,size:"small",icon:t.jsx(cn,{}),onClick:()=>R(_.filter((E,$)=>$!==x))})})]})},x)),t.jsx(q,{type:"dashed",size:"small",icon:t.jsx($t,{}),onClick:()=>R([..._,{value:0,label:"",color:"#ef4444"}]),style:{marginBottom:16},children:"Add Threshold"}),t.jsxs(ae,{gutter:16,style:{marginBottom:16},children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"format_suffix",label:t.jsx("span",{style:xe,children:"Unit Suffix"}),children:t.jsx(J,{placeholder:"%, km, hours"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"format_precision",label:t.jsx("span",{style:xe,children:"Precision"}),children:t.jsx(Z,{options:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"}],placeholder:"Auto",allowClear:!0})})})]}),u&&t.jsxs(t.Fragment,{children:[t.jsx(qs,{titlePlacement:"left",style:{...xe,fontSize:13},children:"Preview Result"}),t.jsx(z,{size:"small",className:"glass-panel",children:u.error?t.jsx("span",{style:{color:"var(--danger)"},children:u.error}):t.jsxs("div",{children:[t.jsx("span",{style:{fontFamily:"var(--font-mono)",color:"var(--text-muted)",marginRight:8},children:"Value:"}),t.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,fontSize:18,color:"#00FF41"},children:u.value!=null?u.value.toLocaleString():"â€”"}),u.groups&&u.groups.length>0&&t.jsxs("div",{style:{marginTop:8,fontSize:12,color:"var(--text-secondary)"},children:[u.groups.length," group(s) returned"]})]})})]})]})})}const{Text:yn}=Yr,{Dragger:mu}=mi,pu={dashboards:[{dashboard_id:"demo-quality",name:"Quality Metrics",description:"Issue quality analysis dashboard",kpis:[{name:"Issues by Severity",data_source:"issue",variables:[{name:"count",source_entity:"issue",field:"issue_id",aggregation:"count"}],formula:"count",group_by:["severity"],vchart_spec:{type:"pie",categoryField:"severity",valueField:"value",legends:{visible:!0,orient:"right"},label:{visible:!0}}},{name:"Issues by Category (Bar)",data_source:"issue",variables:[{name:"total",source_entity:"issue",field:"issue_id",aggregation:"count"}],formula:"total",group_by:["category"],vchart_spec:{type:"bar",xField:"category",yField:"value",label:{visible:!0,position:"top"}}},{name:"Issue Status Distribution",data_source:"issue",variables:[{name:"cnt",source_entity:"issue",field:"issue_id",aggregation:"count"}],formula:"cnt",group_by:["status"],vchart_spec:{type:"rose",categoryField:"status",valueField:"value",legends:{visible:!0}}}]},{dashboard_id:"demo-fleet",name:"Fleet Analytics",kpis:[{name:"Mileage by Task Type",data_source:"run",variables:[{name:"mileage",source_entity:"run",field:"total_auto_mileage_km",aggregation:"sum"}],formula:"mileage",group_by:["status"],vchart_spec:{type:"bar",xField:"status",yField:"value",seriesField:"status",label:{visible:!0}}}]}]};function fu({open:e,onClose:s,onImported:n}){const r=qe(),[a,i]=m.useState(null),[l,o]=m.useState(null),[d,u]=m.useState(null),c=fe({mutationFn:v=>xd(v),onSuccess:v=>{u(v),r.invalidateQueries({queryKey:["kpi-definitions"]}),X.success(`Imported ${v.summary.created} KPIs, updated ${v.summary.updated}`)},onError:v=>{X.error(v.message||"Import failed")}}),h=m.useCallback(v=>{o(null),i(null),u(null);const b=new FileReader;return b.onload=_=>{var R;try{const C=JSON.parse((R=_.target)==null?void 0:R.result);if(!C.dashboards||!Array.isArray(C.dashboards)){o('JSON must contain a "dashboards" array at the top level.');return}const w=C.dashboards.map(F=>({id:F.dashboard_id??"(unnamed)",name:F.name??"(unnamed)",kpiCount:Array.isArray(F.kpis)?F.kpis.length:0}));i({raw:C,dashboardCount:C.dashboards.length,totalKpis:w.reduce((F,j)=>F+j.kpiCount,0),dashboards:w})}catch{o("Invalid JSON file. Please check the syntax.")}},b.readAsText(v),!1},[]),y=()=>{const v=new Blob([JSON.stringify(pu,null,2)],{type:"application/json"}),b=URL.createObjectURL(v),_=document.createElement("a");_.href=b,_.download="kpi-dashboard-example.json",_.click(),URL.revokeObjectURL(b)},f=()=>{i(null),o(null),u(null),s()},g=()=>{a!=null&&a.raw&&c.mutate(a.raw)};return t.jsxs(rs,{open:e,title:t.jsxs(H,{children:[t.jsx(rc,{size:16,style:{color:"#00FF41"}}),t.jsx("span",{className:"font-display",style:{fontWeight:600},children:"Import KPI Dashboards"})]}),onCancel:f,width:640,footer:d?t.jsx(q,{type:"primary",onClick:()=>{f(),n()},children:"Done"}):t.jsxs(H,{children:[t.jsx(q,{onClick:f,children:"Cancel"}),t.jsxs(q,{type:"primary",onClick:g,disabled:!a||c.isPending,loading:c.isPending,children:["Import ",a?`(${a.totalKpis} KPIs)`:""]})]}),children:[!d&&t.jsxs(t.Fragment,{children:[t.jsx(mu,{accept:".json",showUploadList:!1,beforeUpload:h,style:{background:"rgba(0,255,65,0.02)",borderColor:"rgba(0,255,65,0.12)",borderStyle:"dashed",borderRadius:2},children:t.jsxs("div",{style:{padding:"20px 0"},children:[t.jsx(qa,{size:32,style:{color:"#00FF41",marginBottom:10}}),t.jsx("p",{style:{color:"#b8d4b8",fontSize:12,marginBottom:4},children:"Drop JSON file here or click to browse"}),t.jsx("p",{style:{color:"#3d6b3d",fontSize:11},children:"Supports batch import of multiple dashboards with VChart specs"})]})}),t.jsx("div",{style:{marginTop:12,textAlign:"right"},children:t.jsx(q,{type:"link",size:"small",icon:t.jsx(sc,{size:12}),onClick:y,style:{color:"#00FF41",fontSize:11},children:"Download sample JSON"})}),l&&t.jsx(jt,{type:"error",showIcon:!0,icon:t.jsx(tc,{size:16}),message:l,style:{marginTop:12}}),a&&t.jsxs("div",{style:{marginTop:16},children:[t.jsx(jt,{type:"success",showIcon:!0,icon:t.jsx(Ln,{size:16}),message:`Parsed ${a.dashboardCount} dashboard(s), ${a.totalKpis} KPI(s)`}),t.jsx(Xr,{ghost:!0,style:{marginTop:8},items:a.dashboards.map(v=>({key:v.id,label:t.jsxs(H,{children:[t.jsx(yn,{style:{color:"#b8d4b8"},children:v.name}),t.jsxs(K,{color:"cyan",children:[v.kpiCount," KPIs"]})]}),children:t.jsxs(yn,{style:{color:"#3d6b3d",fontSize:11},children:["Dashboard ID: ",t.jsx("code",{children:v.id})]})}))})]})]}),d&&t.jsxs("div",{children:[t.jsx(jt,{type:d.summary.failed>0?"warning":"success",showIcon:!0,icon:d.summary.failed>0?t.jsx($a,{size:16}):t.jsx(Ln,{size:16}),message:`Created: ${d.summary.created}, Updated: ${d.summary.updated}, Failed: ${d.summary.failed}`}),d.results.map(v=>t.jsxs("div",{style:{marginTop:12},children:[t.jsx(yn,{strong:!0,style:{color:"#b8d4b8"},children:v.dashboard_id}),t.jsxs("div",{style:{marginLeft:12,marginTop:4},children:[v.created.length>0&&t.jsx("div",{children:v.created.map(b=>t.jsx(K,{color:"green",children:b},b))}),v.failed.length>0&&t.jsx("div",{style:{marginTop:4},children:v.failed.map((b,_)=>t.jsx(jt,{type:"error",message:`${b.name}: ${b.error}`,style:{marginBottom:4,fontSize:12},banner:!0},_))})]})]},v.dashboard_id))]})]})}const yu="modulepreload",gu=function(e){return"/"+e},Ar={},xu=function(s,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=l(n.map(u=>{if(u=gu(u),u in Ar)return;Ar[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const y=document.createElement("link");if(y.rel=c?"stylesheet":yu,c||(y.as="script"),y.crossOrigin="",y.href=u,d&&y.setAttribute("nonce",d),document.head.appendChild(y),c)return new Promise((f,g)=>{y.addEventListener("load",f),y.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return s().catch(i)})},Ja=["#00FF41","#00cc33","#33ff66","#FFB000","#00c8ff","#aa66ff","#ff6644","#88ff44","#44ddaa","#ffaa00"],vu={background:"transparent",colorScheme:{default:Ja},series:{bar:{style:{fillOpacity:.85}},line:{style:{lineWidth:2}},area:{style:{fillOpacity:.2}},pie:{style:{stroke:"rgba(0,255,65,0.06)",lineWidth:1}}},component:{axis:{domainLine:{style:{stroke:"rgba(0,255,65,0.1)"}},grid:{style:{stroke:"rgba(0,255,65,0.05)",lineDash:[3,3]}},label:{style:{fill:"#3d6b3d",fontSize:10}},title:{style:{fill:"#6b9b6b",fontSize:11}}},legend:{item:{label:{style:{fill:"#6b9b6b",fontSize:10}}}},tooltip:{panel:{style:{background:"rgba(0,0,0,0.95)",border:"1px solid rgba(0,255,65,0.15)",borderRadius:"2px",boxShadow:"0 0 12px rgba(0,255,65,0.06)"}},titleLabel:{style:{fill:"#b8d4b8",fontSize:11}},contentLabel:{style:{fill:"#6b9b6b",fontSize:10}},contentValue:{style:{fill:"#00FF41",fontSize:10}}}}};let gt=null;const ju=async()=>gt||(gt=(await xu(()=>import("./index-Dwi2cu_B.js"),__vite__mapDeps([0,1,2]))).default,gt);function bu({spec:e,data:s,title:n,height:r=340,loading:a}){const i=m.useRef(null),l=m.useRef(null),[o,d]=m.useState(!!gt);m.useEffect(()=>{gt||ju().then(()=>d(!0))},[]);const u=m.useMemo(()=>{const c={...e};return s&&s.length>0&&(Array.isArray(c.data)?c.data=c.data.map((h,y)=>y===0?{...h,values:s}:h):c.data&&typeof c.data=="object"?c.data={...c.data,values:s}:c.data={id:"kpiData",values:s}),c.background="transparent",c.padding=c.padding??12,c.width=void 0,c.height=r,c.color||(c.color=Ja),c.theme={...vu},c},[e,s,r]);return m.useEffect(()=>{if(!i.current||!o||!gt)return;if(l.current){l.current.updateSpec(u);return}const c=new gt(u,{dom:i.current});return c.renderSync(),l.current=c,()=>{c.release(),l.current=null}},[u,o]),a||!o?t.jsx(z,{className:"glass-panel hud-corners",children:t.jsx("div",{style:{display:"flex",justifyContent:"center",padding:40},children:t.jsx(Ot,{})})}):!e||!e.type?t.jsx(z,{className:"glass-panel hud-corners",children:t.jsx(le,{description:"Invalid VChart spec"})}):t.jsx(z,{className:"glass-panel hud-corners",title:n?t.jsx("span",{className:"font-display",style:{fontWeight:600},children:n}):void 0,children:t.jsx("div",{ref:i,style:{width:"100%",height:r}})})}function gn(e){return e>=80?"#00FF41":e>=50?"#FFB000":"#FF0033"}function Su({projectId:e,startDate:s,endDate:n,interval:r}){const a={project_id:e,start_date:s||void 0,end_date:n||void 0},{data:i}=B({queryKey:["kpi-mpi",e,s,n],queryFn:()=>rd(a),enabled:!!e}),{data:l}=B({queryKey:["kpi-mttr",e,s,n],queryFn:()=>ad(a),enabled:!!e}),{data:o}=B({queryKey:["kpi-rpr",e],queryFn:()=>id({project_id:e}),enabled:!!e}),{data:d}=B({queryKey:["kpi-fleet",e,s,n],queryFn:()=>ld(a),enabled:!!e}),{data:u}=B({queryKey:["kpi-convergence",e,s,n,r],queryFn:()=>od({...a,interval:r}),enabled:!!e}),c=m.useMemo(()=>{var f;return((f=u==null?void 0:u.points)==null?void 0:f.map(g=>{var v,b;return{timestamp:g.timestamp,open:Number(((v=g.dimensions)==null?void 0:v.open_count)??g.value??0),closed:Number(((b=g.dimensions)==null?void 0:b.closed_count)??0)}}))??[]},[u]),h=[{title:"Miles Per Intervention",value:i==null?void 0:i.value,unit:"km"},{title:"Mean Time To Resolution",value:l==null?void 0:l.value,unit:"hours"}],y=[{title:"Regression Pass Rate",value:o==null?void 0:o.value,unit:"%"},{title:"Fleet Utilization",value:d==null?void 0:d.value,unit:"%"}];return t.jsxs(t.Fragment,{children:[t.jsxs(ae,{gutter:[16,16],style:{marginBottom:24},children:[h.map(f=>t.jsx(O,{xs:24,sm:12,lg:6,children:t.jsx(z,{className:"glass-panel hud-corners",style:{height:"100%"},children:t.jsx(Nt,{title:t.jsx("span",{className:"font-display",style:{fontWeight:600,fontSize:9,textTransform:"uppercase",letterSpacing:"0.06em"},children:f.title}),value:f.value!=null?Number(f.value):void 0,precision:1,suffix:t.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:f.unit}),valueStyle:{fontFamily:"var(--font-mono)",fontWeight:700,color:"#00FF41",textShadow:"0 0 8px rgba(0,255,65,0.25)"}})})},f.title)),y.map(f=>{const g=f.value!=null?Number(f.value):null;return t.jsx(O,{xs:24,sm:12,lg:6,children:t.jsxs(z,{className:"glass-panel hud-corners",style:{height:"100%"},children:[t.jsx("div",{className:"font-display",style:{fontWeight:600,fontSize:9,color:"var(--text-muted)",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.06em"},children:f.title}),t.jsxs("div",{style:{fontFamily:"var(--font-mono)",fontSize:24,fontWeight:700,color:g!=null?gn(g):"var(--text-primary)",marginBottom:8,textShadow:g!=null?`0 0 8px ${gn(g)}40`:"none"},children:[g!=null?g.toFixed(1):"â€”",t.jsx("span",{style:{fontSize:12,color:"var(--text-muted)",marginLeft:4},children:f.unit})]}),t.jsx(ta,{percent:g!=null?Math.min(100,Math.max(0,g)):0,showInfo:!1,strokeColor:g!=null?gn(g):"#00FF41",size:"small"})]})},f.title)})]}),t.jsx(z,{className:"glass-panel hud-corners",title:t.jsx("span",{className:"font-display",style:{fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Issue Convergence"}),children:c.length>0?t.jsx(Tt,{width:"100%",height:300,children:t.jsxs(na,{data:c,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"openGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#FF0033",stopOpacity:.2}),t.jsx("stop",{offset:"100%",stopColor:"#FF0033",stopOpacity:0})]}),t.jsxs("linearGradient",{id:"closedGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#00FF41",stopOpacity:.2}),t.jsx("stop",{offset:"100%",stopColor:"#00FF41",stopOpacity:0})]})]}),t.jsx(as,{strokeDasharray:"3 3",stroke:"rgba(0,255,65,0.04)"}),t.jsx(vt,{dataKey:"timestamp",tick:{fontSize:10,fill:"#3d6b3d"},tickFormatter:f=>new Date(f).toLocaleDateString(),stroke:"rgba(0,255,65,0.04)"}),t.jsx(Ve,{tick:{fontSize:10,fill:"#3d6b3d"},stroke:"rgba(0,255,65,0.04)"}),t.jsx(Ae,{labelFormatter:f=>new Date(f).toLocaleDateString(),contentStyle:{background:"rgba(0,0,0,0.95)",border:"1px solid rgba(0,255,65,0.15)",borderRadius:2,color:"#b8d4b8"}}),t.jsx(rt,{}),t.jsx(vn,{type:"monotone",dataKey:"open",stroke:"#FF0033",fill:"url(#openGrad)",name:"Open",strokeWidth:2}),t.jsx(vn,{type:"monotone",dataKey:"closed",stroke:"#00FF41",fill:"url(#closedGrad)",name:"Closed",strokeWidth:2})]})}):t.jsx(le,{description:"No convergence data available"})})]})}function ku({def:e,projectId:s}){var o,d,u,c,h,y,f;const n={};s&&(n.project_id=s);const{data:r,isLoading:a}=B({queryKey:["kpi-custom",e.kpi_id,s],queryFn:()=>yd(e.kpi_id,n),enabled:e.enabled}),i=e.renderer==="vchart"&&e.vchart_spec,l=((o=e.visualization)==null?void 0:o.chart_type)??"stat";if(i&&e.vchart_spec){const g=r!=null&&r.groups?r.groups.map(v=>({...v.group,value:v.value})):(r==null?void 0:r.value)!=null?[{value:r.value}]:[];return t.jsx(bu,{spec:e.vchart_spec,data:g,title:e.name,loading:a})}if(l==="stat")return t.jsx(Er,{title:e.name,value:(r==null?void 0:r.value)??null,loading:a});if(l==="table"&&(r!=null&&r.groups))return t.jsx(z,{className:"glass-panel hud-corners",title:t.jsx("span",{className:"font-display",style:{fontWeight:600},children:e.name}),children:t.jsx(au,{groups:r.groups})});if(r!=null&&r.groups&&r.groups.length>0){const g=r.groups.map(R=>({...R.group,value:R.value})),v=((u=(d=e.visualization)==null?void 0:d.x_axis)==null?void 0:u.field)??Object.keys(((c=r.groups[0])==null?void 0:c.group)??{})[0]??"group",b=((y=(h=e.visualization)==null?void 0:h.y_axes)==null?void 0:y.map(R=>({key:R.variable??"value",label:R.label,color:R.color,axisId:R.axis_id})))??[{key:"value",label:e.name}],_=(f=e.visualization)==null?void 0:f.thresholds;return t.jsx(z,{className:"glass-panel hud-corners",title:t.jsx("span",{className:"font-display",style:{fontWeight:600},children:e.name}),children:t.jsx(ru,{chartType:l,data:g,xField:v,yFields:b,thresholds:_})})}return t.jsx(Er,{title:e.name,value:(r==null?void 0:r.value)??null,loading:a})}function _u(){const e=qe(),[s,n]=m.useState(""),[r,a]=m.useState(""),[i,l]=m.useState(""),[o,d]=m.useState("day"),[u,c]=m.useState(!0),[h,y]=m.useState(!1),[f,g]=m.useState(!1),[v,b]=m.useState(),{data:_}=B({queryKey:["projects"],queryFn:()=>us({})}),{data:R}=B({queryKey:["kpi-definitions"],queryFn:hd}),C=fe({mutationFn:F=>fd(F),onSuccess:()=>e.invalidateQueries({queryKey:["kpi-definitions"]})}),w=m.useMemo(()=>{if(!R)return new Map;const F=new Map;for(const j of R.filter(S=>S.enabled)){const S=j.dashboard_id??"__ungrouped__",I=F.get(S)??[];I.push(j),F.set(S,I)}return F},[R]);return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24,flexWrap:"wrap",gap:16},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx(Aa,{size:24,style:{color:"#00FF41"}}),t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:"KPI Overview"}),t.jsx("p",{className:"page-subtitle",children:"Key performance indicators for autonomous driving test campaigns"})]})]}),t.jsxs(H,{wrap:!0,children:[t.jsx(Z,{value:s||void 0,onChange:n,placeholder:"Select Project",style:{width:200},allowClear:!0,options:_==null?void 0:_.map(F=>({value:F.id,label:F.name}))}),t.jsx(xs,{placeholder:"Start date",onChange:(F,j)=>a(typeof j=="string"?j:""),style:{width:140}}),t.jsx(xs,{placeholder:"End date",onChange:(F,j)=>l(typeof j=="string"?j:""),style:{width:140}}),t.jsx(Z,{value:o,onChange:F=>d(F),style:{width:110},options:[{value:"day",label:"Daily"},{value:"week",label:"Weekly"},{value:"month",label:"Monthly"}]})]})]}),t.jsx(z,{className:"glass-panel hud-corners",style:{marginBottom:24},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-display",style:{fontWeight:600,fontSize:13,marginBottom:4,textTransform:"uppercase",letterSpacing:"0.06em"},children:"Panel Configuration"}),t.jsxs(H,{children:[t.jsx("span",{style:{color:"var(--text-muted)",fontSize:12},children:"Built-in metrics"}),t.jsx(Zr,{size:"small",checked:u,onChange:c})]})]}),t.jsxs(H,{children:[t.jsx(q,{icon:t.jsx(qa,{size:14}),onClick:()=>g(!0),style:{borderColor:"rgba(0,255,65,0.2)",color:"#00FF41"},children:"Import JSON"}),t.jsx(q,{type:"primary",icon:t.jsx(Da,{size:14}),onClick:()=>{b(void 0),y(!0)},children:"Add Custom KPI"})]})]})}),!s&&t.jsxs(z,{className:"glass-panel hud-corners",style:{textAlign:"center",padding:"40px 0"},children:[t.jsx(pc,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:16}}),t.jsx("p",{style:{color:"var(--text-muted)",fontSize:14},children:"Select a project to view KPI metrics"})]}),s&&t.jsxs(t.Fragment,{children:[u&&t.jsx(Su,{projectId:s,startDate:r,endDate:i,interval:o}),w.size>0&&t.jsxs("div",{style:{marginTop:24},children:[t.jsx("div",{className:"font-display",style:{fontWeight:600,fontSize:12,marginBottom:12,color:"#b8d4b8",textTransform:"uppercase",letterSpacing:"0.04em"},children:"Custom KPIs"}),Array.from(w.entries()).map(([F,j])=>{var k;const S=(k=j[0])==null?void 0:k.dashboard_name,I=F!=="__ungrouped__",T=t.jsx(ae,{gutter:[16,16],children:j.map(x=>{var $;const E=x.renderer==="vchart"||(($=x.visualization)==null?void 0:$.chart_type)!=="stat";return t.jsx(O,{xs:24,md:E?24:8,children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx(ku,{def:x,projectId:s}),t.jsxs("div",{style:{position:"absolute",top:8,right:8,display:"flex",gap:4},children:[t.jsx(q,{size:"small",type:"text",icon:t.jsx(Na,{size:12}),onClick:()=>{b(x),y(!0)},style:{color:"var(--text-muted)"}}),t.jsx(ea,{title:"Delete this KPI?",onConfirm:()=>C.mutate(x.kpi_id),okText:"Delete",cancelText:"Cancel",children:t.jsx(q,{size:"small",type:"text",danger:!0,icon:t.jsx(Js,{size:12})})})]})]})},x.kpi_id)})});return I?t.jsx(Xr,{ghost:!0,defaultActiveKey:[F],style:{marginBottom:16},items:[{key:F,label:t.jsxs(H,{children:[t.jsx("span",{style:{color:"#e2e8f0",fontWeight:600},children:S??F}),t.jsxs(K,{color:"cyan",children:[j.length," KPIs"]}),j.some(x=>x.renderer==="vchart")&&t.jsx(K,{color:"magenta",children:"VChart"})]}),children:T}]},F):t.jsx("div",{children:T},F)})]})]}),t.jsx(hu,{open:h,onClose:()=>{y(!1),b(void 0)},onSaved:()=>{e.invalidateQueries({queryKey:["kpi-definitions"]}),y(!1),b(void 0)},editingDef:v}),t.jsx(fu,{open:f,onClose:()=>g(!1),onImported:()=>e.invalidateQueries({queryKey:["kpi-definitions"]})})]})}const Or={requirement:"#3b82f6",commit:"#64748b",build:"#f59e0b",project:"#6366f1",task:"#8b5cf6",run:"#22c55e",issue:"#ef4444"},Cu={requirement:"REQ",commit:"CMT",build:"BLD",project:"PRJ",task:"TSK",run:"RUN",issue:"ISS"};function wu(){const[e,s]=m.useState("forward"),[n,r]=m.useState(""),[a,i]=m.useState(""),{data:l,isLoading:o}=B({queryKey:["trace-forward",a],queryFn:()=>td(a),enabled:e==="forward"&&!!a}),{data:d,isLoading:u}=B({queryKey:["trace-backward",a],queryFn:()=>sd(a),enabled:e==="backward"&&!!a}),{data:c}=B({queryKey:["trace-coverage"],queryFn:()=>nd()}),h=()=>{i(n.trim())},y=e==="forward"?l:d,f=e==="forward"?o:u,g=(y==null?void 0:y.links)??[];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[t.jsx(ac,{size:28,style:{color:"#6366f1"}}),t.jsx("h1",{className:"page-title",children:"Traceability"})]}),t.jsx("p",{className:"page-subtitle",style:{marginBottom:24},children:"End-to-end links between requirements, tasks, runs, and issues for coverage and impact analysis."}),c&&t.jsxs(z,{className:"glass-panel",style:{marginBottom:24},children:[t.jsx("div",{style:{fontFamily:"var(--font-mono)",fontWeight:500,fontSize:11,color:"var(--text-muted)",marginBottom:10,textTransform:"uppercase",letterSpacing:"0.04em"},children:"Requirement Verification Coverage"}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:20},children:[t.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:24,fontWeight:700,color:"#00FF41",textShadow:"0 0 8px rgba(0,255,65,0.25)"},children:c.percentage!=null?`${Number(c.percentage).toFixed(1)}%`:"â€”"}),t.jsx("div",{style:{flex:1},children:t.jsx(ta,{percent:Number(c.percentage??0),showInfo:!1,strokeColor:{from:"#00FF41",to:"#00cc33"}})}),t.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",whiteSpace:"nowrap"},children:[c.covered??0," / ",c.total??0," verified"]})]})]}),t.jsx(Jr,{activeKey:e,onChange:v=>{s(v),i(""),r("")},items:[{key:"forward",label:"Forward Trace"},{key:"backward",label:"Backward Trace"}],style:{marginBottom:16}}),t.jsxs(H.Compact,{style:{width:"100%",maxWidth:500,marginBottom:24},children:[t.jsx(J,{value:n,onChange:v=>r(v.target.value),placeholder:e==="forward"?"Enter Requirement ID...":"Enter Issue ID...",onPressEnter:h,size:"large"}),t.jsx(q,{type:"primary",icon:t.jsx(Zs,{}),onClick:h,disabled:!n.trim(),size:"large",children:"Trace"})]}),f&&t.jsx(Ts,{}),y&&y.nodes&&y.nodes.length>0&&t.jsx(z,{className:"glass-panel",title:t.jsxs("span",{className:"font-display",style:{fontWeight:600},children:[e==="forward"?"Forward":"Backward"," Trace from"," ",t.jsx("code",{style:{color:"#818cf8"},children:y.origin_id})]}),children:t.jsx(Gr,{items:y.nodes.map((v,b)=>{const _=v.type,R=b<g.length?g[b]:null;return{dot:t.jsx("div",{style:{width:32,height:32,borderRadius:"50%",background:Or[_]??"#64748b",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:700,color:"#fff",fontFamily:"var(--font-mono)",boxShadow:`0 0 12px ${Or[_]??"#64748b"}40`},children:Cu[_]??"?"}),children:t.jsxs("div",{style:{paddingBottom:8},children:[t.jsx("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:v.label||v.id}),t.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[_," Â· ",t.jsx("code",{children:v.id})]}),R&&t.jsx(K,{style:{marginTop:4,fontSize:11,fontStyle:"italic"},children:R.relationship})]})}})})}),a&&!f&&y&&(!y.nodes||y.nodes.length===0)&&t.jsx(z,{className:"glass-panel",children:t.jsx(le,{description:`No trace results found for "${a}"`})})]})}function Iu(){return t.jsx(Md,{icon:ec,iconColor:"#818cf8",title:"Auto-Triage",description:"Intelligent automated issue classification and assignment powered by rule engine and ML models.",featuresLabel:"Planned Capabilities",features:["Rule-based classification","ML severity prediction","Auto-assignment to team","Historical pattern matching"]})}const Ds=["#6366f1","#22c55e","#f59e0b","#ef4444","#3b82f6","#ec4899","#14b8a6","#a855f7"],Ru=(e,s)=>ts.divIcon({className:"",html:`<div style="width:20px;height:20px;border-radius:50%;background:${e};border:2px solid #fff;box-shadow:0 1px 4px rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:bold;color:#fff">${s+1}</div>`,iconSize:[20,20],iconAnchor:[10,10]});function Fu({onAdd:e}){return Fi({click(s){e(s.latlng.lat,s.latlng.lng)}}),null}function Pu({routes:e,onChange:s,mode:n,startPoint:r}){const[a,i]=m.useState(!1),[l,o]=m.useState(-1),[d,u]=m.useState(!1),c=e.length>0&&e[0].waypoints.length>0?[e[0].waypoints[0].lat,e[0].waypoints[0].lng]:r?[r.lat,r.lng]:[31.23,121.47],h=n==="custom"||d,y=l>=0&&l<e.length?l:e.length>0?e.length-1:-1,f=m.useCallback((S,I)=>{if(!h)return;const T=[...e];if(T.length===0)T.push({route_id:`ROUTE-${Date.now().toString(36)}`,name:"Route 1",waypoints:[{lat:S,lng:I}]});else{const k=y>=0?y:T.length-1,x={...T[k],waypoints:[...T[k].waypoints,{lat:S,lng:I}]};delete x.road,T[k]=x}s(T)},[e,s,h,y]),g=(S,I)=>{const T=[...e],k={...T[S],waypoints:T[S].waypoints.filter((x,E)=>E!==I)};delete k.road,T[S]=k,s(T)},v=(S,I,T,k)=>{const x=[...e],E=[...x[S].waypoints];E[I]={lat:T,lng:k};const $={...x[S],waypoints:E};delete $.road,x[S]=$,s(x)},b=()=>{const S=e.length;s([...e,{route_id:`ROUTE-${Date.now().toString(36)}`,name:`Route ${S+1}`,waypoints:[]}]),o(S)},_=S=>{s(e.filter((I,T)=>T!==S)),l>=e.length-1&&o(Math.max(0,e.length-2))},R=async()=>{if(e.filter(I=>I.waypoints.length>=2).length===0){X.warning("Each route needs at least 2 waypoints to plan a road route");return}i(!0);try{const I=await Pd(e);s(I.routes),X.success(`${I.routes.length} route(s) snapped to real roads`)}catch(I){X.error(`Road planning failed: ${I.message}`)}finally{i(!1)}},C=()=>{u(!d),!d&&e.length>0&&o(e.length-1)},w=e.some(S=>S.road),F=e.reduce((S,I)=>{var T;return S+(((T=I.road)==null?void 0:T.total_distance_m)??0)},0),j=e.reduce((S,I)=>{var T;return S+(((T=I.road)==null?void 0:T.total_duration_s)??0)},0);return e.length===0&&n==="random"?t.jsx("div",{style:{marginTop:16},children:t.jsx(le,{description:"Click 'Generate Routes' above to preview"})}):t.jsxs("div",{style:{marginTop:16},children:[t.jsx(Ot,{spinning:a,tip:"Snapping routes to real roads via OSRM...",children:t.jsx("div",{style:{height:400,marginBottom:12,position:"relative"},children:t.jsxs(qn,{center:c,zoom:12,style:{height:"100%",width:"100%",borderRadius:8},children:[t.jsx(Kn,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"Â© CartoDB"}),h&&t.jsx(Fu,{onAdd:f}),e.map((S,I)=>{var $;const T=Ds[I%Ds.length],k=($=S.road)==null?void 0:$.coordinates,x=k??S.waypoints,E=I===y;return t.jsxs("span",{children:[t.jsx(vs,{positions:x.map(se=>[se.lat,se.lng]),pathOptions:{color:T,weight:k?4:3,opacity:E?.9:.4,dashArray:k?void 0:"8 4"}}),k&&S.waypoints.length>0&&t.jsx(vs,{positions:S.waypoints.map(se=>[se.lat,se.lng]),pathOptions:{color:T,weight:1,opacity:.3,dashArray:"4 4"}}),S.waypoints.map((se,ce)=>t.jsx(Bn,{position:[se.lat,se.lng],icon:Ru(T,ce),draggable:h,eventHandlers:{dragend:de=>{const it=de.target.getLatLng();v(I,ce,it.lat,it.lng)}},children:t.jsx(Un,{children:t.jsxs("div",{style:{fontSize:12,minWidth:180},children:[t.jsx("strong",{children:S.name||S.route_id})," â€” WP ",ce+1,t.jsx("br",{}),t.jsxs(H,{size:4,style:{marginTop:4},children:[t.jsx(Ie,{size:"small",style:{width:90},step:1e-4,value:Number(se.lat.toFixed(5)),onChange:de=>de!=null&&v(I,ce,de,se.lng)}),t.jsx(Ie,{size:"small",style:{width:90},step:1e-4,value:Number(se.lng.toFixed(5)),onChange:de=>de!=null&&v(I,ce,se.lat,de)})]}),h&&t.jsx("div",{style:{marginTop:4},children:t.jsx(q,{size:"small",type:"text",danger:!0,icon:t.jsx(Js,{size:10}),onClick:()=>g(I,ce),children:"Remove"})})]})})},`wp-${S.route_id}-${ce}`)),x.length>0&&t.jsx(jn,{center:[x[0].lat,x[0].lng],radius:7,pathOptions:{color:"#fff",fillColor:T,fillOpacity:1,weight:2},children:t.jsxs(Ws,{children:[S.name||S.route_id," (Start)"]})}),x.length>1&&t.jsx(jn,{center:[x[x.length-1].lat,x[x.length-1].lng],radius:7,pathOptions:{color:"#fff",fillColor:"#ef4444",fillOpacity:1,weight:2},children:t.jsxs(Ws,{children:[S.name||S.route_id," (End)"]})})]},S.route_id)})]})})}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,flexWrap:"wrap",gap:8},children:[t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:[e.length," route(s) Â· ",h?"Click map to add waypoints Â· Drag to move":"View only",w&&t.jsxs("span",{style:{marginLeft:8},children:[t.jsx(Qr,{status:"success",text:"",style:{marginRight:4}}),"Road-planned Â· ",(F/1e3).toFixed(1)," km Â· ~",Math.round(j/60)," min"]})]}),t.jsxs("div",{style:{display:"flex",gap:8},children:[e.length>0&&e.some(S=>S.waypoints.length>=2)&&t.jsx(q,{size:"small",type:w?"default":"primary",icon:t.jsx(cc,{size:12}),loading:a,onClick:R,children:w?"Re-plan Roads":"Plan on Roads"}),n==="random"&&e.length>0&&t.jsx(q,{size:"small",type:d?"primary":"default",icon:d?t.jsx(yc,{size:12}):t.jsx(Na,{size:12}),onClick:C,children:d?"Done Editing":"Edit Waypoints"}),h&&t.jsx(q,{size:"small",icon:t.jsx(La,{size:12}),onClick:b,children:"New Route"})]})]}),t.jsx(dr,{size:"small",dataSource:e,renderItem:(S,I)=>{const T=I===y&&h;return t.jsx(dr.Item,{style:{cursor:h?"pointer":void 0,background:T?"rgba(99,102,241,0.1)":void 0,borderRadius:4},onClick:()=>h&&o(I),actions:h?[t.jsx(q,{size:"small",type:"text",danger:!0,icon:t.jsx(Js,{size:12}),onClick:k=>{k.stopPropagation(),_(I)}})]:void 0,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[t.jsx(K,{color:Ds[I%Ds.length],children:S.name||S.route_id}),t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:[S.waypoints.length," waypoints"]}),S.road&&t.jsxs(Yr.Text,{type:"success",style:{fontSize:11},children:[(S.road.total_distance_m/1e3).toFixed(1)," km Â· ",S.road.coordinates.length," pts"]}),T&&t.jsx(K,{color:"processing",style:{fontSize:10},children:"Active"})]})})}})]})}function Tu({vehicles:e,projects:s,tasks:n,assignments:r,onChange:a}){const i=(c,h)=>r.some(y=>y.vin===c&&y.task_id===h),l=(c,h,y)=>{i(c,h)?a(r.filter(f=>!(f.vin===c&&f.task_id===h))):a([...r,{vin:c,project_id:y,task_id:h}])},o=()=>{if(n.length===0)return;const c=n[0],h=s.find(y=>y.id===c.projectId);h&&a(e.map(y=>({vin:y.vin,project_id:h.id,task_id:c.id})))},d=()=>{const c=[];e.forEach((h,y)=>{const f=n[y%n.length],g=s.find(v=>v.id===f.projectId);g&&c.push({vin:h.vin,project_id:g.id,task_id:f.id})}),a(c)},u=[{title:"Vehicle",dataIndex:"vin",key:"vin",fixed:"left",width:180,render:c=>t.jsx("code",{style:{fontSize:11},children:c})},...n.map(c=>{const h=s.find(y=>y.id===c.projectId);return{title:t.jsxs("div",{style:{textAlign:"center",fontSize:11},children:[t.jsx("div",{children:t.jsx(K,{color:"blue",style:{fontSize:10},children:(h==null?void 0:h.name)??c.projectId})}),t.jsx("div",{children:c.title})]}),key:c.id,width:140,render:(y,f)=>t.jsx("div",{style:{textAlign:"center"},children:t.jsx(pi,{checked:i(f.vin,c.id),onChange:()=>l(f.vin,c.id,c.projectId)})})}})];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:[r.length," assignment(s)"]}),t.jsxs(H,{size:"small",children:[t.jsx(q,{size:"small",onClick:o,children:"All â†’ First Task"}),t.jsx(q,{size:"small",onClick:d,children:"Round Robin"})]})]}),t.jsx(Se,{size:"small",dataSource:e,columns:u,rowKey:"vin",pagination:!1,scroll:{x:"max-content"}})]})}const Eu={Draft:"default",Running:"processing",Paused:"warning",Completed:"success",Aborted:"error"};function Mu(){var we;const e=zt(),s=qe(),[n,r]=m.useState(!1),[a,i]=m.useState(0),[l]=N.useForm(),[o,d]=m.useState("random"),[u,c]=m.useState("random"),[h,y]=m.useState(!0),[f,g]=m.useState([]),[v,b]=m.useState([]),[_,R]=m.useState([]),[C,w]=m.useState([]),[F,j]=m.useState([]),{data:S,isLoading:I}=B({queryKey:["simulations"],queryFn:()=>vd()}),{data:T}=B({queryKey:["projects"],queryFn:()=>us({})}),{data:k}=B({queryKey:["tasks"],queryFn:()=>Fs({})}),[x,E]=m.useState(!1),$=fe({mutationFn:P=>bd(P),onSuccess:async P=>{if(s.invalidateQueries({queryKey:["simulations"]}),r(!1),ms(),x&&P.session_id)try{await Nn(P.session_id),s.invalidateQueries({queryKey:["simulations"]}),X.success("Simulation created & started")}catch{X.warning("Created but failed to start â€” start it manually")}else X.success("Simulation saved as draft");E(!1)},onError:P=>{X.error(`Failed to create simulation: ${P.message}`),E(!1)}}),se=fe({mutationFn:P=>Sd(P),onSuccess:()=>{s.invalidateQueries({queryKey:["simulations"]}),X.success("Deleted")}}),ce=fe({mutationFn:P=>Nn(P),onSuccess:()=>{s.invalidateQueries({queryKey:["simulations"]}),X.success("Simulation started")}}),de=fe({mutationFn:P=>Fd(P),onSuccess:P=>g(P.vehicles)}),it=fe({mutationFn:P=>Rd(P),onSuccess:P=>{b(P.routes);const re=P.routes.some(G=>G.road);X.success(`${P.routes.length} route(s) generated${re?" with road planning":""}`)},onError:P=>X.error(`Route generation failed: ${P.message}`)});function ms(){i(0),d("random"),c("random"),y(!0),g([]),b([]),R([]),w([]),j([]),l.resetFields()}function ps(){const P=l.getFieldsValue(!0),re={name:P.name||"New Simulation",fleet_config:{mode:o,vehicle_count:P.vehicle_count??5,vehicles:o==="custom"?f:void 0,vehicle_template:o==="random"?{vehicle_platform:P.platform,soc_architecture:P.soc,sensor_suite_version:P.sensor}:void 0},route_config:{mode:u,routes:v.length>0?v.map(G=>({route_id:G.route_id,name:G.name,waypoints:G.waypoints,road:G.road?{total_distance_m:G.road.total_distance_m,total_duration_s:G.road.total_duration_s,coordinates:G.road.coordinates??[],segments:G.road.segments??[]}:void 0})):void 0,random_config:u==="random"?{start_point:{lat:P.start_lat??31.2304,lng:P.start_lng??121.4737},radius_km:P.radius_km??10,min_waypoints:P.min_waypoints??5,max_waypoints:P.max_waypoints??15}:void 0},report_config:{telemetry_interval_ms:(P.telemetry_interval??3)*1e3,issue_interval_range_ms:[(P.issue_min??30)*1e3,(P.issue_max??120)*1e3],status_change_interval_ms:(P.mode_switch??60)*1e3,speed_range_mps:[Math.round((P.speed_min??30)/3.6),Math.round((P.speed_max??120)/3.6)]},assignments:h?[]:_};$.mutate(re)}const Es=[{title:"Name",dataIndex:"name",key:"name",render:(P,re)=>t.jsx("a",{onClick:()=>e(`/simulation/${re.session_id}`),children:P})},{title:"Status",dataIndex:"status",key:"status",render:P=>t.jsx(K,{color:Eu[P]||"default",children:P})},{title:"Vehicles",key:"vehicles",render:(P,re)=>{var G,ze,ke;return((G=re.fleet_config)==null?void 0:G.vehicle_count)??((ke=(ze=re.fleet_config)==null?void 0:ze.vehicles)==null?void 0:ke.length)??0}},{title:"Telemetry Sent",key:"telemetry",render:(P,re)=>{var G;return((G=re.stats)==null?void 0:G.telemetry_sent)??0}},{title:"Issues Sent",key:"issues",render:(P,re)=>{var G;return((G=re.stats)==null?void 0:G.issues_sent)??0}},{title:"Mileage (km)",key:"mileage",render:(P,re)=>{var G;return(((G=re.stats)==null?void 0:G.total_mileage_km)??0).toFixed(1)}},{title:"Actions",key:"actions",render:(P,re)=>t.jsxs(H,{size:"small",children:[t.jsx(q,{size:"small",icon:t.jsx(nc,{size:12}),onClick:()=>e(`/simulation/${re.session_id}`)}),re.status==="Draft"&&t.jsx(q,{size:"small",type:"primary",icon:t.jsx(rn,{size:12}),onClick:()=>ce.mutate(re.session_id)}),t.jsx(ea,{title:"Delete simulation?",onConfirm:()=>se.mutate(re.session_id),children:t.jsx(q,{size:"small",danger:!0,icon:t.jsx(Js,{size:12})})})]})}],W=(k==null?void 0:k.filter(P=>C.includes(P.projectId)))??[],ne=[{title:"Fleet",content:t.jsxs("div",{children:[t.jsx(N.Item,{label:"Simulation Name",name:"name",rules:[{required:!0}],children:t.jsx(J,{placeholder:"My Fleet Simulation"})}),t.jsx(N.Item,{label:"Fleet Mode",children:t.jsxs(Lt.Group,{value:o,onChange:P=>d(P.target.value),children:[t.jsx(Lt.Button,{value:"random",children:"Random"}),t.jsx(Lt.Button,{value:"custom",children:"Custom"})]})}),o==="random"?t.jsxs(t.Fragment,{children:[t.jsx(N.Item,{label:"Vehicle Count",name:"vehicle_count",initialValue:5,children:t.jsx(dn,{min:1,max:100})}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Platform",name:"platform",children:t.jsx(J,{placeholder:"ORIN-X"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"SoC",name:"soc",children:t.jsx(J,{placeholder:"Orin-SoC-A"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Sensor Suite",name:"sensor",children:t.jsx(J,{placeholder:"LiDAR-v4"})})})]}),t.jsx(q,{onClick:()=>de.mutate({count:l.getFieldValue("vehicle_count")??5,template:{vehicle_platform:l.getFieldValue("platform"),soc_architecture:l.getFieldValue("soc"),sensor_suite_version:l.getFieldValue("sensor")}}),loading:de.isPending,children:"Preview Fleet"}),f.length>0&&t.jsx(Se,{size:"small",dataSource:f,rowKey:"vin",columns:[{title:"VIN",dataIndex:"vin"},{title:"Platform",dataIndex:"vehicle_platform"},{title:"Model",dataIndex:"model_code"}],pagination:!1,style:{marginTop:12}})]}):t.jsx(Se,{size:"small",dataSource:f,rowKey:"vin",columns:[{title:"VIN",dataIndex:"vin",render:(P,re,G)=>t.jsx(J,{size:"small",value:P,onChange:ze=>{const ke=[...f];ke[G]={...ke[G],vin:ze.target.value},g(ke)}})},{title:"Platform",dataIndex:"vehicle_platform",render:(P,re,G)=>t.jsx(J,{size:"small",value:P,onChange:ze=>{const ke=[...f];ke[G]={...ke[G],vehicle_platform:ze.target.value},g(ke)}})},{title:"Model",dataIndex:"model_code",render:(P,re,G)=>t.jsx(J,{size:"small",value:P,onChange:ze=>{const ke=[...f];ke[G]={...ke[G],model_code:ze.target.value},g(ke)}})}],pagination:!1,footer:()=>t.jsx(q,{size:"small",onClick:()=>g([...f,{vin:`SIM-${Date.now().toString(36)}`,plate_type:"temporary",model_code:"AD-SUV-01",vehicle_platform:"ORIN-X",sensor_suite_version:"LiDAR-v4",soc_architecture:"Orin-SoC-A"}]),children:"Add Vehicle"})})]})},{title:"Project/Task",content:t.jsxs("div",{children:[t.jsxs(N.Item,{label:"Use Default Project",children:[t.jsx(Zr,{checked:h,onChange:y}),t.jsx("span",{style:{marginLeft:8,color:"var(--text-muted)",fontSize:12},children:"Auto-create a simulation-specific project and task"})]}),!h&&t.jsxs(t.Fragment,{children:[t.jsx(N.Item,{label:"Select Projects",children:t.jsx(Z,{mode:"multiple",value:C,onChange:w,placeholder:"Select projects",options:(T==null?void 0:T.map(P=>({value:P.id,label:P.name})))??[],style:{width:"100%"}})}),t.jsx(N.Item,{label:"Select Tasks",children:t.jsx(Z,{mode:"multiple",value:F,onChange:j,placeholder:"Select tasks",options:W.map(P=>({value:P.id,label:`${P.title} (${P.taskType??P.stage})`}))??[],style:{width:"100%"}})}),f.length>0&&F.length>0&&t.jsx(Tu,{vehicles:f,projects:(T==null?void 0:T.filter(P=>C.includes(P.id)))??[],tasks:W.filter(P=>F.includes(P.id)),assignments:_,onChange:R})]})]})},{title:"Routes",content:t.jsxs("div",{children:[t.jsx(N.Item,{label:"Route Mode",children:t.jsxs(Lt.Group,{value:u,onChange:P=>c(P.target.value),children:[t.jsx(Lt.Button,{value:"random",children:"Random"}),t.jsx(Lt.Button,{value:"custom",children:"Custom"})]})}),u==="random"?t.jsxs(t.Fragment,{children:[t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Start Lat",name:"start_lat",initialValue:31.2304,children:t.jsx(Ie,{style:{width:"100%"},step:.001})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Start Lng",name:"start_lng",initialValue:121.4737,children:t.jsx(Ie,{style:{width:"100%"},step:.001})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Radius (km)",name:"radius_km",initialValue:10,children:t.jsx(Ie,{min:1,max:50,style:{width:"100%"}})})})]}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Min Waypoints",name:"min_waypoints",initialValue:5,children:t.jsx(Ie,{min:2,max:50,style:{width:"100%"}})})}),t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Max Waypoints",name:"max_waypoints",initialValue:15,children:t.jsx(Ie,{min:2,max:50,style:{width:"100%"}})})})]}),t.jsx(q,{onClick:()=>it.mutate({start_point:{lat:l.getFieldValue("start_lat")??31.2304,lng:l.getFieldValue("start_lng")??121.4737},radius_km:l.getFieldValue("radius_km")??10,count:f.length||l.getFieldValue("vehicle_count")||5,min_waypoints:l.getFieldValue("min_waypoints")??5,max_waypoints:l.getFieldValue("max_waypoints")??15}),loading:it.isPending,children:"Generate Routes"})]}):null,t.jsx(Pu,{routes:v,onChange:b,mode:u,startPoint:u==="random"?{lat:l.getFieldValue("start_lat")??31.2304,lng:l.getFieldValue("start_lng")??121.4737}:void 0})]})},{title:"Reporting",content:t.jsxs("div",{children:[t.jsx(N.Item,{label:"Telemetry Interval (seconds)",name:"telemetry_interval",initialValue:3,children:t.jsx(dn,{min:1,max:30})}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Issue Min Interval (sec)",name:"issue_min",initialValue:30,children:t.jsx(Ie,{min:5,max:600,style:{width:"100%"}})})}),t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Issue Max Interval (sec)",name:"issue_max",initialValue:120,children:t.jsx(Ie,{min:10,max:600,style:{width:"100%"}})})})]}),t.jsx(N.Item,{label:"Driving Mode Switch Interval (sec)",name:"mode_switch",initialValue:60,children:t.jsx(dn,{min:10,max:300})}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Min Speed (km/h)",name:"speed_min",initialValue:30,children:t.jsx(Ie,{min:5,max:200,style:{width:"100%"}})})}),t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Max Speed (km/h)",name:"speed_max",initialValue:120,children:t.jsx(Ie,{min:10,max:200,style:{width:"100%"}})})})]})]})},{title:"Review",content:t.jsx("div",{children:t.jsx(z,{className:"glass-panel",style:{marginBottom:16},children:t.jsxs(ae,{gutter:[16,8],children:[t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Name:"})," ",l.getFieldValue("name")||"New Simulation"]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Fleet:"})," ",o==="random"?`${l.getFieldValue("vehicle_count")??5} random vehicles`:`${f.length} custom vehicles`]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Routes:"})," ",u==="random"?"Auto-generated":`${v.length} custom routes`]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Project:"})," ",h?"Auto-create":`${C.length} selected`]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Telemetry:"})," every ",l.getFieldValue("telemetry_interval")??3,"s"]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Speed:"})," ",l.getFieldValue("speed_min")??30," - ",l.getFieldValue("speed_max")??120," km/h"]})]})})})}];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24,flexWrap:"wrap",gap:16},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx(lc,{size:28,style:{color:"#22c55e"}}),t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:"Fleet Simulation"}),t.jsx("p",{className:"page-subtitle",children:"Simulate vehicle fleets for demo and stress testing"})]})]}),t.jsx(q,{type:"primary",icon:t.jsx(Da,{size:14}),onClick:()=>{ms(),r(!0)},children:"New Simulation"})]}),t.jsx(z,{className:"glass-panel",children:t.jsx(Se,{dataSource:S??[],columns:Es,rowKey:"session_id",loading:I,pagination:{pageSize:10},size:"middle"})}),t.jsxs(rs,{open:n,onCancel:()=>r(!1),width:900,title:"Create Simulation",footer:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(q,{disabled:a===0,onClick:()=>i(a-1),children:"Previous"}),t.jsxs(H,{children:[a<ne.length-1&&t.jsx(q,{type:"primary",onClick:()=>i(a+1),children:"Next"}),a===ne.length-1&&t.jsxs(t.Fragment,{children:[t.jsx(q,{onClick:()=>{E(!1),ps()},loading:$.isPending&&!x,children:"Save as Draft"}),t.jsx(q,{type:"primary",onClick:()=>{E(!0),ps()},loading:$.isPending&&x,children:"Create & Start"})]})]})]}),destroyOnClose:!0,children:[t.jsx(fi,{current:a,items:ne.map(P=>({title:P.title})),style:{marginBottom:24},size:"small"}),t.jsx(N,{form:l,layout:"vertical",children:(we=ne[a])==null?void 0:we.content})]})]})}const Au={Draft:"default",Running:"processing",Paused:"warning",Completed:"success",Aborted:"error"},Dt=["#22c55e","#3b82f6","#f59e0b","#ef4444","#ec4899","#14b8a6","#a855f7","#6366f1"],$s=["#6366f1","#22c55e","#f59e0b","#ef4444","#3b82f6","#ec4899","#14b8a6","#a855f7"];function zr(e,s){return ts.divIcon({className:"",html:`<div style="width:22px;height:22px;display:flex;align-items:center;justify-content:center;transform:rotate(${s}deg)">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="${e}" stroke="#fff" stroke-width="1.5">
        <path d="M12 2L6 12l6 4 6-4z"/>
      </svg>
    </div>`,iconSize:[22,22],iconAnchor:[11,11]})}function Ou({vehicles:e}){const s=Pi(),n=m.useRef(new Map);return m.useEffect(()=>{const r=new Set;e.forEach((a,i)=>{if(!a.current)return;r.add(a.vin);const l=Dt[i%Dt.length],o=ts.latLng(a.current.lat,a.current.lng),d=a.current.heading_deg??0,u=n.current.get(a.vin);if(u)u.setLatLng(o),u.setIcon(zr(l,d));else{const h=ts.marker(o,{icon:zr(l,d)}).bindTooltip(`${a.vin}<br/>${(a.current.speed_mps*3.6).toFixed(0)} km/h Â· ${a.current.driving_mode}`,{direction:"top",offset:[0,-12]}).addTo(s);n.current.set(a.vin,h)}n.current.get(a.vin).setTooltipContent(`${a.vin}<br/>${(a.current.speed_mps*3.6).toFixed(0)} km/h Â· ${a.current.driving_mode}`)}),n.current.forEach((a,i)=>{r.has(i)||(a.remove(),n.current.delete(i))})},[e,s]),m.useEffect(()=>()=>{n.current.forEach(r=>r.remove()),n.current.clear()},[]),null}function zu(){var C,w,F,j,S,I,T,k,x,E,$,se,ce,de,it,ms,ps,Es;const{id:e}=cs(),s=zt(),n=qe(),{data:r,isLoading:a}=B({queryKey:["simulation",e],queryFn:()=>jd(e),enabled:!!e,refetchInterval:W=>{const ne=W.state.data;return(ne==null?void 0:ne.status)==="Running"?5e3:!1}}),{data:i}=B({queryKey:["simulation-stats",e],queryFn:()=>wd(e),enabled:!!e&&(r==null?void 0:r.status)==="Running",refetchInterval:3e3}),l=(r==null?void 0:r.status)==="Running",o=(r==null?void 0:r.status)==="Completed",{data:d}=B({queryKey:["simulation-vehicles",e],queryFn:()=>Id(e,50),enabled:!!e&&(l||o),refetchInterval:l?3e3:!1}),u=()=>{n.invalidateQueries({queryKey:["simulation",e]}),n.invalidateQueries({queryKey:["simulation-stats",e]}),n.invalidateQueries({queryKey:["simulation-vehicles",e]}),n.invalidateQueries({queryKey:["simulations"]})},c=fe({mutationFn:()=>Nn(e),onSuccess:()=>{u(),X.success("Started")}}),h=fe({mutationFn:()=>kd(e),onSuccess:()=>{u(),X.success("Paused")}}),y=fe({mutationFn:()=>_d(e),onSuccess:()=>{u(),X.success("Resumed")}}),f=fe({mutationFn:()=>Cd(e),onSuccess:()=>{u(),X.success("Stopped")}});if(a||!r)return t.jsx(z,{className:"glass-panel",loading:!0});const g=i??r.stats,v=((C=r.route_config)==null?void 0:C.routes)??[],b=(F=(w=r.route_config)==null?void 0:w.random_config)==null?void 0:F.start_point,_=d??[],R=(()=>{const W=_.find(ne=>ne.current);return W!=null&&W.current?[W.current.lat,W.current.lng]:v.length>0&&v[0].waypoints.length>0?[v[0].waypoints[0].lat,v[0].waypoints[0].lng]:b?[b.lat,b.lng]:[31.23,121.47]})();return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[t.jsx(q,{type:"text",icon:t.jsx(Zo,{size:18}),onClick:()=>s("/simulation")}),t.jsxs("div",{style:{flex:1},children:[t.jsx("h1",{className:"page-title",style:{marginBottom:0},children:r.name}),t.jsxs(H,{children:[t.jsx(K,{color:Au[r.status],children:r.status}),r.started_at&&t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["Started: ",new Date(r.started_at).toLocaleString()]})]})]}),t.jsxs(H,{children:[(r.status==="Draft"||r.status==="Paused")&&t.jsx(q,{type:"primary",icon:t.jsx(rn,{size:14}),onClick:()=>r.status==="Draft"?c.mutate():y.mutate(),loading:c.isPending||y.isPending,children:r.status==="Draft"?"Start":"Resume"}),r.status==="Running"&&t.jsxs(t.Fragment,{children:[t.jsx(q,{icon:t.jsx(dc,{size:14}),onClick:()=>h.mutate(),loading:h.isPending,children:"Pause"}),t.jsx(q,{danger:!0,icon:t.jsx(mc,{size:14}),onClick:()=>f.mutate(),loading:f.isPending,children:"Stop"})]})]})]}),t.jsxs(ae,{gutter:[16,16],style:{marginBottom:24},children:[t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel glow-accent-hover",children:t.jsx(Nt,{title:"Vehicles",value:((j=r.fleet_config)==null?void 0:j.vehicle_count)??((I=(S=r.fleet_config)==null?void 0:S.vehicles)==null?void 0:I.length)??0,valueStyle:{fontFamily:"var(--font-mono)",color:"#00FF41"}})})}),t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel glow-accent-hover",children:t.jsx(Nt,{title:"Telemetry Sent",value:(g==null?void 0:g.telemetry_sent)??0,valueStyle:{fontFamily:"var(--font-mono)",color:"#00cc33"}})})}),t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel glow-accent-hover",children:t.jsx(Nt,{title:"Issues Reported",value:(g==null?void 0:g.issues_sent)??0,valueStyle:{fontFamily:"var(--font-mono)",color:"#FFB000"}})})}),t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel glow-accent-hover",children:t.jsx(Nt,{title:"Total Mileage",value:Number((g==null?void 0:g.total_mileage_km)??0).toFixed(1),suffix:"km",valueStyle:{fontFamily:"var(--font-mono)",color:"#33ff66"}})})})]}),t.jsxs(ae,{gutter:[16,16],children:[t.jsx(O,{xs:24,lg:14,children:t.jsx(z,{className:"glass-panel",title:l?"Live Vehicle Map":"Route Map",style:{height:520},children:t.jsx("div",{style:{height:440},children:t.jsxs(qn,{center:R,zoom:11,style:{height:"100%",width:"100%",borderRadius:8},children:[t.jsx(Kn,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"Â© CartoDB"}),v.map((W,ne)=>{var G;const we=$s[ne%$s.length],P=(G=W.road)==null?void 0:G.coordinates,re=P??W.waypoints;return t.jsx(vs,{positions:re.map(ze=>[ze.lat,ze.lng]),pathOptions:{color:we,weight:_.length>0?2:4,opacity:_.length>0?.25:.8,dashArray:P?void 0:"8 4"}},`route-${W.route_id}`)}),_.map((W,ne)=>{const we=Dt[ne%Dt.length];return W.trail.length<2?null:t.jsx(vs,{positions:W.trail.map(P=>[P.lat,P.lng]),pathOptions:{color:we,weight:4,opacity:.9}},`trail-${W.vin}`)}),_.length===0&&v.map((W,ne)=>{var re;const we=$s[ne%$s.length],P=((re=W.road)==null?void 0:re.coordinates)??W.waypoints;return t.jsx("span",{children:P.length>0&&t.jsx(jn,{center:[P[0].lat,P[0].lng],radius:6,pathOptions:{color:"#fff",fillColor:we,fillOpacity:1,weight:2},children:t.jsxs(Ws,{children:[W.name||W.route_id," (Start)"]})})},`markers-${W.route_id}`)}),t.jsx(Ou,{vehicles:_})]})})})}),t.jsxs(O,{xs:24,lg:10,children:[t.jsx(z,{className:"glass-panel",title:"Configuration",style:{marginBottom:16},children:t.jsxs(A,{column:1,size:"small",labelStyle:{color:"var(--text-muted)"},children:[t.jsx(A.Item,{label:"Fleet Mode",children:(T=r.fleet_config)==null?void 0:T.mode}),t.jsx(A.Item,{label:"Route Mode",children:(k=r.route_config)==null?void 0:k.mode}),t.jsxs(A.Item,{label:"Routes",children:[v.length," route(s)",v.some(W=>W.road)?" (road-planned)":""]}),v.some(W=>W.road)&&t.jsxs(A.Item,{label:"Road Distance",children:[(v.reduce((W,ne)=>{var we;return W+(((we=ne.road)==null?void 0:we.total_distance_m)??0)},0)/1e3).toFixed(1)," km total"]}),t.jsxs(A.Item,{label:"Telemetry Interval",children:[(((x=r.report_config)==null?void 0:x.telemetry_interval_ms)??3e3)/1e3,"s"]}),t.jsxs(A.Item,{label:"Issue Interval",children:[((($=(E=r.report_config)==null?void 0:E.issue_interval_range_ms)==null?void 0:$[0])??3e4)/1e3,"s - ",(((ce=(se=r.report_config)==null?void 0:se.issue_interval_range_ms)==null?void 0:ce[1])??12e4)/1e3,"s"]}),t.jsxs(A.Item,{label:"Mode Switch",children:[(((de=r.report_config)==null?void 0:de.status_change_interval_ms)??6e4)/1e3,"s"]}),t.jsxs(A.Item,{label:"Speed Range",children:[Math.round((((ms=(it=r.report_config)==null?void 0:it.speed_range_mps)==null?void 0:ms[0])??8)*3.6)," - ",Math.round((((Es=(ps=r.report_config)==null?void 0:ps.speed_range_mps)==null?void 0:Es[1])??33)*3.6)," km/h"]})]})}),_.length>0&&t.jsx(z,{className:"glass-panel",title:"Vehicle Status",children:t.jsx(Se,{size:"small",dataSource:_,rowKey:"vin",pagination:!1,columns:[{title:"",width:12,render:(W,ne,we)=>t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:Dt[we%Dt.length]}})},{title:"VIN",dataIndex:"vin",ellipsis:!0,render:W=>t.jsx("span",{style:{fontSize:11,fontFamily:"monospace"},children:W})},{title:"Speed",render:(W,ne)=>ne.current?`${(ne.current.speed_mps*3.6).toFixed(0)} km/h`:"-"},{title:"Mode",render:(W,ne)=>ne.current?t.jsx(K,{color:"blue",style:{fontSize:10},children:ne.current.driving_mode}):"-"},{title:"Trail",render:(W,ne)=>t.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:[ne.trail.length," pts"]})}]})})]})]})]})}const Lu="https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",Nu='&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>';function ln({center:e=[31.23,121.47],zoom:s=11,style:n={width:"100%",height:"100%",minHeight:400},children:r}){return t.jsxs(qn,{center:e,zoom:s,style:n,scrollWheelZoom:!0,children:[t.jsx(Kn,{url:Lu,attribution:Nu}),r]})}const Et={Manual:"#8c8c8c",ACC:"#1890ff",LCC:"#52c41a",HighwayPilot:"#fa8c16",UrbanPilot:"#722ed1",Standby:"#595959",Autonomous:"#13c2c2"},Ya={Blocker:"#f5222d",High:"#fa8c16",Medium:"#fadb14",Low:"#8c8c8c"};function Xa(e){return Et[e]??"#8c8c8c"}function Du(e){return Ya[e]??"#8c8c8c"}function $u(e){const s=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="${e}" stroke="#fff" stroke-width="2" opacity="0.9"/><circle cx="12" cy="12" r="4" fill="#fff"/></svg>`;return ts.divIcon({html:s,className:"",iconSize:[24,24],iconAnchor:[12,12]})}function Za({vin:e,lat:s,lng:n,drivingMode:r,speed:a,onClick:i}){const l=Xa(r??"Manual");return t.jsx(Bn,{position:[s,n],icon:$u(l),eventHandlers:{click:i},children:t.jsx(Un,{children:t.jsxs("div",{style:{fontSize:12,lineHeight:1.6,color:"#fff",minWidth:120},children:[t.jsx("strong",{children:e}),t.jsx("br",{}),"Mode: ",r??"â€”",t.jsx("br",{}),"Speed: ",a!=null?`${a.toFixed(1)} m/s`:"â€”"]})})})}const qu="",Ku=`${qu}/api/sse/vehicles`,Bu={Offline:"#595959",Idle:"#1890ff",Active:"#52c41a",Maintenance:"#fa8c16"};function Uu(){const e=zt(),[s,n]=m.useState(),[r,a]=m.useState(),[i,l]=m.useState(),[o,d]=m.useState(),{data:u,isLoading:c}=B({queryKey:["vehicles"],queryFn:()=>nr(),refetchInterval:15e3}),{data:h}=B({queryKey:["fleet-distribution"],queryFn:Uc}),{data:y}=B({queryKey:["fleet-status-distribution"],queryFn:Vc}),[f,g]=m.useState({}),v=m.useRef(null);m.useEffect(()=>{const j=new EventSource(Ku);return v.current=j,j.onmessage=S=>{try{const I=JSON.parse(S.data),T=I.vin;if(!T)return;g(k=>({...k,[T]:{currentLocation:I.current_location,currentSpeed:I.current_speed_mps,drivingMode:I.driving_mode,status:I.current_status}}))}catch{}},()=>{j.close()}},[]);const b=(u??[]).map(j=>{const S=f[j.vin];return S?{...j,...S}:j}),_=b.filter(j=>!(s&&j.plateType!==s||r&&j.modelCode!==r||i&&j.status!==i||o&&j.drivingMode!==o)),R=_.filter(j=>{var S,I;return((S=j.currentLocation)==null?void 0:S.lat)&&((I=j.currentLocation)==null?void 0:I.lng)}),C=[{title:"VIN",dataIndex:"vin",key:"vin",width:180,render:j=>t.jsx("a",{onClick:()=>e(`/fleet/vehicles/${j}`),children:j})},{title:"Plate",dataIndex:"plateType",key:"plateType",width:100,render:j=>j?t.jsx(K,{children:j==="permanent"?"Perm":"Temp"}):"â€”"},{title:"Model",dataIndex:"modelCode",key:"modelCode",width:100,render:j=>j??"â€”"},{title:"Status",dataIndex:"status",key:"status",width:100,render:j=>t.jsx(K,{color:Bu[j]??"#595959",children:j})},{title:"Mode",dataIndex:"drivingMode",key:"drivingMode",width:120,render:j=>j?t.jsx(K,{color:Et[j],children:j}):"â€”"},{title:"Speed",dataIndex:"currentSpeed",key:"speed",width:100,render:j=>j!=null?`${j.toFixed(1)} m/s`:"â€”"},{title:"Platform",dataIndex:"platform",key:"platform",width:120,render:j=>j??"â€”"}],w=["#1890ff","#52c41a","#fa8c16","#722ed1","#f5222d","#13c2c2","#fadb14","#595959"],F=j=>{const S=Math.floor(j/36e5),I=Math.floor(j%36e5/6e4);return S>0?`${S}h ${I}m`:`${I}m`};return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(at,{title:"Fleet Dashboard",subtitle:`${b.length} vehicles`}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(z,{title:"Vehicles",size:"small",className:"glass-card",style:{height:520},extra:t.jsxs(H,{size:"small",children:[t.jsx(Z,{allowClear:!0,placeholder:"Plate",style:{width:100},value:s,onChange:n,options:[{value:"permanent",label:"Perm"},{value:"temporary",label:"Temp"}]}),t.jsx(Z,{allowClear:!0,placeholder:"Model",style:{width:100},value:r,onChange:a,options:((h==null?void 0:h.model_code)??[]).map(j=>({value:j.name,label:j.name}))}),t.jsx(Z,{allowClear:!0,placeholder:"Status",style:{width:100},value:i,onChange:l,options:["Offline","Idle","Active","Maintenance"].map(j=>({value:j,label:j}))}),t.jsx(Z,{allowClear:!0,placeholder:"Mode",style:{width:110},value:o,onChange:d,options:Object.keys(Et).map(j=>({value:j,label:j}))})]}),children:t.jsx(Se,{dataSource:_,columns:C,rowKey:"vin",size:"small",loading:c,scroll:{y:380},pagination:!1,onRow:j=>({onClick:()=>e(`/fleet/vehicles/${j.vin}`),style:{cursor:"pointer"}})})})}),t.jsx(O,{span:12,children:t.jsx(z,{title:"Live Map",size:"small",className:"glass-card",style:{height:520},children:t.jsx("div",{style:{height:460},children:t.jsx(ln,{children:R.map(j=>t.jsx(Za,{vin:j.vin,lat:j.currentLocation.lat,lng:j.currentLocation.lng,drivingMode:j.drivingMode,speed:j.currentSpeed,onClick:()=>e(`/fleet/vehicles/${j.vin}`)},j.vin))})})})})]}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(z,{title:"Plate Type",size:"small",className:"glass-card",children:t.jsx(Tt,{width:"100%",height:200,children:t.jsxs(en,{children:[t.jsx(tn,{data:(h==null?void 0:h.plate_type)??[],dataKey:"count",nameKey:"name",cx:"50%",cy:"50%",outerRadius:70,label:({name:j,count:S})=>`${j}: ${S}`,children:((h==null?void 0:h.plate_type)??[]).map((j,S)=>t.jsx(es,{fill:w[S%w.length]},S))}),t.jsx(Ae,{})]})})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Model Distribution",size:"small",className:"glass-card",children:t.jsx(Tt,{width:"100%",height:200,children:t.jsxs(Vs,{data:(h==null?void 0:h.model_code)??[],children:[t.jsx(vt,{dataKey:"name",tick:{fill:"#aaa",fontSize:11}}),t.jsx(Ve,{tick:{fill:"#aaa",fontSize:11}}),t.jsx(Ae,{}),t.jsx(Zt,{dataKey:"count",fill:"#1890ff",radius:[4,4,0,0]})]})})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Status Duration Distribution",size:"small",className:"glass-card",children:t.jsx(Tt,{width:"100%",height:200,children:t.jsxs(Vs,{data:y??[],layout:"vertical",children:[t.jsx(vt,{type:"number",tick:{fill:"#aaa",fontSize:11},tickFormatter:j=>F(j)}),t.jsx(Ve,{dataKey:"driving_mode",type:"category",tick:{fill:"#aaa",fontSize:11},width:90}),t.jsx(Ae,{formatter:j=>F(j)}),t.jsx(Zt,{dataKey:"total_duration_ms",fill:"#52c41a",radius:[0,4,4,0]})]})})})})]})]})}function Vu(e){const s=e[0];if(!s)return[];const n=[];let r=s.driving_mode,a=[[s.location.lat,s.location.lng]],i=s.speed_mps,l=s.timestamp;for(let d=1;d<e.length;d++){const u=e[d],c=e[d-1];u.driving_mode!==r&&(n.push({mode:r,positions:[...a],startTime:l,endTime:c.timestamp,avgSpeed:i/a.length}),r=u.driving_mode,a=[[c.location.lat,c.location.lng]],i=0,l=u.timestamp),a.push([u.location.lat,u.location.lng]),i+=u.speed_mps}const o=e[e.length-1];return n.push({mode:r,positions:a,startTime:l,endTime:o.timestamp,avgSpeed:i/a.length}),n}function ei({points:e}){const s=Vu(e);return t.jsx(t.Fragment,{children:s.map((n,r)=>t.jsx(vs,{positions:n.positions,pathOptions:{color:Xa(n.mode),weight:3,opacity:.85},children:t.jsx(Ws,{sticky:!0,children:t.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:[t.jsx("strong",{children:n.mode}),t.jsx("br",{}),"Avg speed: ",n.avgSpeed.toFixed(1)," m/s",t.jsx("br",{}),n.startTime&&new Date(n.startTime).toLocaleTimeString()," â†’ ",n.endTime&&new Date(n.endTime).toLocaleTimeString()]})})},r))})}const Wu={Offline:"#595959",Idle:"#1890ff",Active:"#52c41a",Maintenance:"#fa8c16"};function Hu(){const{vin:e}=cs(),s=zt(),{data:n,isLoading:r}=B({queryKey:["vehicle",e],queryFn:()=>qc(e),enabled:!!e}),{data:a}=B({queryKey:["vehicle-status-dist",e],queryFn:()=>Kc(e),enabled:!!e}),{data:i}=B({queryKey:["vehicle-trajectory",e],queryFn:()=>Bc(e,{limit:"2000"}),enabled:!!e}),{data:l}=B({queryKey:["vehicle-runs",e],queryFn:()=>Ps({vehicleVin:e}),enabled:!!e});if(r)return t.jsx("div",{style:{textAlign:"center",padding:80},children:t.jsx(Ot,{size:"large"})});if(!n)return t.jsx(le,{description:"Vehicle not found"});const o=c=>{const h=Math.floor(c/36e5),y=Math.floor(c%36e5/6e4);return h>0?`${h}h ${y}m`:`${y}m`},d=(a??[]).map(c=>({name:c.driving_mode,value:c.total_duration_ms,mileage:c.total_mileage_km})),u=(l??[]).filter(c=>c.status==="Active"||c.status==="Scheduled");return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(at,{title:n.vin,subtitle:n.modelCode??n.platform??""}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(z,{title:"Vehicle Info",size:"small",className:"glass-card",children:t.jsxs(A,{column:2,size:"small",labelStyle:{color:"rgba(255,255,255,0.5)"},contentStyle:{color:"#e0e0e0"},children:[t.jsx(A.Item,{label:"VIN",children:n.vin}),t.jsx(A.Item,{label:"Plate Type",children:n.plateType==="permanent"?"Perm":n.plateType==="temporary"?"Temp":"â€”"}),t.jsx(A.Item,{label:"Model Code",children:n.modelCode??"â€”"}),t.jsx(A.Item,{label:"Platform",children:n.platform??"â€”"}),t.jsx(A.Item,{label:"SoC Arch",children:n.socArchitecture??"â€”"}),t.jsx(A.Item,{label:"Sensor Suite",children:n.sensorSuiteVersion??"â€”"}),n.componentVersions&&Object.entries(n.componentVersions).map(([c,h])=>t.jsx(A.Item,{label:c,children:h},c))]})})}),t.jsx(O,{span:12,children:t.jsx(z,{title:"Real-time Status",size:"small",className:"glass-card",children:t.jsxs(A,{column:2,size:"small",labelStyle:{color:"rgba(255,255,255,0.5)"},contentStyle:{color:"#e0e0e0"},children:[t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Wu[n.status],children:n.status})}),t.jsx(A.Item,{label:"Mode",children:n.drivingMode?t.jsx(K,{color:Et[n.drivingMode],children:n.drivingMode}):"â€”"}),t.jsx(A.Item,{label:"Speed",children:n.currentSpeed!=null?`${n.currentSpeed.toFixed(1)} m/s`:"â€”"}),t.jsx(A.Item,{label:"Battery",children:n.fuelOrBatteryLevel!=null?`${n.fuelOrBatteryLevel}%`:"â€”"}),t.jsx(A.Item,{label:"Location",span:2,children:n.currentLocation?`${n.currentLocation.lat.toFixed(5)}, ${n.currentLocation.lng.toFixed(5)}`:"â€”"}),t.jsx(A.Item,{label:"Last Heartbeat",children:n.lastHeartbeat?new Date(n.lastHeartbeat).toLocaleString():"â€”"})]})})})]}),t.jsxs(ae,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(z,{title:"Active Tasks",size:"small",className:"glass-card",style:{height:320},children:u.length===0?t.jsx(le,{description:"No active tasks",image:le.PRESENTED_IMAGE_SIMPLE}):t.jsx(Se,{dataSource:u,columns:[{title:"Run",dataIndex:"id",key:"id",render:c=>t.jsxs("a",{onClick:()=>s(`/runs/${c}`),children:[c.slice(0,12),"â€¦"]})},{title:"Task",dataIndex:"taskId",key:"task",render:c=>t.jsxs("a",{onClick:()=>s(`/tasks/${c}`),children:[c.slice(0,12),"â€¦"]})},{title:"Status",dataIndex:"status",key:"status",render:c=>t.jsx(K,{color:c==="Active"?"#52c41a":"#1890ff",children:c})}],rowKey:"id",size:"small",pagination:!1,scroll:{y:220}})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Driving Mode Distribution",size:"small",className:"glass-card",style:{height:320},children:t.jsx(Tt,{width:"100%",height:260,children:t.jsxs(en,{children:[t.jsx(tn,{data:d,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,label:({name:c})=>c,children:d.map((c,h)=>t.jsx(es,{fill:Et[c.name]??"#595959"},h))}),t.jsx(Ae,{formatter:c=>o(c)}),t.jsx(rt,{})]})})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Mode Mileage (km)",size:"small",className:"glass-card",style:{height:320},children:t.jsx(Se,{dataSource:a??[],columns:[{title:"Mode",dataIndex:"driving_mode",key:"mode",render:c=>t.jsx(K,{color:Et[c],children:c})},{title:"Duration",dataIndex:"total_duration_ms",key:"dur",render:c=>o(c)},{title:"Mileage",dataIndex:"total_mileage_km",key:"km",render:c=>`${c.toFixed(2)} km`}],rowKey:"driving_mode",size:"small",pagination:!1,scroll:{y:220}})})})]}),t.jsx(z,{title:"Recent Trajectory",size:"small",className:"glass-card",children:t.jsx("div",{style:{height:400},children:t.jsxs(ln,{center:n.currentLocation?[n.currentLocation.lat,n.currentLocation.lng]:void 0,zoom:13,children:[(i==null?void 0:i.data)&&t.jsx(ei,{points:i.data}),n.currentLocation&&t.jsx(Za,{vin:n.vin,lat:n.currentLocation.lat,lng:n.currentLocation.lng,drivingMode:n.drivingMode,speed:n.currentSpeed})]})})})]})}const{RangePicker:Qu}=xs;function Gu(){const[e,s]=m.useState(),[n,r]=m.useState(),[a,i]=m.useState(),[l,o]=m.useState(),[d,u]=m.useState(null),[c,h]=m.useState(),{data:y}=B({queryKey:["projects"],queryFn:()=>us()}),{data:f}=B({queryKey:["tasks",e],queryFn:()=>Fs(e?{projectId:e}:void 0)}),{data:g}=B({queryKey:["runs",n],queryFn:()=>Ps(n?{taskId:n}:void 0)}),{data:v}=B({queryKey:["vehicles-list"],queryFn:()=>nr()}),{data:b,isLoading:_}=B({queryKey:["trajectory",c],queryFn:()=>Wc(c),enabled:!!c}),R=()=>{const j={};l&&(j.vin=l),a?j.run_id=a:n?j.task_id=n:e&&(j.project_id=e),d&&(j.start_time=d[0].toISOString(),j.end_time=d[1].toISOString()),h(j)},C=(b==null?void 0:b.data)??[],w=C.length>0?C[Math.floor(C.length/2)]:void 0,F=w?[w.location.lat,w.location.lng]:void 0;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(at,{title:"Trajectory Query",subtitle:"Vehicle trajectory by project/task/run/vin"}),t.jsx(z,{size:"small",className:"glass-card",children:t.jsxs(H,{wrap:!0,size:"middle",children:[t.jsx(Z,{allowClear:!0,placeholder:"Project",style:{width:180},value:e,onChange:j=>{s(j),r(void 0),i(void 0)},options:(y??[]).map(j=>({value:j.id,label:j.name})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Z,{allowClear:!0,placeholder:"Task",style:{width:180},value:n,onChange:j=>{r(j),i(void 0)},options:(f??[]).map(j=>({value:j.id,label:j.title})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Z,{allowClear:!0,placeholder:"Run",style:{width:180},value:a,onChange:i,options:(g??[]).map(j=>({value:j.id,label:j.id.slice(0,16)})),showSearch:!0}),t.jsx(Z,{allowClear:!0,placeholder:"Vehicle",style:{width:180},value:l,onChange:o,options:(v??[]).map(j=>({value:j.vin,label:j.vin})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Qu,{showTime:!0,value:d,onChange:j=>u(j)}),t.jsx(q,{type:"primary",onClick:R,loading:_,children:"Search"})]})}),t.jsx(z,{size:"small",className:"glass-card",bodyStyle:{padding:0,height:"calc(100vh - 280px)",minHeight:500},children:c?_?t.jsx("div",{style:{textAlign:"center",paddingTop:100},children:t.jsx(Ot,{size:"large"})}):C.length===0?t.jsx(le,{description:"No trajectory points found",style:{paddingTop:100}}):t.jsx(ln,{center:F,zoom:13,style:{width:"100%",height:"100%"},children:t.jsx(ei,{points:C})}):t.jsx(le,{description:"Set filters and click Search",style:{paddingTop:100}})}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[Object.entries(Et).map(([j,S])=>t.jsx(K,{color:S,children:j},j)),b&&t.jsxs(K,{children:["Total: ",b.total," points"]})]})]})}function Ju(e){const s=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="28" viewBox="0 0 20 28"><path d="M10 0C4.5 0 0 4.5 0 10c0 7.5 10 18 10 18s10-10.5 10-18C20 4.5 15.5 0 10 0z" fill="${e}" stroke="#fff" stroke-width="1.5"/><circle cx="10" cy="10" r="4" fill="#fff"/></svg>`;return ts.divIcon({html:s,className:"",iconSize:[20,28],iconAnchor:[10,28],popupAnchor:[0,-28]})}function Yu({issue:e}){var n,r;if(!((n=e.location)!=null&&n.lat)||!((r=e.location)!=null&&r.lng))return null;const s=Du(e.severity);return t.jsx(Bn,{position:[e.location.lat,e.location.lng],icon:Ju(s),children:t.jsx(Un,{children:t.jsxs("div",{style:{fontSize:12,lineHeight:1.6,color:"#fff",minWidth:160},children:[t.jsx("strong",{children:e.issue_id}),t.jsx("br",{}),"Category: ",e.category??"â€”",t.jsx("br",{}),"Severity: ",t.jsx("span",{style:{color:s},children:e.severity}),t.jsx("br",{}),e.description&&t.jsxs("span",{children:[e.description.slice(0,80),e.description.length>80?"â€¦":"",t.jsx("br",{})]}),e.triggered_at&&t.jsxs(t.Fragment,{children:["Time: ",new Date(e.triggered_at).toLocaleString(),t.jsx("br",{})]}),t.jsx("a",{href:`/issues/${e.issue_id}`,style:{color:"#1890ff"},children:"View Detail â†’"})]})})})}const{RangePicker:Xu}=xs;function Zu(){const[e,s]=m.useState(),[n,r]=m.useState(),[a,i]=m.useState(),[l,o]=m.useState(),[d,u]=m.useState(null),[c,h]=m.useState(),{data:y}=B({queryKey:["projects"],queryFn:()=>us()}),{data:f}=B({queryKey:["tasks",e],queryFn:()=>Fs(e?{projectId:e}:void 0)}),{data:g}=B({queryKey:["runs",n],queryFn:()=>Ps(n?{taskId:n}:void 0)}),{data:v}=B({queryKey:["vehicles-list-im"],queryFn:()=>nr()}),{data:b,isLoading:_}=B({queryKey:["issue-locations",c],queryFn:()=>Hc(c),enabled:!!c}),R=()=>{const S={};l&&(S.vin=l),a?S.run_id=a:n?S.task_id=n:e&&(S.project_id=e),d&&(S.start_time=d[0].toISOString(),S.end_time=d[1].toISOString()),h(S)},w=((b==null?void 0:b.data)??[]).filter(S=>{var I,T;return((I=S.location)==null?void 0:I.lat)&&((T=S.location)==null?void 0:T.lng)}),F=w[0],j=F!=null&&F.location?[F.location.lat,F.location.lng]:void 0;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(at,{title:"Issue Map",subtitle:"Issue locations on map"}),t.jsx(z,{size:"small",className:"glass-card",children:t.jsxs(H,{wrap:!0,size:"middle",children:[t.jsx(Z,{allowClear:!0,placeholder:"Project",style:{width:180},value:e,onChange:S=>{s(S),r(void 0),i(void 0)},options:(y??[]).map(S=>({value:S.id,label:S.name})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Z,{allowClear:!0,placeholder:"Task",style:{width:180},value:n,onChange:S=>{r(S),i(void 0)},options:(f??[]).map(S=>({value:S.id,label:S.title})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Z,{allowClear:!0,placeholder:"Run",style:{width:180},value:a,onChange:i,options:(g??[]).map(S=>({value:S.id,label:S.id.slice(0,16)})),showSearch:!0}),t.jsx(Z,{allowClear:!0,placeholder:"Vehicle",style:{width:180},value:l,onChange:o,options:(v??[]).map(S=>({value:S.vin,label:S.vin})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Xu,{showTime:!0,value:d,onChange:S=>u(S)}),t.jsx(q,{type:"primary",onClick:R,loading:_,children:"Search"})]})}),t.jsx(z,{size:"small",className:"glass-card",bodyStyle:{padding:0,height:"calc(100vh - 280px)",minHeight:500},children:c?_?t.jsx("div",{style:{textAlign:"center",paddingTop:100},children:t.jsx(Ot,{size:"large"})}):w.length===0?t.jsx(le,{description:"No issues with location found",style:{paddingTop:100}}):t.jsx(ln,{center:j,zoom:12,style:{width:"100%",height:"100%"},children:w.map(S=>t.jsx(Yu,{issue:S},S.issue_id))}):t.jsx(le,{description:"Set filters and click Search",style:{paddingTop:100}})}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[Object.entries(Ya).map(([S,I])=>t.jsx(K,{color:I,children:S},S)),b&&t.jsxs(K,{children:["Total: ",b.total," issues, ",w.length," with GPS"]})]})]})}function eh(){return t.jsx(Ml,{children:t.jsxs(ue,{element:t.jsx(Ic,{}),children:[t.jsx(ue,{index:!0,element:t.jsx(Pl,{to:"/projects",replace:!0})}),t.jsx(ue,{path:"projects",element:t.jsx(Ed,{})}),t.jsx(ue,{path:"projects/:id",element:t.jsx(zd,{})}),t.jsx(ue,{path:"tasks",element:t.jsx(Ld,{})}),t.jsx(ue,{path:"tasks/:id",element:t.jsx(Dd,{})}),t.jsx(ue,{path:"runs",element:t.jsx($d,{})}),t.jsx(ue,{path:"runs/:id",element:t.jsx(qd,{})}),t.jsx(ue,{path:"issues",element:t.jsx(Kd,{})}),t.jsx(ue,{path:"issues/:id",element:t.jsx(Vd,{})}),t.jsx(ue,{path:"kpi",element:t.jsx(_u,{})}),t.jsx(ue,{path:"traceability",element:t.jsx(wu,{})}),t.jsx(ue,{path:"auto-triage",element:t.jsx(Iu,{})}),t.jsx(ue,{path:"simulation",element:t.jsx(Mu,{})}),t.jsx(ue,{path:"simulation/:id",element:t.jsx(zu,{})}),t.jsx(ue,{path:"fleet",element:t.jsx(Uu,{})}),t.jsx(ue,{path:"fleet/vehicles/:vin",element:t.jsx(Hu,{})}),t.jsx(ue,{path:"fleet/trajectory",element:t.jsx(Gu,{})}),t.jsx(ue,{path:"fleet/issues-map",element:t.jsx(Zu,{})})]})})}const th=new Lo({defaultOptions:{queries:{staleTime:3e4,retry:1,refetchOnWindowFocus:!1}}}),sh={algorithm:xi.darkAlgorithm,token:{colorPrimary:"#00FF41",colorInfo:"#00FF41",colorSuccess:"#00FF41",colorWarning:"#FFB000",colorError:"#FF0033",colorBgContainer:"rgba(0, 255, 65, 0.02)",colorBgElevated:"rgba(0, 255, 65, 0.04)",colorBgLayout:"transparent",colorBorder:"rgba(0, 255, 65, 0.08)",colorBorderSecondary:"rgba(0, 255, 65, 0.04)",colorText:"#b8d4b8",colorTextSecondary:"#6b9b6b",colorTextTertiary:"#3d6b3d",colorTextQuaternary:"#2a4a2a",borderRadius:2,borderRadiusLG:2,borderRadiusSM:1,fontFamily:"'IBM Plex Sans', 'Segoe UI', sans-serif",fontSize:12,controlHeight:30,wireframe:!1},components:{Layout:{headerBg:"transparent",siderBg:"transparent",bodyBg:"transparent",triggerBg:"rgba(0, 255, 65, 0.04)"},Menu:{darkItemBg:"transparent",darkSubMenuItemBg:"transparent",darkItemSelectedBg:"rgba(0, 255, 65, 0.08)",darkItemHoverBg:"rgba(0, 255, 65, 0.04)",darkItemColor:"#6b9b6b",darkItemSelectedColor:"#00FF41",itemBorderRadius:2,itemMarginInline:6,iconSize:14},Table:{headerBg:"rgba(0, 255, 65, 0.02)",headerColor:"#00FF41",rowHoverBg:"rgba(0, 255, 65, 0.03)",borderColor:"rgba(0, 255, 65, 0.04)",cellPaddingBlock:8,cellPaddingInline:10},Card:{colorBgContainer:"rgba(0, 255, 65, 0.02)",colorBorderSecondary:"rgba(0, 255, 65, 0.08)"},Button:{primaryShadow:"0 0 8px rgba(0, 255, 65, 0.3)",defaultBg:"rgba(0, 255, 65, 0.03)",defaultBorderColor:"rgba(0, 255, 65, 0.12)",borderRadius:2,borderRadiusLG:2},Input:{colorBgContainer:"rgba(0, 255, 65, 0.02)",activeBorderColor:"#00FF41",hoverBorderColor:"rgba(0, 255, 65, 0.3)"},Select:{colorBgContainer:"rgba(0, 255, 65, 0.02)",optionSelectedBg:"rgba(0, 255, 65, 0.08)"},Tag:{borderRadiusSM:1},Descriptions:{colorSplit:"rgba(0, 255, 65, 0.04)",titleColor:"#00FF41",contentColor:"#6b9b6b"},Timeline:{dotBorderWidth:1,tailColor:"rgba(0, 255, 65, 0.08)"},Breadcrumb:{separatorColor:"#2a4a2a",linkColor:"#6b9b6b",linkHoverColor:"#00FF41",lastItemColor:"#b8d4b8"},Statistic:{titleFontSize:10,contentFontSize:24},Progress:{remainingColor:"rgba(0, 255, 65, 0.04)"},Tabs:{inkBarColor:"#00FF41",itemSelectedColor:"#00FF41",itemColor:"#6b9b6b",itemHoverColor:"#00FF41"},Collapse:{headerBg:"rgba(0, 255, 65, 0.02)",contentBg:"transparent"}}};yi.createRoot(document.getElementById("root")).render(t.jsx(m.StrictMode,{children:t.jsx(no,{children:t.jsx(No,{client:th,children:t.jsx(gi,{theme:sh,children:t.jsx(vi,{children:t.jsx(Ad,{children:t.jsx(eh,{})})})})})})}));
