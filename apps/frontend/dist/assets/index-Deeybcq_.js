const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CKCHFLk5.js","assets/recharts-C6aLXAQd.js","assets/antd-CXeJEC6B.js"])))=>i.map(i=>d[i]);
var ei=Object.defineProperty;var ia=e=>{throw TypeError(e)};var ti=(e,s,n)=>s in e?ei(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n;var la=(e,s,n)=>ti(e,typeof s!="symbol"?s+"":s,n),on=(e,s,n)=>s.has(e)||ia("Cannot "+n);var p=(e,s,n)=>(on(e,s,"read from private field"),n?n.call(e):s.get(e)),L=(e,s,n)=>s.has(e)?ia("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,n),M=(e,s,n,a)=>(on(e,s,"write to private field"),a?a.call(e,n):s.set(e,n),n),U=(e,s,n)=>(on(e,s,"access private method"),n);var Ms=(e,s,n,a)=>({set _(r){M(e,s,r,n)},get _(){return p(e,s,a)}});import{r as m,M as As,B as Ha,L as si,d as ni,F as N,e as q,f as $t,S as H,I as J,h as Zs,i as ee,j as Se,E as le,k as as,D as xs,T as we,l as K,s as Z,m as Ot,C as z,n as ai,o as re,p as O,q as A,A as jt,t as ri,u as qs,v as ii,w as li,x as oi,y as Qa,z as ci,G as Ga,H as Nt,J as di,K as cn,N as ui,O as Ja,U as hi,P as Ya,Q as Xa,V as Za,W as er,X as oa,Y as mi,Z as Lt,_ as dn,$ as pi,a0 as fi,a1 as yi,a2 as gi,a3 as xi}from"./antd-CXeJEC6B.js";import{R as Ft,L as tr,C as rs,X as vt,Y as Ve,T as Ae,a as at,b as Nn,B as Vs,c as Zt,d as es,e as vi,f as ji,P as bi,g as Si,h as ki,i as _i,j as en,k as tn,S as Ci,l as wi,A as sr,m as gn,n as Ii}from"./recharts-C6aLXAQd.js";import{M as Dn,T as $n,P as vs,a as qn,b as Kn,C as xn,c as Ws,u as Ri,L as ts,d as Pi}from"./maps-BWWKWsKg.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var un={exports:{}},fs={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ca;function Ti(){if(ca)return fs;ca=1;var e=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function n(a,r,i){var l=null;if(i!==void 0&&(l=""+i),r.key!==void 0&&(l=""+r.key),"key"in r){i={};for(var o in r)o!=="key"&&(i[o]=r[o])}else i=r;return r=i.ref,{$$typeof:e,type:a,key:l,ref:r!==void 0?r:null,props:i}}return fs.Fragment=s,fs.jsx=n,fs.jsxs=n,fs}var da;function Fi(){return da||(da=1,un.exports=Ti()),un.exports}var t=Fi();/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ua="popstate";function Ei(e={}){function s(a,r){let{pathname:i,search:l,hash:o}=a.location;return vn("",{pathname:i,search:l,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:js(r)}return Ai(s,n,null,e)}function ie(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function $e(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function Mi(){return Math.random().toString(36).substring(2,10)}function ha(e,s){return{usr:e.state,key:e.key,idx:s}}function vn(e,s,n=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof s=="string"?is(s):s,state:n,key:s&&s.key||a||Mi()}}function js({pathname:e="/",search:s="",hash:n=""}){return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function is(e){let s={};if(e){let n=e.indexOf("#");n>=0&&(s.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(s.search=e.substring(a),e=e.substring(0,a)),e&&(s.pathname=e)}return s}function Ai(e,s,n,a={}){let{window:r=document.defaultView,v5Compat:i=!1}=a,l=r.history,o="POP",d=null,u=c();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function c(){return(l.state||{idx:null}).idx}function h(){o="POP";let b=c(),_=b==null?null:b-u;u=b,d&&d({action:o,location:v.location,delta:_})}function y(b,_){o="PUSH";let R=vn(v.location,b,_);u=c()+1;let C=ha(R,u),w=v.createHref(R);try{l.pushState(C,"",w)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;r.location.assign(w)}i&&d&&d({action:o,location:v.location,delta:1})}function f(b,_){o="REPLACE";let R=vn(v.location,b,_);u=c();let C=ha(R,u),w=v.createHref(R);l.replaceState(C,"",w),i&&d&&d({action:o,location:v.location,delta:0})}function g(b){return Oi(b)}let v={get action(){return o},get location(){return e(r,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(ua,h),d=b,()=>{r.removeEventListener(ua,h),d=null}},createHref(b){return s(r,b)},createURL:g,encodeLocation(b){let _=g(b);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:y,replace:f,go(b){return l.go(b)}};return v}function Oi(e,s=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ie(n,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:js(e);return a=a.replace(/ $/,"%20"),!s&&a.startsWith("//")&&(a=n+a),new URL(a,n)}function nr(e,s,n="/"){return zi(e,s,n,!1)}function zi(e,s,n,a){let r=typeof s=="string"?is(s):s,i=nt(r.pathname||"/",n);if(i==null)return null;let l=ar(e);Li(l);let o=null;for(let d=0;o==null&&d<l.length;++d){let u=Qi(i);o=Wi(l[d],u,a)}return o}function ar(e,s=[],n=[],a="",r=!1){let i=(l,o,d=r,u)=>{let c={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(a)&&d)return;ie(c.relativePath.startsWith(a),`Absolute route path "${c.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(a.length)}let h=tt([a,c.relativePath]),y=n.concat(c);l.children&&l.children.length>0&&(ie(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),ar(l.children,s,y,h,d)),!(l.path==null&&!l.index)&&s.push({path:h,score:Ui(h,l.index),routesMeta:y})};return e.forEach((l,o)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))i(l,o);else for(let u of rr(l.path))i(l,o,!0,u)}),s}function rr(e){let s=e.split("/");if(s.length===0)return[];let[n,...a]=s,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(a.length===0)return r?[i,""]:[i];let l=rr(a.join("/")),o=[];return o.push(...l.map(d=>d===""?i:[i,d].join("/"))),r&&o.push(...l),o.map(d=>e.startsWith("/")&&d===""?"/":d)}function Li(e){e.sort((s,n)=>s.score!==n.score?n.score-s.score:Vi(s.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}var Ni=/^:[\w-]+$/,Di=3,$i=2,qi=1,Ki=10,Bi=-2,ma=e=>e==="*";function Ui(e,s){let n=e.split("/"),a=n.length;return n.some(ma)&&(a+=Bi),s&&(a+=$i),n.filter(r=>!ma(r)).reduce((r,i)=>r+(Ni.test(i)?Di:i===""?qi:Ki),a)}function Vi(e,s){return e.length===s.length&&e.slice(0,-1).every((a,r)=>a===s[r])?e[e.length-1]-s[s.length-1]:0}function Wi(e,s,n=!1){let{routesMeta:a}=e,r={},i="/",l=[];for(let o=0;o<a.length;++o){let d=a[o],u=o===a.length-1,c=i==="/"?s:s.slice(i.length)||"/",h=Hs({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},c),y=d.route;if(!h&&u&&n&&!a[a.length-1].route.index&&(h=Hs({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},c)),!h)return null;Object.assign(r,h.params),l.push({params:r,pathname:tt([i,h.pathname]),pathnameBase:Xi(tt([i,h.pathnameBase])),route:y}),h.pathnameBase!=="/"&&(i=tt([i,h.pathnameBase]))}return l}function Hs(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=Hi(e.path,e.caseSensitive,e.end),r=s.match(n);if(!r)return null;let i=r[0],l=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:a.reduce((u,{paramName:c,isOptional:h},y)=>{if(c==="*"){let g=o[y]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const f=o[y];return h&&!f?u[c]=void 0:u[c]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:l,pattern:e}}function Hi(e,s=!1,n=!0){$e(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,d)=>(a.push({paramName:o,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,s?void 0:"i"),a]}function Qi(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return $e(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),e}}function nt(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,a=e.charAt(n);return a&&a!=="/"?null:e.slice(n)||"/"}var Gi=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Ji(e,s="/"){let{pathname:n,search:a="",hash:r=""}=typeof e=="string"?is(e):e,i;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?i=pa(n.substring(1),"/"):i=pa(n,s)):i=s,{pathname:i,search:Zi(a),hash:el(r)}}function pa(e,s){let n=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function hn(e,s,n,a){return`Cannot include a '${e}' character in a manually specified \`to.${s}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Yi(e){return e.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function Bn(e){let s=Yi(e);return s.map((n,a)=>a===s.length-1?n.pathname:n.pathnameBase)}function Un(e,s,n,a=!1){let r;typeof e=="string"?r=is(e):(r={...e},ie(!r.pathname||!r.pathname.includes("?"),hn("?","pathname","search",r)),ie(!r.pathname||!r.pathname.includes("#"),hn("#","pathname","hash",r)),ie(!r.search||!r.search.includes("#"),hn("#","search","hash",r)));let i=e===""||r.pathname==="",l=i?"/":r.pathname,o;if(l==null)o=n;else{let h=s.length-1;if(!a&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),h-=1;r.pathname=y.join("/")}o=h>=0?s[h]:"/"}let d=Ji(r,o),u=l&&l!=="/"&&l.endsWith("/"),c=(i||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||c)&&(d.pathname+="/"),d}var tt=e=>e.join("/").replace(/\/\/+/g,"/"),Xi=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zi=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,el=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,tl=class{constructor(e,s,n,a=!1){this.status=e,this.statusText=s||"",this.internal=a,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function sl(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function nl(e){return e.map(s=>s.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var ir=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function lr(e,s){let n=e;if(typeof n!="string"||!Gi.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let a=n,r=!1;if(ir)try{let i=new URL(window.location.href),l=n.startsWith("//")?new URL(i.protocol+n):new URL(n),o=nt(l.pathname,s);l.origin===i.origin&&o!=null?n=o+l.search+l.hash:r=!0}catch{$e(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var or=["POST","PUT","PATCH","DELETE"];new Set(or);var al=["GET",...or];new Set(al);var ls=m.createContext(null);ls.displayName="DataRouter";var sn=m.createContext(null);sn.displayName="DataRouterState";var rl=m.createContext(!1),cr=m.createContext({isTransitioning:!1});cr.displayName="ViewTransition";var il=m.createContext(new Map);il.displayName="Fetchers";var ll=m.createContext(null);ll.displayName="Await";var Pe=m.createContext(null);Pe.displayName="Navigation";var Is=m.createContext(null);Is.displayName="Location";var Oe=m.createContext({outlet:null,matches:[],isDataRoute:!1});Oe.displayName="Route";var Vn=m.createContext(null);Vn.displayName="RouteError";var dr="REACT_ROUTER_ERROR",ol="REDIRECT",cl="ROUTE_ERROR_RESPONSE";function dl(e){if(e.startsWith(`${dr}:${ol}:{`))try{let s=JSON.parse(e.slice(28));if(typeof s=="object"&&s&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.location=="string"&&typeof s.reloadDocument=="boolean"&&typeof s.replace=="boolean")return s}catch{}}function ul(e){if(e.startsWith(`${dr}:${cl}:{`))try{let s=JSON.parse(e.slice(40));if(typeof s=="object"&&s&&typeof s.status=="number"&&typeof s.statusText=="string")return new tl(s.status,s.statusText,s.data)}catch{}}function hl(e,{relative:s}={}){ie(os(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:a}=m.useContext(Pe),{hash:r,pathname:i,search:l}=Rs(e,{relative:s}),o=i;return n!=="/"&&(o=i==="/"?n:tt([n,i])),a.createHref({pathname:o,search:l,hash:r})}function os(){return m.useContext(Is)!=null}function He(){return ie(os(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(Is).location}var ur="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function hr(e){m.useContext(Pe).static||m.useLayoutEffect(e)}function zt(){let{isDataRoute:e}=m.useContext(Oe);return e?Il():ml()}function ml(){ie(os(),"useNavigate() may be used only in the context of a <Router> component.");let e=m.useContext(ls),{basename:s,navigator:n}=m.useContext(Pe),{matches:a}=m.useContext(Oe),{pathname:r}=He(),i=JSON.stringify(Bn(a)),l=m.useRef(!1);return hr(()=>{l.current=!0}),m.useCallback((d,u={})=>{if($e(l.current,ur),!l.current)return;if(typeof d=="number"){n.go(d);return}let c=Un(d,JSON.parse(i),r,u.relative==="path");e==null&&s!=="/"&&(c.pathname=c.pathname==="/"?s:tt([s,c.pathname])),(u.replace?n.replace:n.push)(c,u.state,u)},[s,n,i,r,e])}var pl=m.createContext(null);function fl(e){let s=m.useContext(Oe).outlet;return m.useMemo(()=>s&&m.createElement(pl.Provider,{value:e},s),[s,e])}function cs(){let{matches:e}=m.useContext(Oe),s=e[e.length-1];return s?s.params:{}}function Rs(e,{relative:s}={}){let{matches:n}=m.useContext(Oe),{pathname:a}=He(),r=JSON.stringify(Bn(n));return m.useMemo(()=>Un(e,JSON.parse(r),a,s==="path"),[e,r,a,s])}function yl(e,s){return mr(e,s)}function mr(e,s,n,a,r){var R;ie(os(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=m.useContext(Pe),{matches:l}=m.useContext(Oe),o=l[l.length-1],d=o?o.params:{},u=o?o.pathname:"/",c=o?o.pathnameBase:"/",h=o&&o.route;{let C=h&&h.path||"";fr(u,!h||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let y=He(),f;if(s){let C=typeof s=="string"?is(s):s;ie(c==="/"||((R=C.pathname)==null?void 0:R.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${C.pathname}" was given in the \`location\` prop.`),f=C}else f=y;let g=f.pathname||"/",v=g;if(c!=="/"){let C=c.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(C.length).join("/")}let b=nr(e,{pathname:v});$e(h||b!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),$e(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=bl(b&&b.map(C=>Object.assign({},C,{params:Object.assign({},d,C.params),pathname:tt([c,i.encodeLocation?i.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:tt([c,i.encodeLocation?i.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),l,n,a,r);return s&&_?m.createElement(Is.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},_):_}function gl(){let e=wl(),s=sl(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=m.createElement(m.Fragment,null,m.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:i},"ErrorBoundary")," or"," ",m.createElement("code",{style:i},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},s),n?m.createElement("pre",{style:r},n):null,l)}var xl=m.createElement(gl,null),pr=class extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location||s.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:s.error,location:s.location,revalidation:e.revalidation||s.revalidation}}componentDidCatch(e,s){this.props.onError?this.props.onError(e,s):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=ul(e.digest);n&&(e=n)}let s=e!==void 0?m.createElement(Oe.Provider,{value:this.props.routeContext},m.createElement(Vn.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?m.createElement(vl,{error:e},s):s}};pr.contextType=rl;var mn=new WeakMap;function vl({children:e,error:s}){let{basename:n}=m.useContext(Pe);if(typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){let a=dl(s.digest);if(a){let r=mn.get(s);if(r)throw r;let i=lr(a.location,n);if(ir&&!mn.get(s))if(i.isExternal||a.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:a.replace}));throw mn.set(s,l),l}return m.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function jl({routeContext:e,match:s,children:n}){let a=m.useContext(ls);return a&&a.static&&a.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=s.route.id),m.createElement(Oe.Provider,{value:e},n)}function bl(e,s=[],n=null,a=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(s.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,l=n==null?void 0:n.errors;if(l!=null){let c=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);ie(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,c+1))}let o=!1,d=-1;if(n)for(let c=0;c<i.length;c++){let h=i[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=c),h.route.id){let{loaderData:y,errors:f}=n,g=h.route.loader&&!y.hasOwnProperty(h.route.id)&&(!f||f[h.route.id]===void 0);if(h.route.lazy||g){o=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let u=n&&a?(c,h)=>{var y,f;a(c,{location:n.location,params:((f=(y=n.matches)==null?void 0:y[0])==null?void 0:f.params)??{},unstable_pattern:nl(n.matches),errorInfo:h})}:void 0;return i.reduceRight((c,h,y)=>{let f,g=!1,v=null,b=null;n&&(f=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||xl,o&&(d<0&&y===0?(fr("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,b=null):d===y&&(g=!0,b=h.route.hydrateFallbackElement||null)));let _=s.concat(i.slice(0,y+1)),R=()=>{let C;return f?C=v:g?C=b:h.route.Component?C=m.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=c,m.createElement(jl,{match:h,routeContext:{outlet:c,matches:_,isDataRoute:n!=null},children:C})};return n&&(h.route.ErrorBoundary||h.route.errorElement||y===0)?m.createElement(pr,{location:n.location,revalidation:n.revalidation,component:v,error:f,children:R(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:u}):R()},null)}function Wn(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Sl(e){let s=m.useContext(ls);return ie(s,Wn(e)),s}function kl(e){let s=m.useContext(sn);return ie(s,Wn(e)),s}function _l(e){let s=m.useContext(Oe);return ie(s,Wn(e)),s}function Hn(e){let s=_l(e),n=s.matches[s.matches.length-1];return ie(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function Cl(){return Hn("useRouteId")}function wl(){var a;let e=m.useContext(Vn),s=kl("useRouteError"),n=Hn("useRouteError");return e!==void 0?e:(a=s.errors)==null?void 0:a[n]}function Il(){let{router:e}=Sl("useNavigate"),s=Hn("useNavigate"),n=m.useRef(!1);return hr(()=>{n.current=!0}),m.useCallback(async(r,i={})=>{$e(n.current,ur),n.current&&(typeof r=="number"?await e.navigate(r):await e.navigate(r,{fromRouteId:s,...i}))},[e,s])}var fa={};function fr(e,s,n){!s&&!fa[e]&&(fa[e]=!0,$e(!1,n))}m.memo(Rl);function Rl({routes:e,future:s,state:n,onError:a}){return mr(e,void 0,n,a,s)}function Pl({to:e,replace:s,state:n,relative:a}){ie(os(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=m.useContext(Pe);$e(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=m.useContext(Oe),{pathname:l}=He(),o=zt(),d=Un(e,Bn(i),l,a==="path"),u=JSON.stringify(d);return m.useEffect(()=>{o(JSON.parse(u),{replace:s,state:n,relative:a})},[o,u,a,s,n]),null}function Tl(e){return fl(e.context)}function ue(e){ie(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Fl({basename:e="/",children:s=null,location:n,navigationType:a="POP",navigator:r,static:i=!1,unstable_useTransitions:l}){ie(!os(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),d=m.useMemo(()=>({basename:o,navigator:r,static:i,unstable_useTransitions:l,future:{}}),[o,r,i,l]);typeof n=="string"&&(n=is(n));let{pathname:u="/",search:c="",hash:h="",state:y=null,key:f="default"}=n,g=m.useMemo(()=>{let v=nt(u,o);return v==null?null:{location:{pathname:v,search:c,hash:h,state:y,key:f},navigationType:a}},[o,u,c,h,y,f,a]);return $e(g!=null,`<Router basename="${o}"> is not able to match the URL "${u}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:m.createElement(Pe.Provider,{value:d},m.createElement(Is.Provider,{children:s,value:g}))}function El({children:e,location:s}){return yl(jn(e),s)}function jn(e,s=[]){let n=[];return m.Children.forEach(e,(a,r)=>{if(!m.isValidElement(a))return;let i=[...s,r];if(a.type===m.Fragment){n.push.apply(n,jn(a.props.children,i));return}ie(a.type===ue,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ie(!a.props.index||!a.props.children,"An index route cannot have child routes.");let l={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(l.children=jn(a.props.children,i)),n.push(l)}),n}var Ks="get",Bs="application/x-www-form-urlencoded";function nn(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Ml(e){return nn(e)&&e.tagName.toLowerCase()==="button"}function Al(e){return nn(e)&&e.tagName.toLowerCase()==="form"}function Ol(e){return nn(e)&&e.tagName.toLowerCase()==="input"}function zl(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Ll(e,s){return e.button===0&&(!s||s==="_self")&&!zl(e)}var Os=null;function Nl(){if(Os===null)try{new FormData(document.createElement("form"),0),Os=!1}catch{Os=!0}return Os}var Dl=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pn(e){return e!=null&&!Dl.has(e)?($e(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bs}"`),null):e}function $l(e,s){let n,a,r,i,l;if(Al(e)){let o=e.getAttribute("action");a=o?nt(o,s):null,n=e.getAttribute("method")||Ks,r=pn(e.getAttribute("enctype"))||Bs,i=new FormData(e)}else if(Ml(e)||Ol(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||o.getAttribute("action");if(a=d?nt(d,s):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||Ks,r=pn(e.getAttribute("formenctype"))||pn(o.getAttribute("enctype"))||Bs,i=new FormData(o,e),!Nl()){let{name:u,type:c,value:h}=e;if(c==="image"){let y=u?`${u}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else u&&i.append(u,h)}}else{if(nn(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ks,a=null,r=Bs,l=e}return i&&r==="text/plain"&&(l=i,i=void 0),{action:a,method:n.toLowerCase(),encType:r,formData:i,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qn(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function ql(e,s,n,a){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${a}`:r.pathname=`${r.pathname}.${a}`:r.pathname==="/"?r.pathname=`_root.${a}`:s&&nt(r.pathname,s)==="/"?r.pathname=`${s.replace(/\/$/,"")}/_root.${a}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${a}`,r}async function Kl(e,s){if(e.id in s)return s[e.id];try{let n=await import(e.module);return s[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Bl(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Ul(e,s,n){let a=await Promise.all(e.map(async r=>{let i=s.routes[r.route.id];if(i){let l=await Kl(i,n);return l.links?l.links():[]}return[]}));return Ql(a.flat(1).filter(Bl).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function ya(e,s,n,a,r,i){let l=(d,u)=>n[u]?d.route.id!==n[u].route.id:!0,o=(d,u)=>{var c;return n[u].pathname!==d.pathname||((c=n[u].route.path)==null?void 0:c.endsWith("*"))&&n[u].params["*"]!==d.params["*"]};return i==="assets"?s.filter((d,u)=>l(d,u)||o(d,u)):i==="data"?s.filter((d,u)=>{var h;let c=a.routes[d.route.id];if(!c||!c.hasLoader)return!1;if(l(d,u)||o(d,u))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function Vl(e,s,{includeHydrateFallback:n}={}){return Wl(e.map(a=>{let r=s.routes[a.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function Wl(e){return[...new Set(e)]}function Hl(e){let s={},n=Object.keys(e).sort();for(let a of n)s[a]=e[a];return s}function Ql(e,s){let n=new Set;return new Set(s),e.reduce((a,r)=>{let i=JSON.stringify(Hl(r));return n.has(i)||(n.add(i),a.push({key:i,link:r})),a},[])}function yr(){let e=m.useContext(ls);return Qn(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Gl(){let e=m.useContext(sn);return Qn(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Gn=m.createContext(void 0);Gn.displayName="FrameworkContext";function gr(){let e=m.useContext(Gn);return Qn(e,"You must render this element inside a <HydratedRouter> element"),e}function Jl(e,s){let n=m.useContext(Gn),[a,r]=m.useState(!1),[i,l]=m.useState(!1),{onFocus:o,onBlur:d,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=s,y=m.useRef(null);m.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let v=_=>{_.forEach(R=>{l(R.isIntersecting)})},b=new IntersectionObserver(v,{threshold:.5});return y.current&&b.observe(y.current),()=>{b.disconnect()}}},[e]),m.useEffect(()=>{if(a){let v=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(v)}}},[a]);let f=()=>{r(!0)},g=()=>{r(!1),l(!1)};return n?e!=="intent"?[i,y,{}]:[i,y,{onFocus:ys(o,f),onBlur:ys(d,g),onMouseEnter:ys(u,f),onMouseLeave:ys(c,g),onTouchStart:ys(h,f)}]:[!1,y,{}]}function ys(e,s){return n=>{e&&e(n),n.defaultPrevented||s(n)}}function Yl({page:e,...s}){let{router:n}=yr(),a=m.useMemo(()=>nr(n.routes,e,n.basename),[n.routes,e,n.basename]);return a?m.createElement(Zl,{page:e,matches:a,...s}):null}function Xl(e){let{manifest:s,routeModules:n}=gr(),[a,r]=m.useState([]);return m.useEffect(()=>{let i=!1;return Ul(e,s,n).then(l=>{i||r(l)}),()=>{i=!0}},[e,s,n]),a}function Zl({page:e,matches:s,...n}){let a=He(),{future:r,manifest:i,routeModules:l}=gr(),{basename:o}=yr(),{loaderData:d,matches:u}=Gl(),c=m.useMemo(()=>ya(e,s,u,i,a,"data"),[e,s,u,i,a]),h=m.useMemo(()=>ya(e,s,u,i,a,"assets"),[e,s,u,i,a]),y=m.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let v=new Set,b=!1;if(s.forEach(R=>{var w;let C=i.routes[R.route.id];!C||!C.hasLoader||(!c.some(P=>P.route.id===R.route.id)&&R.route.id in d&&((w=l[R.route.id])!=null&&w.shouldRevalidate)||C.hasClientLoader?b=!0:v.add(R.route.id))}),v.size===0)return[];let _=ql(e,o,r.unstable_trailingSlashAwareDataRequests,"data");return b&&v.size>0&&_.searchParams.set("_routes",s.filter(R=>v.has(R.route.id)).map(R=>R.route.id).join(",")),[_.pathname+_.search]},[o,r.unstable_trailingSlashAwareDataRequests,d,a,i,c,s,e,l]),f=m.useMemo(()=>Vl(h,i),[h,i]),g=Xl(h);return m.createElement(m.Fragment,null,y.map(v=>m.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...n})),f.map(v=>m.createElement("link",{key:v,rel:"modulepreload",href:v,...n})),g.map(({key:v,link:b})=>m.createElement("link",{key:v,nonce:n.nonce,...b,crossOrigin:b.crossOrigin??n.crossOrigin})))}function eo(...e){return s=>{e.forEach(n=>{typeof n=="function"?n(s):n!=null&&(n.current=s)})}}var to=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{to&&(window.__reactRouterVersion="7.13.0")}catch{}function so({basename:e,children:s,unstable_useTransitions:n,window:a}){let r=m.useRef();r.current==null&&(r.current=Ei({window:a,v5Compat:!0}));let i=r.current,[l,o]=m.useState({action:i.action,location:i.location}),d=m.useCallback(u=>{n===!1?o(u):m.startTransition(()=>o(u))},[n]);return m.useLayoutEffect(()=>i.listen(d),[i,d]),m.createElement(Fl,{basename:e,children:s,location:l.location,navigationType:l.action,navigator:i,unstable_useTransitions:n})}var xr=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ss=m.forwardRef(function({onClick:s,discover:n="render",prefetch:a="none",relative:r,reloadDocument:i,replace:l,state:o,target:d,to:u,preventScrollReset:c,viewTransition:h,unstable_defaultShouldRevalidate:y,...f},g){let{basename:v,unstable_useTransitions:b}=m.useContext(Pe),_=typeof u=="string"&&xr.test(u),R=lr(u,v);u=R.to;let C=hl(u,{relative:r}),[w,P,j]=Jl(a,f),S=io(u,{replace:l,state:o,target:d,preventScrollReset:c,relative:r,viewTransition:h,unstable_defaultShouldRevalidate:y,unstable_useTransitions:b});function I(k){s&&s(k),k.defaultPrevented||S(k)}let F=m.createElement("a",{...f,...j,href:R.absoluteURL||C,onClick:R.isExternal||i?s:I,ref:eo(g,P),target:d,"data-discover":!_&&n==="render"?"true":void 0});return w&&!_?m.createElement(m.Fragment,null,F,m.createElement(Yl,{page:C})):F});ss.displayName="Link";var no=m.forwardRef(function({"aria-current":s="page",caseSensitive:n=!1,className:a="",end:r=!1,style:i,to:l,viewTransition:o,children:d,...u},c){let h=Rs(l,{relative:u.relative}),y=He(),f=m.useContext(sn),{navigator:g,basename:v}=m.useContext(Pe),b=f!=null&&ho(h)&&o===!0,_=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,R=y.pathname,C=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(R=R.toLowerCase(),C=C?C.toLowerCase():null,_=_.toLowerCase()),C&&v&&(C=nt(C,v)||C);const w=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let P=R===_||!r&&R.startsWith(_)&&R.charAt(w)==="/",j=C!=null&&(C===_||!r&&C.startsWith(_)&&C.charAt(_.length)==="/"),S={isActive:P,isPending:j,isTransitioning:b},I=P?s:void 0,F;typeof a=="function"?F=a(S):F=[a,P?"active":null,j?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let k=typeof i=="function"?i(S):i;return m.createElement(ss,{...u,"aria-current":I,className:F,ref:c,style:k,to:l,viewTransition:o},typeof d=="function"?d(S):d)});no.displayName="NavLink";var ao=m.forwardRef(({discover:e="render",fetcherKey:s,navigate:n,reloadDocument:a,replace:r,state:i,method:l=Ks,action:o,onSubmit:d,relative:u,preventScrollReset:c,viewTransition:h,unstable_defaultShouldRevalidate:y,...f},g)=>{let{unstable_useTransitions:v}=m.useContext(Pe),b=co(),_=uo(o,{relative:u}),R=l.toLowerCase()==="get"?"get":"post",C=typeof o=="string"&&xr.test(o),w=P=>{if(d&&d(P),P.defaultPrevented)return;P.preventDefault();let j=P.nativeEvent.submitter,S=(j==null?void 0:j.getAttribute("formmethod"))||l,I=()=>b(j||P.currentTarget,{fetcherKey:s,method:S,navigate:n,replace:r,state:i,relative:u,preventScrollReset:c,viewTransition:h,unstable_defaultShouldRevalidate:y});v&&n!==!1?m.startTransition(()=>I()):I()};return m.createElement("form",{ref:g,method:R,action:_,onSubmit:a?d:w,...f,"data-discover":!C&&e==="render"?"true":void 0})});ao.displayName="Form";function ro(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vr(e){let s=m.useContext(ls);return ie(s,ro(e)),s}function io(e,{target:s,replace:n,state:a,preventScrollReset:r,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:o,unstable_useTransitions:d}={}){let u=zt(),c=He(),h=Rs(e,{relative:i});return m.useCallback(y=>{if(Ll(y,s)){y.preventDefault();let f=n!==void 0?n:js(c)===js(h),g=()=>u(e,{replace:f,state:a,preventScrollReset:r,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:o});d?m.startTransition(()=>g()):g()}},[c,u,h,n,a,s,e,r,i,l,o,d])}var lo=0,oo=()=>`__${String(++lo)}__`;function co(){let{router:e}=vr("useSubmit"),{basename:s}=m.useContext(Pe),n=Cl(),a=e.fetch,r=e.navigate;return m.useCallback(async(i,l={})=>{let{action:o,method:d,encType:u,formData:c,body:h}=$l(i,s);if(l.navigate===!1){let y=l.fetcherKey||oo();await a(y,n,l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:c,body:h,formMethod:l.method||d,formEncType:l.encType||u,flushSync:l.flushSync})}else await r(l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:c,body:h,formMethod:l.method||d,formEncType:l.encType||u,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[a,r,s,n])}function uo(e,{relative:s}={}){let{basename:n}=m.useContext(Pe),a=m.useContext(Oe);ie(a,"useFormAction must be used inside a RouteContext");let[r]=a.matches.slice(-1),i={...Rs(e||".",{relative:s})},l=He();if(e==null){i.search=l.search;let o=new URLSearchParams(i.search),d=o.getAll("index");if(d.some(c=>c==="")){o.delete("index"),d.filter(h=>h).forEach(h=>o.append("index",h));let c=o.toString();i.search=c?`?${c}`:""}}return(!e||e===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:tt([n,i.pathname])),js(i)}function ho(e,{relative:s}={}){let n=m.useContext(cr);ie(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=vr("useViewTransitionState"),r=Rs(e,{relative:s});if(!n.isTransitioning)return!1;let i=nt(n.currentLocation.pathname,a)||n.currentLocation.pathname,l=nt(n.nextLocation.pathname,a)||n.nextLocation.pathname;return Hs(r.pathname,l)!=null||Hs(r.pathname,i)!=null}var ds=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mo={setTimeout:(e,s)=>setTimeout(e,s),clearTimeout:e=>clearTimeout(e),setInterval:(e,s)=>setInterval(e,s),clearInterval:e=>clearInterval(e)},ot,Ln,za,po=(za=class{constructor(){L(this,ot,mo);L(this,Ln,!1)}setTimeoutProvider(e){M(this,ot,e)}setTimeout(e,s){return p(this,ot).setTimeout(e,s)}clearTimeout(e){p(this,ot).clearTimeout(e)}setInterval(e,s){return p(this,ot).setInterval(e,s)}clearInterval(e){p(this,ot).clearInterval(e)}},ot=new WeakMap,Ln=new WeakMap,za),bt=new po;function fo(e){setTimeout(e,0)}var Mt=typeof window>"u"||"Deno"in globalThis;function je(){}function yo(e,s){return typeof e=="function"?e(s):e}function bn(e){return typeof e=="number"&&e>=0&&e!==1/0}function jr(e,s){return Math.max(e+(s||0)-Date.now(),0)}function xt(e,s){return typeof e=="function"?e(s):e}function Fe(e,s){return typeof e=="function"?e(s):e}function ga(e,s){const{type:n="all",exact:a,fetchStatus:r,predicate:i,queryKey:l,stale:o}=e;if(l){if(a){if(s.queryHash!==Jn(l,s.options))return!1}else if(!bs(s.queryKey,l))return!1}if(n!=="all"){const d=s.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof o=="boolean"&&s.isStale()!==o||r&&r!==s.state.fetchStatus||i&&!i(s))}function xa(e,s){const{exact:n,status:a,predicate:r,mutationKey:i}=e;if(i){if(!s.options.mutationKey)return!1;if(n){if(At(s.options.mutationKey)!==At(i))return!1}else if(!bs(s.options.mutationKey,i))return!1}return!(a&&s.state.status!==a||r&&!r(s))}function Jn(e,s){return((s==null?void 0:s.queryKeyHashFn)||At)(e)}function At(e){return JSON.stringify(e,(s,n)=>Sn(n)?Object.keys(n).sort().reduce((a,r)=>(a[r]=n[r],a),{}):n)}function bs(e,s){return e===s?!0:typeof e!=typeof s?!1:e&&s&&typeof e=="object"&&typeof s=="object"?Object.keys(s).every(n=>bs(e[n],s[n])):!1}var go=Object.prototype.hasOwnProperty;function br(e,s,n=0){if(e===s)return e;if(n>500)return s;const a=va(e)&&va(s);if(!a&&!(Sn(e)&&Sn(s)))return s;const i=(a?e:Object.keys(e)).length,l=a?s:Object.keys(s),o=l.length,d=a?new Array(o):{};let u=0;for(let c=0;c<o;c++){const h=a?c:l[c],y=e[h],f=s[h];if(y===f){d[h]=y,(a?c<i:go.call(e,h))&&u++;continue}if(y===null||f===null||typeof y!="object"||typeof f!="object"){d[h]=f;continue}const g=br(y,f,n+1);d[h]=g,g===y&&u++}return i===o&&u===i?e:d}function Qs(e,s){if(!s||Object.keys(e).length!==Object.keys(s).length)return!1;for(const n in e)if(e[n]!==s[n])return!1;return!0}function va(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Sn(e){if(!ja(e))return!1;const s=e.constructor;if(s===void 0)return!0;const n=s.prototype;return!(!ja(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ja(e){return Object.prototype.toString.call(e)==="[object Object]"}function xo(e){return new Promise(s=>{bt.setTimeout(s,e)})}function kn(e,s,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,s):n.structuralSharing!==!1?br(e,s):s}function vo(e,s,n=0){const a=[...e,s];return n&&a.length>n?a.slice(1):a}function jo(e,s,n=0){const a=[s,...e];return n&&a.length>n?a.slice(0,-1):a}var Yn=Symbol();function Sr(e,s){return!e.queryFn&&(s!=null&&s.initialPromise)?()=>s.initialPromise:!e.queryFn||e.queryFn===Yn?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Xn(e,s){return typeof e=="function"?e(...s):!!e}function bo(e,s,n){let a=!1,r;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(r??(r=s()),a||(a=!0,r.aborted?n():r.addEventListener("abort",n,{once:!0})),r)}),e}var St,ct,qt,La,So=(La=class extends ds{constructor(){super();L(this,St);L(this,ct);L(this,qt);M(this,qt,s=>{if(!Mt&&window.addEventListener){const n=()=>s();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){p(this,ct)||this.setEventListener(p(this,qt))}onUnsubscribe(){var s;this.hasListeners()||((s=p(this,ct))==null||s.call(this),M(this,ct,void 0))}setEventListener(s){var n;M(this,qt,s),(n=p(this,ct))==null||n.call(this),M(this,ct,s(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(s){p(this,St)!==s&&(M(this,St,s),this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(n=>{n(s)})}isFocused(){var s;return typeof p(this,St)=="boolean"?p(this,St):((s=globalThis.document)==null?void 0:s.visibilityState)!=="hidden"}},St=new WeakMap,ct=new WeakMap,qt=new WeakMap,La),Zn=new So;function _n(){let e,s;const n=new Promise((r,i)=>{e=r,s=i});n.status="pending",n.catch(()=>{});function a(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{a({status:"fulfilled",value:r}),e(r)},n.reject=r=>{a({status:"rejected",reason:r}),s(r)},n}var ko=fo;function _o(){let e=[],s=0,n=o=>{o()},a=o=>{o()},r=ko;const i=o=>{s?e.push(o):r(()=>{n(o)})},l=()=>{const o=e;e=[],o.length&&r(()=>{a(()=>{o.forEach(d=>{n(d)})})})};return{batch:o=>{let d;s++;try{d=o()}finally{s--,s||l()}return d},batchCalls:o=>(...d)=>{i(()=>{o(...d)})},schedule:i,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{a=o},setScheduler:o=>{r=o}}}var me=_o(),Kt,dt,Bt,Na,Co=(Na=class extends ds{constructor(){super();L(this,Kt,!0);L(this,dt);L(this,Bt);M(this,Bt,s=>{if(!Mt&&window.addEventListener){const n=()=>s(!0),a=()=>s(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a)}}})}onSubscribe(){p(this,dt)||this.setEventListener(p(this,Bt))}onUnsubscribe(){var s;this.hasListeners()||((s=p(this,dt))==null||s.call(this),M(this,dt,void 0))}setEventListener(s){var n;M(this,Bt,s),(n=p(this,dt))==null||n.call(this),M(this,dt,s(this.setOnline.bind(this)))}setOnline(s){p(this,Kt)!==s&&(M(this,Kt,s),this.listeners.forEach(a=>{a(s)}))}isOnline(){return p(this,Kt)}},Kt=new WeakMap,dt=new WeakMap,Bt=new WeakMap,Na),Gs=new Co;function wo(e){return Math.min(1e3*2**e,3e4)}function kr(e){return(e??"online")==="online"?Gs.isOnline():!0}var Cn=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function _r(e){let s=!1,n=0,a;const r=_n(),i=()=>r.status!=="pending",l=v=>{var b;if(!i()){const _=new Cn(v);y(_),(b=e.onCancel)==null||b.call(e,_)}},o=()=>{s=!0},d=()=>{s=!1},u=()=>Zn.isFocused()&&(e.networkMode==="always"||Gs.isOnline())&&e.canRun(),c=()=>kr(e.networkMode)&&e.canRun(),h=v=>{i()||(a==null||a(),r.resolve(v))},y=v=>{i()||(a==null||a(),r.reject(v))},f=()=>new Promise(v=>{var b;a=_=>{(i()||u())&&v(_)},(b=e.onPause)==null||b.call(e)}).then(()=>{var v;a=void 0,i()||(v=e.onContinue)==null||v.call(e)}),g=()=>{if(i())return;let v;const b=n===0?e.initialPromise:void 0;try{v=b??e.fn()}catch(_){v=Promise.reject(_)}Promise.resolve(v).then(h).catch(_=>{var j;if(i())return;const R=e.retry??(Mt?0:3),C=e.retryDelay??wo,w=typeof C=="function"?C(n,_):C,P=R===!0||typeof R=="number"&&n<R||typeof R=="function"&&R(n,_);if(s||!P){y(_);return}n++,(j=e.onFail)==null||j.call(e,n,_),xo(w).then(()=>u()?void 0:f()).then(()=>{s?y(_):g()})})};return{promise:r,status:()=>r.status,cancel:l,continue:()=>(a==null||a(),r),cancelRetry:o,continueRetry:d,canStart:c,start:()=>(c()?g():f().then(g),r)}}var kt,Da,Cr=(Da=class{constructor(){L(this,kt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),bn(this.gcTime)&&M(this,kt,bt.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Mt?1/0:300*1e3))}clearGcTimeout(){p(this,kt)&&(bt.clearTimeout(p(this,kt)),M(this,kt,void 0))}},kt=new WeakMap,Da),_t,Ut,Te,Ct,pe,Ss,wt,Le,Qe,$a,Io=($a=class extends Cr{constructor(s){super();L(this,Le);L(this,_t);L(this,Ut);L(this,Te);L(this,Ct);L(this,pe);L(this,Ss);L(this,wt);M(this,wt,!1),M(this,Ss,s.defaultOptions),this.setOptions(s.options),this.observers=[],M(this,Ct,s.client),M(this,Te,p(this,Ct).getQueryCache()),this.queryKey=s.queryKey,this.queryHash=s.queryHash,M(this,_t,Sa(this.options)),this.state=s.state??p(this,_t),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var s;return(s=p(this,pe))==null?void 0:s.promise}setOptions(s){if(this.options={...p(this,Ss),...s},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Sa(this.options);n.data!==void 0&&(this.setState(ba(n.data,n.dataUpdatedAt)),M(this,_t,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&p(this,Te).remove(this)}setData(s,n){const a=kn(this.state.data,s,this.options);return U(this,Le,Qe).call(this,{data:a,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),a}setState(s,n){U(this,Le,Qe).call(this,{type:"setState",state:s,setStateOptions:n})}cancel(s){var a,r;const n=(a=p(this,pe))==null?void 0:a.promise;return(r=p(this,pe))==null||r.cancel(s),n?n.then(je).catch(je):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(p(this,_t))}isActive(){return this.observers.some(s=>Fe(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Yn||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>xt(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!jr(this.state.dataUpdatedAt,s)}onFocus(){var n;const s=this.observers.find(a=>a.shouldFetchOnWindowFocus());s==null||s.refetch({cancelRefetch:!1}),(n=p(this,pe))==null||n.continue()}onOnline(){var n;const s=this.observers.find(a=>a.shouldFetchOnReconnect());s==null||s.refetch({cancelRefetch:!1}),(n=p(this,pe))==null||n.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),p(this,Te).notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(n=>n!==s),this.observers.length||(p(this,pe)&&(p(this,wt)?p(this,pe).cancel({revert:!0}):p(this,pe).cancelRetry()),this.scheduleGc()),p(this,Te).notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||U(this,Le,Qe).call(this,{type:"invalidate"})}async fetch(s,n){var d,u,c,h,y,f,g,v,b,_,R,C;if(this.state.fetchStatus!=="idle"&&((d=p(this,pe))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(p(this,pe))return p(this,pe).continueRetry(),p(this,pe).promise}if(s&&this.setOptions(s),!this.options.queryFn){const w=this.observers.find(P=>P.options.queryFn);w&&this.setOptions(w.options)}const a=new AbortController,r=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(M(this,wt,!0),a.signal)})},i=()=>{const w=Sr(this.options,n),j=(()=>{const S={client:p(this,Ct),queryKey:this.queryKey,meta:this.meta};return r(S),S})();return M(this,wt,!1),this.options.persister?this.options.persister(w,j,this):w(j)},o=(()=>{const w={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:p(this,Ct),state:this.state,fetchFn:i};return r(w),w})();(u=this.options.behavior)==null||u.onFetch(o,this),M(this,Ut,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&U(this,Le,Qe).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),M(this,pe,_r({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,onCancel:w=>{w instanceof Cn&&w.revert&&this.setState({...p(this,Ut),fetchStatus:"idle"}),a.abort()},onFail:(w,P)=>{U(this,Le,Qe).call(this,{type:"failed",failureCount:w,error:P})},onPause:()=>{U(this,Le,Qe).call(this,{type:"pause"})},onContinue:()=>{U(this,Le,Qe).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=await p(this,pe).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(f=(y=p(this,Te).config).onSuccess)==null||f.call(y,w,this),(v=(g=p(this,Te).config).onSettled)==null||v.call(g,w,this.state.error,this),w}catch(w){if(w instanceof Cn){if(w.silent)return p(this,pe).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw U(this,Le,Qe).call(this,{type:"error",error:w}),(_=(b=p(this,Te).config).onError)==null||_.call(b,w,this),(C=(R=p(this,Te).config).onSettled)==null||C.call(R,this.state.data,w,this),w}finally{this.scheduleGc()}}},_t=new WeakMap,Ut=new WeakMap,Te=new WeakMap,Ct=new WeakMap,pe=new WeakMap,Ss=new WeakMap,wt=new WeakMap,Le=new WeakSet,Qe=function(s){const n=a=>{switch(s.type){case"failed":return{...a,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...wr(a.data,this.options),fetchMeta:s.meta??null};case"success":const r={...a,...ba(s.data,s.dataUpdatedAt),dataUpdateCount:a.dataUpdateCount+1,...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return M(this,Ut,s.manual?r:void 0),r;case"error":const i=s.error;return{...a,error:i,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...s.state}}};this.state=n(this.state),me.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),p(this,Te).notify({query:this,type:"updated",action:s})})},$a);function wr(e,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:kr(s.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function ba(e,s){return{data:e,dataUpdatedAt:s??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Sa(e){const s=typeof e.initialData=="function"?e.initialData():e.initialData,n=s!==void 0,a=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:n?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var _e,Q,ks,ve,It,Vt,Ge,ut,_s,Wt,Ht,Rt,Pt,ht,Qt,te,gs,wn,In,Rn,Pn,Tn,Fn,En,Ir,qa,Ro=(qa=class extends ds{constructor(s,n){super();L(this,te);L(this,_e);L(this,Q);L(this,ks);L(this,ve);L(this,It);L(this,Vt);L(this,Ge);L(this,ut);L(this,_s);L(this,Wt);L(this,Ht);L(this,Rt);L(this,Pt);L(this,ht);L(this,Qt,new Set);this.options=n,M(this,_e,s),M(this,ut,null),M(this,Ge,_n()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(p(this,Q).addObserver(this),ka(p(this,Q),this.options)?U(this,te,gs).call(this):this.updateResult(),U(this,te,Pn).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Mn(p(this,Q),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Mn(p(this,Q),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,U(this,te,Tn).call(this),U(this,te,Fn).call(this),p(this,Q).removeObserver(this)}setOptions(s){const n=this.options,a=p(this,Q);if(this.options=p(this,_e).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Fe(this.options.enabled,p(this,Q))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");U(this,te,En).call(this),p(this,Q).setOptions(this.options),n._defaulted&&!Qs(this.options,n)&&p(this,_e).getQueryCache().notify({type:"observerOptionsUpdated",query:p(this,Q),observer:this});const r=this.hasListeners();r&&_a(p(this,Q),a,this.options,n)&&U(this,te,gs).call(this),this.updateResult(),r&&(p(this,Q)!==a||Fe(this.options.enabled,p(this,Q))!==Fe(n.enabled,p(this,Q))||xt(this.options.staleTime,p(this,Q))!==xt(n.staleTime,p(this,Q)))&&U(this,te,wn).call(this);const i=U(this,te,In).call(this);r&&(p(this,Q)!==a||Fe(this.options.enabled,p(this,Q))!==Fe(n.enabled,p(this,Q))||i!==p(this,ht))&&U(this,te,Rn).call(this,i)}getOptimisticResult(s){const n=p(this,_e).getQueryCache().build(p(this,_e),s),a=this.createResult(n,s);return To(this,a)&&(M(this,ve,a),M(this,Vt,this.options),M(this,It,p(this,Q).state)),a}getCurrentResult(){return p(this,ve)}trackResult(s,n){return new Proxy(s,{get:(a,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&p(this,Ge).status==="pending"&&p(this,Ge).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(a,r))})}trackProp(s){p(this,Qt).add(s)}getCurrentQuery(){return p(this,Q)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const n=p(this,_e).defaultQueryOptions(s),a=p(this,_e).getQueryCache().build(p(this,_e),n);return a.fetch().then(()=>this.createResult(a,n))}fetch(s){return U(this,te,gs).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),p(this,ve)))}createResult(s,n){var F;const a=p(this,Q),r=this.options,i=p(this,ve),l=p(this,It),o=p(this,Vt),u=s!==a?s.state:p(this,ks),{state:c}=s;let h={...c},y=!1,f;if(n._optimisticResults){const k=this.hasListeners(),x=!k&&ka(s,n),E=k&&_a(s,a,n,r);(x||E)&&(h={...h,...wr(c.data,s.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:v,status:b}=h;f=h.data;let _=!1;if(n.placeholderData!==void 0&&f===void 0&&b==="pending"){let k;i!=null&&i.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(k=i.data,_=!0):k=typeof n.placeholderData=="function"?n.placeholderData((F=p(this,Ht))==null?void 0:F.state.data,p(this,Ht)):n.placeholderData,k!==void 0&&(b="success",f=kn(i==null?void 0:i.data,k,n),y=!0)}if(n.select&&f!==void 0&&!_)if(i&&f===(l==null?void 0:l.data)&&n.select===p(this,_s))f=p(this,Wt);else try{M(this,_s,n.select),f=n.select(f),f=kn(i==null?void 0:i.data,f,n),M(this,Wt,f),M(this,ut,null)}catch(k){M(this,ut,k)}p(this,ut)&&(g=p(this,ut),f=p(this,Wt),v=Date.now(),b="error");const R=h.fetchStatus==="fetching",C=b==="pending",w=b==="error",P=C&&R,j=f!==void 0,I={status:b,fetchStatus:h.fetchStatus,isPending:C,isSuccess:b==="success",isError:w,isInitialLoading:P,isLoading:P,data:f,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:R,isRefetching:R&&!C,isLoadingError:w&&!j,isPaused:h.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:w&&j,isStale:ea(s,n),refetch:this.refetch,promise:p(this,Ge),isEnabled:Fe(n.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const k=I.data!==void 0,x=I.status==="error"&&!k,E=ce=>{x?ce.reject(I.error):k&&ce.resolve(I.data)},$=()=>{const ce=M(this,Ge,I.promise=_n());E(ce)},se=p(this,Ge);switch(se.status){case"pending":s.queryHash===a.queryHash&&E(se);break;case"fulfilled":(x||I.data!==se.value)&&$();break;case"rejected":(!x||I.error!==se.reason)&&$();break}}return I}updateResult(){const s=p(this,ve),n=this.createResult(p(this,Q),this.options);if(M(this,It,p(this,Q).state),M(this,Vt,this.options),p(this,It).data!==void 0&&M(this,Ht,p(this,Q)),Qs(n,s))return;M(this,ve,n);const a=()=>{if(!s)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!p(this,Qt).size)return!0;const l=new Set(i??p(this,Qt));return this.options.throwOnError&&l.add("error"),Object.keys(p(this,ve)).some(o=>{const d=o;return p(this,ve)[d]!==s[d]&&l.has(d)})};U(this,te,Ir).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&U(this,te,Pn).call(this)}},_e=new WeakMap,Q=new WeakMap,ks=new WeakMap,ve=new WeakMap,It=new WeakMap,Vt=new WeakMap,Ge=new WeakMap,ut=new WeakMap,_s=new WeakMap,Wt=new WeakMap,Ht=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,ht=new WeakMap,Qt=new WeakMap,te=new WeakSet,gs=function(s){U(this,te,En).call(this);let n=p(this,Q).fetch(this.options,s);return s!=null&&s.throwOnError||(n=n.catch(je)),n},wn=function(){U(this,te,Tn).call(this);const s=xt(this.options.staleTime,p(this,Q));if(Mt||p(this,ve).isStale||!bn(s))return;const a=jr(p(this,ve).dataUpdatedAt,s)+1;M(this,Rt,bt.setTimeout(()=>{p(this,ve).isStale||this.updateResult()},a))},In=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(p(this,Q)):this.options.refetchInterval)??!1},Rn=function(s){U(this,te,Fn).call(this),M(this,ht,s),!(Mt||Fe(this.options.enabled,p(this,Q))===!1||!bn(p(this,ht))||p(this,ht)===0)&&M(this,Pt,bt.setInterval(()=>{(this.options.refetchIntervalInBackground||Zn.isFocused())&&U(this,te,gs).call(this)},p(this,ht)))},Pn=function(){U(this,te,wn).call(this),U(this,te,Rn).call(this,U(this,te,In).call(this))},Tn=function(){p(this,Rt)&&(bt.clearTimeout(p(this,Rt)),M(this,Rt,void 0))},Fn=function(){p(this,Pt)&&(bt.clearInterval(p(this,Pt)),M(this,Pt,void 0))},En=function(){const s=p(this,_e).getQueryCache().build(p(this,_e),this.options);if(s===p(this,Q))return;const n=p(this,Q);M(this,Q,s),M(this,ks,s.state),this.hasListeners()&&(n==null||n.removeObserver(this),s.addObserver(this))},Ir=function(s){me.batch(()=>{s.listeners&&this.listeners.forEach(n=>{n(p(this,ve))}),p(this,_e).getQueryCache().notify({query:p(this,Q),type:"observerResultsUpdated"})})},qa);function Po(e,s){return Fe(s.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&s.retryOnMount===!1)}function ka(e,s){return Po(e,s)||e.state.data!==void 0&&Mn(e,s,s.refetchOnMount)}function Mn(e,s,n){if(Fe(s.enabled,e)!==!1&&xt(s.staleTime,e)!=="static"){const a=typeof n=="function"?n(e):n;return a==="always"||a!==!1&&ea(e,s)}return!1}function _a(e,s,n,a){return(e!==s||Fe(a.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&ea(e,n)}function ea(e,s){return Fe(s.enabled,e)!==!1&&e.isStaleByTime(xt(s.staleTime,e))}function To(e,s){return!Qs(e.getCurrentResult(),s)}function Ca(e){return{onFetch:(s,n)=>{var c,h,y,f,g;const a=s.options,r=(y=(h=(c=s.fetchOptions)==null?void 0:c.meta)==null?void 0:h.fetchMore)==null?void 0:y.direction,i=((f=s.state.data)==null?void 0:f.pages)||[],l=((g=s.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},d=0;const u=async()=>{let v=!1;const b=C=>{bo(C,()=>s.signal,()=>v=!0)},_=Sr(s.options,s.fetchOptions),R=async(C,w,P)=>{if(v)return Promise.reject();if(w==null&&C.pages.length)return Promise.resolve(C);const S=(()=>{const x={client:s.client,queryKey:s.queryKey,pageParam:w,direction:P?"backward":"forward",meta:s.options.meta};return b(x),x})(),I=await _(S),{maxPages:F}=s.options,k=P?jo:vo;return{pages:k(C.pages,I,F),pageParams:k(C.pageParams,w,F)}};if(r&&i.length){const C=r==="backward",w=C?Fo:wa,P={pages:i,pageParams:l},j=w(a,P);o=await R(P,j,C)}else{const C=e??i.length;do{const w=d===0?l[0]??a.initialPageParam:wa(a,o);if(d>0&&w==null)break;o=await R(o,w),d++}while(d<C)}return o};s.options.persister?s.fetchFn=()=>{var v,b;return(b=(v=s.options).persister)==null?void 0:b.call(v,u,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},n)}:s.fetchFn=u}}}function wa(e,{pages:s,pageParams:n}){const a=s.length-1;return s.length>0?e.getNextPageParam(s[a],s,n[a],n):void 0}function Fo(e,{pages:s,pageParams:n}){var a;return s.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,s[0],s,n[0],n):void 0}var Cs,Ke,ye,Tt,Be,lt,Ka,Eo=(Ka=class extends Cr{constructor(s){super();L(this,Be);L(this,Cs);L(this,Ke);L(this,ye);L(this,Tt);M(this,Cs,s.client),this.mutationId=s.mutationId,M(this,ye,s.mutationCache),M(this,Ke,[]),this.state=s.state||Rr(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){p(this,Ke).includes(s)||(p(this,Ke).push(s),this.clearGcTimeout(),p(this,ye).notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){M(this,Ke,p(this,Ke).filter(n=>n!==s)),this.scheduleGc(),p(this,ye).notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){p(this,Ke).length||(this.state.status==="pending"?this.scheduleGc():p(this,ye).remove(this))}continue(){var s;return((s=p(this,Tt))==null?void 0:s.continue())??this.execute(this.state.variables)}async execute(s){var l,o,d,u,c,h,y,f,g,v,b,_,R,C,w,P,j,S;const n=()=>{U(this,Be,lt).call(this,{type:"continue"})},a={client:p(this,Cs),meta:this.options.meta,mutationKey:this.options.mutationKey};M(this,Tt,_r({fn:()=>this.options.mutationFn?this.options.mutationFn(s,a):Promise.reject(new Error("No mutationFn found")),onFail:(I,F)=>{U(this,Be,lt).call(this,{type:"failed",failureCount:I,error:F})},onPause:()=>{U(this,Be,lt).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>p(this,ye).canRun(this)}));const r=this.state.status==="pending",i=!p(this,Tt).canStart();try{if(r)n();else{U(this,Be,lt).call(this,{type:"pending",variables:s,isPaused:i}),p(this,ye).config.onMutate&&await p(this,ye).config.onMutate(s,this,a);const F=await((o=(l=this.options).onMutate)==null?void 0:o.call(l,s,a));F!==this.state.context&&U(this,Be,lt).call(this,{type:"pending",context:F,variables:s,isPaused:i})}const I=await p(this,Tt).start();return await((u=(d=p(this,ye).config).onSuccess)==null?void 0:u.call(d,I,s,this.state.context,this,a)),await((h=(c=this.options).onSuccess)==null?void 0:h.call(c,I,s,this.state.context,a)),await((f=(y=p(this,ye).config).onSettled)==null?void 0:f.call(y,I,null,this.state.variables,this.state.context,this,a)),await((v=(g=this.options).onSettled)==null?void 0:v.call(g,I,null,s,this.state.context,a)),U(this,Be,lt).call(this,{type:"success",data:I}),I}catch(I){try{await((_=(b=p(this,ye).config).onError)==null?void 0:_.call(b,I,s,this.state.context,this,a))}catch(F){Promise.reject(F)}try{await((C=(R=this.options).onError)==null?void 0:C.call(R,I,s,this.state.context,a))}catch(F){Promise.reject(F)}try{await((P=(w=p(this,ye).config).onSettled)==null?void 0:P.call(w,void 0,I,this.state.variables,this.state.context,this,a))}catch(F){Promise.reject(F)}try{await((S=(j=this.options).onSettled)==null?void 0:S.call(j,void 0,I,s,this.state.context,a))}catch(F){Promise.reject(F)}throw U(this,Be,lt).call(this,{type:"error",error:I}),I}finally{p(this,ye).runNext(this)}}},Cs=new WeakMap,Ke=new WeakMap,ye=new WeakMap,Tt=new WeakMap,Be=new WeakSet,lt=function(s){const n=a=>{switch(s.type){case"failed":return{...a,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...a,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:s.error,failureCount:a.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=n(this.state),me.batch(()=>{p(this,Ke).forEach(a=>{a.onMutationUpdate(s)}),p(this,ye).notify({mutation:this,type:"updated",action:s})})},Ka);function Rr(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Je,Ne,ws,Ba,Mo=(Ba=class extends ds{constructor(s={}){super();L(this,Je);L(this,Ne);L(this,ws);this.config=s,M(this,Je,new Set),M(this,Ne,new Map),M(this,ws,0)}build(s,n,a){const r=new Eo({client:s,mutationCache:this,mutationId:++Ms(this,ws)._,options:s.defaultMutationOptions(n),state:a});return this.add(r),r}add(s){p(this,Je).add(s);const n=zs(s);if(typeof n=="string"){const a=p(this,Ne).get(n);a?a.push(s):p(this,Ne).set(n,[s])}this.notify({type:"added",mutation:s})}remove(s){if(p(this,Je).delete(s)){const n=zs(s);if(typeof n=="string"){const a=p(this,Ne).get(n);if(a)if(a.length>1){const r=a.indexOf(s);r!==-1&&a.splice(r,1)}else a[0]===s&&p(this,Ne).delete(n)}}this.notify({type:"removed",mutation:s})}canRun(s){const n=zs(s);if(typeof n=="string"){const a=p(this,Ne).get(n),r=a==null?void 0:a.find(i=>i.state.status==="pending");return!r||r===s}else return!0}runNext(s){var a;const n=zs(s);if(typeof n=="string"){const r=(a=p(this,Ne).get(n))==null?void 0:a.find(i=>i!==s&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){me.batch(()=>{p(this,Je).forEach(s=>{this.notify({type:"removed",mutation:s})}),p(this,Je).clear(),p(this,Ne).clear()})}getAll(){return Array.from(p(this,Je))}find(s){const n={exact:!0,...s};return this.getAll().find(a=>xa(n,a))}findAll(s={}){return this.getAll().filter(n=>xa(s,n))}notify(s){me.batch(()=>{this.listeners.forEach(n=>{n(s)})})}resumePausedMutations(){const s=this.getAll().filter(n=>n.state.isPaused);return me.batch(()=>Promise.all(s.map(n=>n.continue().catch(je))))}},Je=new WeakMap,Ne=new WeakMap,ws=new WeakMap,Ba);function zs(e){var s;return(s=e.options.scope)==null?void 0:s.id}var Ye,mt,Ce,Xe,st,Us,An,Ua,Ao=(Ua=class extends ds{constructor(n,a){super();L(this,st);L(this,Ye);L(this,mt);L(this,Ce);L(this,Xe);M(this,Ye,n),this.setOptions(a),this.bindMethods(),U(this,st,Us).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const a=this.options;this.options=p(this,Ye).defaultMutationOptions(n),Qs(this.options,a)||p(this,Ye).getMutationCache().notify({type:"observerOptionsUpdated",mutation:p(this,Ce),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&At(a.mutationKey)!==At(this.options.mutationKey)?this.reset():((r=p(this,Ce))==null?void 0:r.state.status)==="pending"&&p(this,Ce).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=p(this,Ce))==null||n.removeObserver(this)}onMutationUpdate(n){U(this,st,Us).call(this),U(this,st,An).call(this,n)}getCurrentResult(){return p(this,mt)}reset(){var n;(n=p(this,Ce))==null||n.removeObserver(this),M(this,Ce,void 0),U(this,st,Us).call(this),U(this,st,An).call(this)}mutate(n,a){var r;return M(this,Xe,a),(r=p(this,Ce))==null||r.removeObserver(this),M(this,Ce,p(this,Ye).getMutationCache().build(p(this,Ye),this.options)),p(this,Ce).addObserver(this),p(this,Ce).execute(n)}},Ye=new WeakMap,mt=new WeakMap,Ce=new WeakMap,Xe=new WeakMap,st=new WeakSet,Us=function(){var a;const n=((a=p(this,Ce))==null?void 0:a.state)??Rr();M(this,mt,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},An=function(n){me.batch(()=>{var a,r,i,l,o,d,u,c;if(p(this,Xe)&&this.hasListeners()){const h=p(this,mt).variables,y=p(this,mt).context,f={client:p(this,Ye),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(r=(a=p(this,Xe)).onSuccess)==null||r.call(a,n.data,h,y,f)}catch(g){Promise.reject(g)}try{(l=(i=p(this,Xe)).onSettled)==null||l.call(i,n.data,null,h,y,f)}catch(g){Promise.reject(g)}}else if((n==null?void 0:n.type)==="error"){try{(d=(o=p(this,Xe)).onError)==null||d.call(o,n.error,h,y,f)}catch(g){Promise.reject(g)}try{(c=(u=p(this,Xe)).onSettled)==null||c.call(u,void 0,n.error,h,y,f)}catch(g){Promise.reject(g)}}}this.listeners.forEach(h=>{h(p(this,mt))})})},Ua),Ue,Va,Oo=(Va=class extends ds{constructor(s={}){super();L(this,Ue);this.config=s,M(this,Ue,new Map)}build(s,n,a){const r=n.queryKey,i=n.queryHash??Jn(r,n);let l=this.get(i);return l||(l=new Io({client:s,queryKey:r,queryHash:i,options:s.defaultQueryOptions(n),state:a,defaultOptions:s.getQueryDefaults(r)}),this.add(l)),l}add(s){p(this,Ue).has(s.queryHash)||(p(this,Ue).set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const n=p(this,Ue).get(s.queryHash);n&&(s.destroy(),n===s&&p(this,Ue).delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){me.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return p(this,Ue).get(s)}getAll(){return[...p(this,Ue).values()]}find(s){const n={exact:!0,...s};return this.getAll().find(a=>ga(n,a))}findAll(s={}){const n=this.getAll();return Object.keys(s).length>0?n.filter(a=>ga(s,a)):n}notify(s){me.batch(()=>{this.listeners.forEach(n=>{n(s)})})}onFocus(){me.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){me.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},Ue=new WeakMap,Va),oe,pt,ft,Gt,Jt,yt,Yt,Xt,Wa,zo=(Wa=class{constructor(e={}){L(this,oe);L(this,pt);L(this,ft);L(this,Gt);L(this,Jt);L(this,yt);L(this,Yt);L(this,Xt);M(this,oe,e.queryCache||new Oo),M(this,pt,e.mutationCache||new Mo),M(this,ft,e.defaultOptions||{}),M(this,Gt,new Map),M(this,Jt,new Map),M(this,yt,0)}mount(){Ms(this,yt)._++,p(this,yt)===1&&(M(this,Yt,Zn.subscribe(async e=>{e&&(await this.resumePausedMutations(),p(this,oe).onFocus())})),M(this,Xt,Gs.subscribe(async e=>{e&&(await this.resumePausedMutations(),p(this,oe).onOnline())})))}unmount(){var e,s;Ms(this,yt)._--,p(this,yt)===0&&((e=p(this,Yt))==null||e.call(this),M(this,Yt,void 0),(s=p(this,Xt))==null||s.call(this),M(this,Xt,void 0))}isFetching(e){return p(this,oe).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return p(this,pt).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const s=this.defaultQueryOptions({queryKey:e});return(n=p(this,oe).get(s.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const s=this.defaultQueryOptions(e),n=p(this,oe).build(this,s),a=n.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(xt(s.staleTime,n))&&this.prefetchQuery(s),Promise.resolve(a))}getQueriesData(e){return p(this,oe).findAll(e).map(({queryKey:s,state:n})=>{const a=n.data;return[s,a]})}setQueryData(e,s,n){const a=this.defaultQueryOptions({queryKey:e}),r=p(this,oe).get(a.queryHash),i=r==null?void 0:r.state.data,l=yo(s,i);if(l!==void 0)return p(this,oe).build(this,a).setData(l,{...n,manual:!0})}setQueriesData(e,s,n){return me.batch(()=>p(this,oe).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,s,n)]))}getQueryState(e){var n;const s=this.defaultQueryOptions({queryKey:e});return(n=p(this,oe).get(s.queryHash))==null?void 0:n.state}removeQueries(e){const s=p(this,oe);me.batch(()=>{s.findAll(e).forEach(n=>{s.remove(n)})})}resetQueries(e,s){const n=p(this,oe);return me.batch(()=>(n.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},s)))}cancelQueries(e,s={}){const n={revert:!0,...s},a=me.batch(()=>p(this,oe).findAll(e).map(r=>r.cancel(n)));return Promise.all(a).then(je).catch(je)}invalidateQueries(e,s={}){return me.batch(()=>(p(this,oe).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},s)))}refetchQueries(e,s={}){const n={...s,cancelRefetch:s.cancelRefetch??!0},a=me.batch(()=>p(this,oe).findAll(e).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(je)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(a).then(je)}fetchQuery(e){const s=this.defaultQueryOptions(e);s.retry===void 0&&(s.retry=!1);const n=p(this,oe).build(this,s);return n.isStaleByTime(xt(s.staleTime,n))?n.fetch(s):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(je).catch(je)}fetchInfiniteQuery(e){return e.behavior=Ca(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(je).catch(je)}ensureInfiniteQueryData(e){return e.behavior=Ca(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Gs.isOnline()?p(this,pt).resumePausedMutations():Promise.resolve()}getQueryCache(){return p(this,oe)}getMutationCache(){return p(this,pt)}getDefaultOptions(){return p(this,ft)}setDefaultOptions(e){M(this,ft,e)}setQueryDefaults(e,s){p(this,Gt).set(At(e),{queryKey:e,defaultOptions:s})}getQueryDefaults(e){const s=[...p(this,Gt).values()],n={};return s.forEach(a=>{bs(e,a.queryKey)&&Object.assign(n,a.defaultOptions)}),n}setMutationDefaults(e,s){p(this,Jt).set(At(e),{mutationKey:e,defaultOptions:s})}getMutationDefaults(e){const s=[...p(this,Jt).values()],n={};return s.forEach(a=>{bs(e,a.mutationKey)&&Object.assign(n,a.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const s={...p(this,ft).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return s.queryHash||(s.queryHash=Jn(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===Yn&&(s.enabled=!1),s}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...p(this,ft).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){p(this,oe).clear(),p(this,pt).clear()}},oe=new WeakMap,pt=new WeakMap,ft=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,yt=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,Wa),Pr=m.createContext(void 0),qe=e=>{const s=m.useContext(Pr);if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},Lo=({client:e,children:s})=>(m.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(Pr.Provider,{value:e,children:s})),Tr=m.createContext(!1),No=()=>m.useContext(Tr);Tr.Provider;function Do(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var $o=m.createContext(Do()),qo=()=>m.useContext($o),Ko=(e,s,n)=>{const a=n!=null&&n.state.error&&typeof e.throwOnError=="function"?Xn(e.throwOnError,[n.state.error,n]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||a)&&(s.isReset()||(e.retryOnMount=!1))},Bo=e=>{m.useEffect(()=>{e.clearReset()},[e])},Uo=({result:e,errorResetBoundary:s,throwOnError:n,query:a,suspense:r})=>e.isError&&!s.isReset()&&!e.isFetching&&a&&(r&&e.data===void 0||Xn(n,[e.error,a])),Vo=e=>{if(e.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),a=e.staleTime;e.staleTime=typeof a=="function"?(...r)=>n(a(...r)):n(a),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Wo=(e,s)=>e.isLoading&&e.isFetching&&!s,Ho=(e,s)=>(e==null?void 0:e.suspense)&&s.isPending,Ia=(e,s,n)=>s.fetchOptimistic(e).catch(()=>{n.clearReset()});function Qo(e,s,n){var y,f,g,v;const a=No(),r=qo(),i=qe(),l=i.defaultQueryOptions(e);(f=(y=i.getDefaultOptions().queries)==null?void 0:y._experimental_beforeQuery)==null||f.call(y,l);const o=i.getQueryCache().get(l.queryHash);l._optimisticResults=a?"isRestoring":"optimistic",Vo(l),Ko(l,r,o),Bo(r);const d=!i.getQueryCache().get(l.queryHash),[u]=m.useState(()=>new s(i,l)),c=u.getOptimisticResult(l),h=!a&&e.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(b=>{const _=h?u.subscribe(me.batchCalls(b)):je;return u.updateResult(),_},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),m.useEffect(()=>{u.setOptions(l)},[l,u]),Ho(l,c))throw Ia(l,u,r);if(Uo({result:c,errorResetBoundary:r,throwOnError:l.throwOnError,query:o,suspense:l.suspense}))throw c.error;if((v=(g=i.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||v.call(g,l,c),l.experimental_prefetchInRender&&!Mt&&Wo(c,a)){const b=d?Ia(l,u,r):o==null?void 0:o.promise;b==null||b.catch(je).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function B(e,s){return Qo(e,Ro)}function fe(e,s){const n=qe(),[a]=m.useState(()=>new Ao(n,e));m.useEffect(()=>{a.setOptions(e)},[a,e]);const r=m.useSyncExternalStore(m.useCallback(l=>a.subscribe(me.batchCalls(l)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=m.useCallback((l,o)=>{a.mutate(l,o).catch(je)},[a]);if(r.error&&Xn(a.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fr=(...e)=>e.filter((s,n,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===n).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Jo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=m.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:i,iconNode:l,...o},d)=>m.createElement("svg",{ref:d,...Jo,width:s,height:s,stroke:e,strokeWidth:a?Number(n)*24/Number(s):n,className:Fr("lucide",r),...o},[...l.map(([u,c])=>m.createElement(u,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=(e,s)=>{const n=m.forwardRef(({className:a,...r},i)=>m.createElement(Yo,{ref:i,iconNode:s,className:Fr(`lucide-${Go(e)}`,a),...r}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=X("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=X("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=X("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=X("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=X("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=X("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=X("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=X("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=X("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=X("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=X("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=X("GitGraph",[["circle",{cx:"5",cy:"6",r:"3",key:"1qnov2"}],["path",{d:"M5 9v6",key:"158jrl"}],["circle",{cx:"5",cy:"18",r:"3",key:"104gr9"}],["path",{d:"M12 3v18",key:"108xh3"}],["circle",{cx:"19",cy:"6",r:"3",key:"108a5v"}],["path",{d:"M16 15.7A9 9 0 0 0 19 9",key:"1e3vqb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=X("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=X("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=X("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=X("MonitorPlay",[["path",{d:"M10 7.75a.75.75 0 0 1 1.142-.638l3.664 2.249a.75.75 0 0 1 0 1.278l-3.664 2.25a.75.75 0 0 1-1.142-.64z",key:"1pctta"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",key:"x3v2xh"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oc=X("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=X("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=X("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=X("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=X("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=X("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=X("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=X("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=X("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=X("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=X("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=X("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=X("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=X("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=X("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),De={width:16,height:16,strokeWidth:1.8},gc=[{key:"/projects",icon:t.jsx(Ar,{...De}),label:"Projects"},{key:"/tasks",icon:t.jsx(Or,{...De}),label:"Tasks"},{key:"/runs",icon:t.jsx(an,{...De}),label:"Runs"},{key:"/issues",icon:t.jsx(Er,{...De}),label:"Issues"},{key:"/kpi",icon:t.jsx(Mr,{...De}),label:"KPI Dashboard"},{key:"/traceability",icon:t.jsx(rc,{...De}),label:"Traceability"}],xc=[{key:"/fleet",icon:t.jsx(fc,{...De}),label:"Fleet Overview"},{key:"/fleet/trajectory",icon:t.jsx(uc,{...De}),label:"Trajectory"},{key:"/fleet/issues-map",icon:t.jsx(zr,{...De}),label:"Issue Map"}],vc=[{key:"/simulation",icon:t.jsx(oc,{...De}),label:"Simulation"}],jc=[{key:"/auto-triage",icon:t.jsx(hc,{...De}),label:t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:["Auto-Triage",t.jsx(Ha,{count:"WIP",style:{backgroundColor:"var(--accent-soft)",color:"var(--text-secondary)",fontSize:9,fontWeight:600,boxShadow:"none",letterSpacing:"0.02em",fontFamily:"var(--font-mono)",borderRadius:6}})]})}],Ra={padding:"6px 24px 2px",fontSize:"0.68rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.08em",fontFamily:"var(--font-body)",fontWeight:600},fn={height:1,background:"var(--glass-border)",margin:"8px 16px"};function bc(){const e=He(),s=zt(),n=e.pathname.split("/").filter(Boolean),a=n[0]==="fleet"&&n.length>1?`/${n[0]}/${n[1]}`:"/"+n[0],r=({key:i})=>{s(i)};return t.jsxs("div",{className:"glass-sidebar",style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[t.jsxs("div",{className:"sidebar-brand",children:[t.jsx("div",{className:"sidebar-logo",children:"N"}),t.jsx("span",{className:"sidebar-title",children:"Nvidopia"})]}),t.jsxs("div",{style:{flex:1,paddingTop:6,overflow:"auto"},children:[t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[a],onClick:r,items:gc,style:{borderInlineEnd:"none"}}),t.jsx("div",{style:fn}),t.jsx("div",{style:Ra,children:"Fleet"}),t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[a],onClick:r,items:xc,style:{borderInlineEnd:"none"}}),t.jsx("div",{style:fn}),t.jsx("div",{style:Ra,children:"Simulation"}),t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[a],onClick:r,items:vc,style:{borderInlineEnd:"none"}}),t.jsx("div",{style:fn}),t.jsx(As,{mode:"inline",theme:"dark",selectedKeys:[a],onClick:r,items:jc,style:{borderInlineEnd:"none"}})]}),t.jsx("div",{className:"sidebar-footer",children:t.jsxs("div",{className:"sidebar-footer-text",children:["nvidopia ",t.jsx("span",{style:{color:"var(--text-muted)"},children:"v0.1"})]})})]})}const{Content:Sc}=si,kc={projects:"Projects",tasks:"Tasks",runs:"Runs",issues:"Issues",kpi:"KPI Dashboard",traceability:"Traceability","auto-triage":"Auto-Triage",simulation:"Simulation",fleet:"Fleet",vehicles:"Vehicle",trajectory:"Trajectory","issues-map":"Issue Map"};function _c(){const{pathname:e}=He(),s=e.split("/").filter(Boolean),n=[{title:t.jsx(ss,{to:"/",children:t.jsx(ic,{size:15,strokeWidth:2})})},...s.map((a,r)=>{const i="/"+s.slice(0,r+1).join("/"),l=kc[a]??a;return{title:r===s.length-1?t.jsx("span",{children:l}):t.jsx(ss,{to:i,children:l})}})];return t.jsx(ni,{items:n})}function Cc(){return t.jsxs("div",{style:{display:"flex",minHeight:"100vh",position:"relative",zIndex:1},children:[t.jsx("div",{style:{position:"fixed",left:16,top:16,bottom:16,width:260,zIndex:20},children:t.jsx(bc,{})}),t.jsxs("div",{style:{marginLeft:292,flex:1,display:"flex",flexDirection:"column"},children:[t.jsx("header",{className:"glass-header",style:{position:"sticky",top:0,zIndex:10,display:"flex",alignItems:"center",padding:"0 32px",height:56},children:t.jsx(_c,{})}),t.jsx(Sc,{style:{padding:32,minHeight:"calc(100vh - 56px)"},children:t.jsx("div",{className:"animate-fade-in",children:t.jsx(Tl,{})})})]})]})}const wc="/api";class Ic extends Error{constructor(s,n){super(n),this.status=s,this.name="ApiError"}}function Y(e,s=""){return typeof e=="string"?e:s}function V(e){return typeof e=="string"?e:void 0}function Ze(e){return typeof e=="number"?e:void 0}function rn(e,s){const n={};for(const[a,r]of Object.entries(e))!s.has(a)&&!a.startsWith("_")&&(n[a]=r);return e.extra&&typeof e.extra=="object"&&Object.assign(n,e.extra),n}const Rc=new Set(["id","project_id","name","description","status","vehicle_platform","soc_architecture","sensor_suite_version","software_baseline_version","target_mileage_km","start_date","end_date","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function qr(e){return{id:Y(e.id??e.project_id),name:Y(e.name,"Unnamed Project"),description:V(e.description),status:Y(e.status,"Planning"),vehicle_platform:V(e.vehicle_platform),soc_architecture:V(e.soc_architecture),sensor_suite_version:V(e.sensor_suite_version),software_baseline_version:V(e.software_baseline_version),target_mileage_km:Ze(e.target_mileage_km),start_date:V(e.start_date),extra:rn(e,Rc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}const Pc=new Set(["id","task_id","project_id","projectId","name","title","description","stage","status","task_type","taskType","priority","assignee","assigned_to","execution_region","executionRegion","target_vehicle_count","targetVehicleCount","simulation_ref","simulation_status","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Kr(e){return{id:Y(e.id??e.task_id),projectId:Y(e.projectId??e.project_id),title:Y(e.title??e.name??e.task_id,"Untitled Task"),description:V(e.description),stage:Y(e.stage??e.status,"Pending"),taskType:V(e.task_type??e.taskType),priority:Y(e.priority,"Medium"),assignee:V(e.assignee??e.assigned_to),executionRegion:V(e.execution_region??e.executionRegion),targetVehicleCount:Ze(e.target_vehicle_count??e.targetVehicleCount),extra:rn(e,Pc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}const Tc=new Set(["id","run_id","task_id","taskId","vehicle_vin","vehicleIds","driver_id","start_time","startedAt","end_time","completedAt","total_auto_mileage_km","software_version_hash","hardware_heartbeat_version","status","result","simulation_ref","simulation_status","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Br(e){const s=V(e.vehicle_vin);return{id:Y(e.id??e.run_id),taskId:Y(e.taskId??e.task_id),status:Y(e.status,"Scheduled"),vehicleIds:Array.isArray(e.vehicleIds)?e.vehicleIds:s?[s]:[],startedAt:V(e.startedAt??e.start_time),completedAt:V(e.completedAt??e.end_time),totalAutoMileageKm:Ze(e.total_auto_mileage_km),result:V(e.result),extra:rn(e,Tc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}const Fc=new Set(["id","issue_id","run_id","runId","task_id","taskId","title","description","status","severity","category","assignee","assigned_to","module","assigned_module","takeover_type","takeoverType","gps_coordinates","gps_lat","gps_lng","data_snapshot_uri","data_snapshot_url","trigger_timestamp","fault_codes","environment_tags","triage_mode","triage_hint","triage_source","fix_commit_id","fix_version_hash","rejection_reason","vehicle_dynamics","extra","createdAt","created_at","updatedAt","updated_at","__v"]);function Ur(e){const s=Y(e.id??e.issue_id),n=V(e.category),a=e.gps_coordinates;return{id:s,title:Y(e.title,n?`${n} (${s})`:`Issue ${s}`),description:V(e.description),status:Y(e.status,"New"),severity:Y(e.severity,"Medium"),category:n,runId:V(e.runId??e.run_id),taskId:V(e.taskId??e.task_id),assignee:V(e.assignee??e.assigned_to),module:V(e.module??e.assigned_module),takeoverType:V(e.takeover_type??e.takeoverType),gpsLat:Ze(e.gps_lat)??Ze(a==null?void 0:a.lat),gpsLng:Ze(e.gps_lng)??Ze(a==null?void 0:a.lng),dataSnapshotUri:V(e.data_snapshot_uri??e.data_snapshot_url),triggerTimestamp:V(e.trigger_timestamp),faultCodes:Array.isArray(e.fault_codes)?e.fault_codes:void 0,environmentTags:Array.isArray(e.environment_tags)?e.environment_tags:void 0,triageMode:V(e.triage_mode),triageHint:V(e.triage_hint),fixCommitId:V(e.fix_commit_id),rejectionReason:V(e.rejection_reason),vehicleDynamics:e.vehicle_dynamics,extra:rn(e,Fc),createdAt:Y(e.createdAt??e.created_at,new Date().toISOString()),updatedAt:Y(e.updatedAt??e.updated_at,new Date().toISOString())}}function Ec(e){return{id:Y(e.id??e.transition_id),fromStatus:Y(e.from_status??e.fromStatus??e.from),toStatus:Y(e.to_status??e.toStatus??e.to),triggeredBy:Y(e.triggered_by??e.triggeredBy),transitionedAt:V(e.transitioned_at??e.created_at),reason:V(e.reason)}}async function D(e,s){const n=await fetch(`${wc}${e}`,{...s,headers:{"Content-Type":"application/json",...s==null?void 0:s.headers}});if(!n.ok){const a=await n.text().catch(()=>"");throw new Ic(n.status,a||n.statusText)}if(n.status!==204)return n.json()}function ge(e){if(!e)return"";const s={projectId:"project_id",taskId:"task_id",runId:"run_id",vehicleVin:"vehicle_vin",startDate:"start_date",endDate:"end_date",timeRange:"time_range"},n=Object.fromEntries(Object.entries(e).filter(([,r])=>r!==void 0&&r!=="").map(([r,i])=>[s[r]??r,i])),a=new URLSearchParams(n).toString();return a?`?${a}`:""}async function us(e){const s=ge(e),n=await D(`/projects${s}`);return(Array.isArray(n)?n:n.data??n.items??[]).map(r=>qr(r))}function Vr(e){return D(`/projects/${e}`).then(qr)}function Mc(e){return D("/projects",{method:"POST",body:JSON.stringify(e)})}function Ac(e,s){return D(`/projects/${e}`,{method:"PUT",body:JSON.stringify(s)})}async function Ps(e){const s=ge(e),n=await D(`/tasks${s}`);return(Array.isArray(n)?n:n.data??[]).map(r=>Kr(r))}function Oc(e){return D(`/tasks/${e}`).then(Kr)}function zc(e){return D("/tasks",{method:"POST",body:JSON.stringify(e)})}function Lc(e){return D(`/tasks/${e}/advance-stage`,{method:"PUT"})}async function Ts(e){const s=ge(e),n=await D(`/runs${s}`);return(Array.isArray(n)?n:n.data??[]).map(r=>Br(r))}function Nc(e){return D(`/runs/${e}`).then(Br)}function Wr(e){return{id:Y(e.vin??e._id??e.id),vin:Y(e.vin),name:Y(e.vin??e.name,"Unknown"),status:Y(e.current_status??e.status,"Offline"),platform:V(e.vehicle_platform??e.platform),plateType:V(e.plate_type),modelCode:V(e.model_code),socArchitecture:V(e.soc_architecture),sensorSuiteVersion:V(e.sensor_suite_version),componentVersions:e.component_versions,currentSpeed:Ze(e.current_speed_mps),drivingMode:V(e.driving_mode),currentLocation:e.current_location,fuelOrBatteryLevel:Ze(e.fuel_or_battery_level),lastHeartbeat:V(e.last_heartbeat),updatedAt:V(e.updated_at??e.updatedAt)}}async function ta(e){const s=ge(e),n=await D(`/vehicles${s}`);return(Array.isArray(n)?n:n.data??[]).map(r=>Wr(r))}function Dc(e){return D(`/vehicles/${e}`).then(Wr)}function $c(e,s){return D(`/vehicles/${e}/status-distribution${ge(s)}`)}function qc(e,s){return D(`/vehicles/${e}/trajectory${ge(s)}`)}function Kc(){return D("/fleet/distribution")}function Bc(){return D("/fleet/status-distribution")}function Uc(e){return D(`/trajectory/query${ge(e)}`)}function Vc(e){return D(`/trajectory/issues${ge(e)}`)}async function Wc(e){const s=ge(e),n=await D(`/issues${s}`);return(Array.isArray(n)?n:n.data??[]).map(r=>Ur(r))}function Hc(e){return D(`/issues/${e}`).then(Ur)}function Qc(e,s){return D(`/issues/${e}/transition`,{method:"PUT",body:JSON.stringify(s)})}function Gc(e,s){return D(`/issues/${e}/triage`,{method:"POST",body:JSON.stringify({assigned_to:s.assignee,assigned_module:s.module,triggered_by:s.triggered_by??"ui-user"})})}async function Jc(e){const s=await D(`/issues/${e}/transitions`);return{items:(Array.isArray(s)?s:s.items??[]).map(Ec)}}function Yc(e){return D(`/traceability/forward/${e}`)}function Xc(e){return D(`/traceability/backward/${e}`)}const Zc=Yc,ed=Xc;function td(e){return D("/traceability/coverage").then(s=>({total:Number(s.total??s.total_requirements??0),covered:Number(s.covered??s.covered_requirements??0),percentage:Number(s.percentage??s.coverage_percentage??0),details:Array.isArray(s.details)?s.details:[]}))}function sd(e){return D(`/kpi/mpi${ge(e)}`)}function nd(e){return D(`/kpi/mttr${ge(e)}`)}function ad(e){return D(`/kpi/regression-pass-rate${ge(e)}`)}function rd(e){return D(`/kpi/fleet-utilization${ge(e)}`)}function id(e){return D(`/kpi/issue-convergence${ge(e)}`).then(s=>{const n=Array.isArray(s.series)?s.series:[];return{value:Number(s.value??0),unit:Y(s.unit,""),points:n.map(a=>({timestamp:Y(a.date),value:Number(a.new_issues??0),dimensions:{open_count:Number(a.new_issues??0),closed_count:Number(a.closed_issues??0)}})),...s}})}function ld(e){return D(`/issues/${e}/snapshot`)}function od(e){return D(`/issues/${e}/timeseries`)}function cd(e){const s=e?`/schema/fields/${e}`:"/schema/fields";return D(s)}function dd(){return D("/kpi/definitions")}function ud(e){return D("/kpi/definitions",{method:"POST",body:JSON.stringify(e)})}function hd(e,s){return D(`/kpi/definitions/${e}`,{method:"PUT",body:JSON.stringify(s)})}function md(e){return D(`/kpi/definitions/${e}`,{method:"DELETE"})}function pd(e,s){return D(`/kpi/custom/${e}/evaluate${ge(s)}`)}function fd(e){return D("/kpi/custom/preview",{method:"POST",body:JSON.stringify(e)})}function yd(e){return D("/kpi/definitions/import",{method:"POST",body:JSON.stringify(e)})}function gd(e){return D(`/simulations${ge(e)}`)}function xd(e){return D(`/simulations/${e}`)}function vd(e){return D("/simulations",{method:"POST",body:JSON.stringify(e)})}function jd(e){return D(`/simulations/${e}`,{method:"DELETE"})}function zn(e){return D(`/simulations/${e}/start`,{method:"POST"})}function bd(e){return D(`/simulations/${e}/pause`,{method:"POST"})}function Sd(e){return D(`/simulations/${e}/resume`,{method:"POST"})}function kd(e){return D(`/simulations/${e}/stop`,{method:"POST"})}function _d(e){return D(`/simulations/${e}/stats`)}function Cd(e,s=30){return D(`/simulations/${e}/vehicles?tail=${s}`)}function wd(e){return D("/simulations/generate-routes",{method:"POST",body:JSON.stringify(e)})}function Id(e){return D("/simulations/generate-fleet",{method:"POST",body:JSON.stringify(e)})}function Rd(e){return D("/simulations/snap-routes",{method:"POST",body:JSON.stringify({routes:e})})}const Ee={Planning:"blue",Active:"purple",Completed:"green",Archived:"default",Frozen:"cyan",Pending:"default",InProgress:"gold",Cancelled:"default",Scheduled:"blue",Aborted:"red",New:"blue",Triage:"purple",Assigned:"geekblue",Fixed:"green",RegressionTracking:"cyan",Closed:"default",Reopened:"orange",Rejected:"red",backlog:"default",ready:"blue","in-progress":"gold",review:"purple",done:"green",pending:"default",queued:"blue",running:"gold",passed:"green",failed:"red",cancelled:"default",open:"blue",triaged:"purple",fixed:"green",verified:"cyan",closed:"default","wont-fix":"red",duplicate:"default"},Ys={Pending:"default",Smoke:"cyan",Gray:"gold",Freeze:"orange",GoLive:"green",backlog:"default",ready:"blue","in-progress":"gold",review:"purple",done:"green"},Xs={Critical:"red",High:"orange",Medium:"gold",Low:"blue",critical:"red",high:"orange",medium:"gold",low:"blue"},Hr={Blocker:"red",Critical:"red",High:"orange",Medium:"gold",Low:"blue",Trivial:"green",blocker:"red",critical:"red",high:"orange",medium:"gold",low:"blue",trivial:"green",Minor:"gold",Major:"orange"},Pd={Triage:"gold",Assigned:"geekblue",InProgress:"purple",Fixed:"green",RegressionTracking:"cyan",Closed:"default",Reopened:"orange",Rejected:"red"};function rt({title:e,subtitle:s,action:n}){return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:e}),s&&t.jsx("p",{className:"page-subtitle",children:s})]}),n]})}function We({to:e,children:s,mono:n,style:a}){return t.jsx(ss,{to:e,style:{color:"var(--text-primary)",fontWeight:500,transition:"color 0.2s ease",...n?{fontFamily:"var(--font-mono)"}:{},...a},children:s})}function Td(){const[e,s]=m.useState(""),[n,a]=m.useState(),[r,i]=m.useState(!1),[l]=N.useForm(),o=qe(),{data:d,isLoading:u}=B({queryKey:["projects"],queryFn:()=>us()}),c=fe({mutationFn:f=>{var v;const g=`PROJ-${crypto.randomUUID().slice(0,6).toUpperCase()}`;return Mc({project_id:g,name:f.name,vehicle_platform:f.vehicle_platform,soc_architecture:f.soc_architecture,sensor_suite_version:f.sensor_suite_version,software_baseline_version:f.software_baseline_version,start_date:(v=f.start_date)==null?void 0:v.toISOString(),target_mileage_km:f.target_mileage_km,status:f.status??"Planning"})},onSuccess:()=>{o.invalidateQueries({queryKey:["projects"]}),i(!1),l.resetFields(),Z.success("Project created")},onError:f=>{Z.error(f.message||"Failed to create project")}}),h=d==null?void 0:d.filter(f=>!(e&&!f.name.toLowerCase().includes(e.toLowerCase())||n&&f.status!==n)),y=[{title:"Name",dataIndex:"name",key:"name",render:(f,g)=>t.jsx(We,{to:`/projects/${g.id}`,children:f})},{title:"Status",dataIndex:"status",key:"status",width:130,render:f=>t.jsx(K,{color:Ee[f]??"default",children:f})},{title:"Created",dataIndex:"createdAt",key:"createdAt",width:140,render:f=>new Date(f).toLocaleDateString()},{title:"Updated",dataIndex:"updatedAt",key:"updatedAt",width:140,render:f=>new Date(f).toLocaleDateString()}];return t.jsxs("div",{children:[t.jsx(rt,{title:"Projects",subtitle:"Manage autonomous driving test projects",action:t.jsx(q,{type:"primary",icon:t.jsx($t,{}),size:"large",onClick:()=>i(!0),children:"New Project"})}),t.jsxs(H,{direction:"vertical",size:16,style:{width:"100%"},children:[t.jsxs(H,{wrap:!0,children:[t.jsx(J,{placeholder:"Search projects...",prefix:t.jsx(Zs,{style:{color:"var(--text-muted)"}}),value:e,onChange:f=>s(f.target.value),allowClear:!0,style:{width:280}}),t.jsx(ee,{placeholder:"Filter by status",allowClear:!0,value:n,onChange:a,style:{width:160},options:[{value:"Planning",label:"Planning"},{value:"Active",label:"Active"},{value:"Frozen",label:"Frozen"},{value:"Completed",label:"Completed"},{value:"Archived",label:"Archived"}]})]}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:y,dataSource:h,rowKey:"id",loading:u,pagination:{pageSize:15,showSizeChanger:!1},locale:{emptyText:t.jsx(le,{image:t.jsx(Ar,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No projects yet. Create your first project to get started."})})}})})]}),t.jsx(as,{title:"New Project",open:r,onCancel:()=>i(!1),onOk:()=>l.submit(),confirmLoading:c.isPending,okText:"Create",width:600,children:t.jsxs(N,{form:l,layout:"vertical",onFinish:f=>c.mutate(f),children:[t.jsx(N.Item,{name:"name",label:"Project Name",rules:[{required:!0,message:"Please enter project name"}],children:t.jsx(J,{placeholder:"e.g. V2.0 Urban Pilot"})}),t.jsx(N.Item,{name:"vehicle_platform",label:"Vehicle Platform",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. EP40"})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"soc_architecture",label:"SoC Architecture",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. Orin-X Dual"})}),t.jsx(N.Item,{name:"sensor_suite_version",label:"Sensor Suite Version",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. SS-4.0"})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"software_baseline_version",label:"SW Baseline Version",rules:[{required:!0}],children:t.jsx(J,{placeholder:"e.g. v3.1.0-rc1"})}),t.jsx(N.Item,{name:"start_date",label:"Start Date",rules:[{required:!0}],children:t.jsx(xs,{style:{width:"100%"}})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"target_mileage_km",label:"Target Mileage (km)",children:t.jsx(we,{min:0,style:{width:"100%"},placeholder:"Optional"})}),t.jsx(N.Item,{name:"status",label:"Initial Status",initialValue:"Planning",children:t.jsx(ee,{options:[{value:"Planning",label:"Planning"},{value:"Active",label:"Active"}]})})]})]})})]})}function Fs(){return t.jsx("div",{style:{display:"flex",justifyContent:"center",padding:80},children:t.jsx(Ot,{size:"large"})})}function sa({entity:e}){return t.jsx(le,{description:`${e} not found`,style:{padding:80}})}function he(){return t.jsx("span",{style:{color:"var(--text-muted)"},children:"â€”"})}function et({children:e}){return t.jsx("span",{className:"font-display",style:{fontWeight:600},children:e})}function Fd({icon:e,iconColor:s,title:n,description:a,features:r,featuresLabel:i="Planned Features"}){return t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:t.jsxs(z,{className:"glass-panel-elevated",style:{maxWidth:480,width:"100%",textAlign:"center",padding:"20px 0"},children:[t.jsx("div",{style:{width:72,height:72,borderRadius:20,background:`${s}1f`,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",boxShadow:`0 0 24px ${s}33`},children:t.jsx(e,{size:36,style:{color:s}})}),t.jsx("h1",{style:{fontFamily:"var(--font-mono)",fontSize:"1.3rem",fontWeight:700,color:"var(--text-primary)",margin:0,textTransform:"uppercase",letterSpacing:"0.03em"},children:n}),t.jsx("p",{style:{fontSize:16,fontWeight:600,color:s,marginTop:4},children:"Coming Soon"}),t.jsx("p",{style:{color:"var(--text-secondary)",fontSize:14,lineHeight:1.7,marginTop:16,padding:"0 12px"},children:a}),t.jsxs("div",{style:{textAlign:"left",padding:"0 24px",marginTop:32},children:[t.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.06em",marginBottom:16},children:i}),t.jsx(H,{direction:"vertical",size:12,style:{width:"100%"},children:r.map(l=>t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx(On,{size:16,style:{color:"var(--text-muted)",opacity:.4,flexShrink:0}}),t.jsx("span",{style:{color:"var(--text-secondary)",fontSize:14},children:l})]},l))})]})]})})}class Ed extends m.Component{constructor(){super(...arguments);la(this,"state",{hasError:!1})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,a){console.error("[ErrorBoundary]",n,a.componentStack)}render(){var n;return this.state.hasError?t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:t.jsx(ai,{status:"error",title:"Something went wrong",subTitle:((n=this.state.error)==null?void 0:n.message)??"An unexpected error occurred",extra:t.jsx(q,{type:"primary",onClick:()=>{this.setState({hasError:!1,error:void 0}),window.location.reload()},children:"Reload Page"})})}):this.props.children}}function na(e,s,n){const{data:a,isLoading:r,error:i}=B({queryKey:[e,s],queryFn:()=>n(s),enabled:!!s});return{data:a,isLoading:r,error:i}}const Md={Planning:["Active"],Active:["Frozen","Completed"],Frozen:["Active","Completed"],Completed:["Archived"],Archived:[]};function Ad(){const{id:e}=cs(),s=qe(),{data:n,isLoading:a}=na("project",e,Vr),{data:r}=B({queryKey:["tasks",{projectId:e}],queryFn:()=>Ps({projectId:e}),enabled:!!e}),i=fe({mutationFn:d=>Ac(e,{status:d}),onSuccess:()=>{s.invalidateQueries({queryKey:["project",e]}),s.invalidateQueries({queryKey:["projects"]}),Z.success("Status updated")},onError:d=>Z.error(d.message||"Failed to update status")});if(a)return t.jsx(Fs,{});if(!n)return t.jsx(sa,{entity:"Project"});const l=Md[n.status]??[],o=[{title:"Title",dataIndex:"title",key:"title",render:(d,u)=>t.jsx(We,{to:`/tasks/${u.id}`,children:d})},{title:"Stage",dataIndex:"stage",key:"stage",width:120,render:d=>t.jsx(K,{color:Ys[d]??"default",children:d})},{title:"Priority",dataIndex:"priority",key:"priority",width:110,render:d=>t.jsx(K,{color:Xs[d]??"default",children:d})},{title:"Type",dataIndex:"taskType",key:"taskType",width:100,render:d=>d?t.jsx(K,{children:d}):t.jsx(he,{})}];return t.jsxs("div",{children:[t.jsx(rt,{title:n.name,subtitle:n.description??"No description",action:t.jsxs(H,{children:[t.jsx(K,{color:Ee[n.status]??"blue",style:{fontSize:14,padding:"4px 12px"},children:n.status}),l.map(d=>t.jsxs(q,{size:"small",loading:i.isPending,onClick:()=>i.mutate(d),style:{borderColor:"var(--glass-border-light)",color:"var(--text-secondary)"},children:["â†’ ",d]},d))]})}),t.jsxs(re,{gutter:[24,24],children:[t.jsx(O,{xs:24,lg:16,children:t.jsx(z,{title:t.jsx(et,{children:"Tasks"}),className:"glass-panel",extra:t.jsx(We,{to:"/tasks",style:{fontSize:13},children:"View All"}),styles:{body:{padding:0}},children:t.jsx(Se,{columns:o,dataSource:r,rowKey:"id",pagination:!1,locale:{emptyText:t.jsx(le,{description:"No tasks for this project yet"})}})})}),t.jsx(O,{xs:24,lg:8,children:t.jsx(z,{title:t.jsx(et,{children:"Details"}),className:"glass-panel",children:t.jsxs(A,{column:1,size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Ee[n.status]??"blue",children:n.status})}),t.jsx(A.Item,{label:"Vehicle Platform",children:n.vehicle_platform??t.jsx(he,{})}),t.jsx(A.Item,{label:"SoC Architecture",children:n.soc_architecture??t.jsx(he,{})}),t.jsx(A.Item,{label:"Sensor Suite",children:n.sensor_suite_version??t.jsx(he,{})}),t.jsx(A.Item,{label:"SW Baseline",children:n.software_baseline_version??t.jsx(he,{})}),t.jsx(A.Item,{label:"Target Mileage",children:n.target_mileage_km!=null?`${n.target_mileage_km.toLocaleString()} km`:t.jsx(he,{})}),t.jsx(A.Item,{label:"Start Date",children:n.start_date?new Date(n.start_date).toLocaleDateString():t.jsx(he,{})}),t.jsx(A.Item,{label:"Created",children:new Date(n.createdAt).toLocaleString()}),t.jsx(A.Item,{label:"Last Updated",children:new Date(n.updatedAt).toLocaleString()})]})})})]})]})}function Od(){const[e,s]=m.useState(""),[n,a]=m.useState(),[r,i]=m.useState(!1),[l]=N.useForm(),o=qe(),{data:d,isLoading:u}=B({queryKey:["tasks"],queryFn:()=>Ps()}),{data:c}=B({queryKey:["projects"],queryFn:()=>us()}),h=fe({mutationFn:g=>{const v=`TASK-${crypto.randomUUID().slice(0,6).toUpperCase()}`;return zc({task_id:v,project_id:g.project_id,name:g.name,task_type:g.task_type,priority:g.priority??"Medium",execution_region:g.execution_region,target_vehicle_count:g.target_vehicle_count})},onSuccess:()=>{o.invalidateQueries({queryKey:["tasks"]}),i(!1),l.resetFields(),Z.success("Task created")},onError:g=>{Z.error(g.message||"Failed to create task")}}),y=d==null?void 0:d.filter(g=>!(e&&!g.title.toLowerCase().includes(e.toLowerCase())||n&&g.stage!==n)),f=[{title:"Title",dataIndex:"title",key:"title",render:(g,v)=>t.jsx(We,{to:`/tasks/${v.id}`,children:g})},{title:"Stage",dataIndex:"stage",key:"stage",width:130,render:g=>t.jsx(K,{color:Ys[g]??"default",children:g})},{title:"Priority",dataIndex:"priority",key:"priority",width:110,render:g=>t.jsx(K,{color:Xs[g]??"default",children:g})},{title:"Assignee",dataIndex:"assignee",key:"assignee",width:140,render:g=>g??t.jsx(he,{})},{title:"Updated",dataIndex:"updatedAt",key:"updatedAt",width:140,render:g=>new Date(g).toLocaleDateString()}];return t.jsxs("div",{children:[t.jsx(rt,{title:"Tasks",subtitle:"Track test campaign tasks through their lifecycle",action:t.jsx(q,{type:"primary",icon:t.jsx($t,{}),size:"large",onClick:()=>i(!0),children:"New Task"})}),t.jsxs(H,{direction:"vertical",size:16,style:{width:"100%"},children:[t.jsxs(H,{wrap:!0,children:[t.jsx(J,{placeholder:"Search tasks...",prefix:t.jsx(Zs,{style:{color:"var(--text-muted)"}}),value:e,onChange:g=>s(g.target.value),allowClear:!0,style:{width:280}}),t.jsx(ee,{placeholder:"Filter by status",allowClear:!0,value:n,onChange:a,style:{width:160},options:[{value:"Pending",label:"Pending"},{value:"InProgress",label:"In Progress"},{value:"Completed",label:"Completed"},{value:"Cancelled",label:"Cancelled"}]})]}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:f,dataSource:y,rowKey:"id",loading:u,pagination:{pageSize:15,showSizeChanger:!1},locale:{emptyText:t.jsx(le,{image:t.jsx(Or,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No tasks yet. Create tasks to plan and track your test activities."})})}})})]}),t.jsx(as,{title:"New Task",open:r,onCancel:()=>i(!1),onOk:()=>l.submit(),confirmLoading:h.isPending,okText:"Create",width:560,children:t.jsxs(N,{form:l,layout:"vertical",onFinish:g=>h.mutate(g),children:[t.jsx(N.Item,{name:"project_id",label:"Project",rules:[{required:!0,message:"Please select a project"}],children:t.jsx(ee,{placeholder:"Select project",showSearch:!0,optionFilterProp:"label",options:(c??[]).map(g=>({value:g.id,label:g.name}))})}),t.jsx(N.Item,{name:"name",label:"Task Name",rules:[{required:!0,message:"Please enter task name"}],children:t.jsx(J,{placeholder:"e.g. Highway Daily Mileage"})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"task_type",label:"Task Type",rules:[{required:!0,message:"Please select type"}],children:t.jsx(ee,{placeholder:"Select type",options:[{value:"Daily",label:"Daily"},{value:"Smoke",label:"Smoke"},{value:"Gray",label:"Gray"},{value:"Freeze",label:"Freeze"},{value:"Retest",label:"Retest"}]})}),t.jsx(N.Item,{name:"priority",label:"Priority",initialValue:"Medium",children:t.jsx(ee,{options:[{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"},{value:"Critical",label:"Critical"}]})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[t.jsx(N.Item,{name:"execution_region",label:"Execution Region",children:t.jsx(J,{placeholder:"e.g. Shanghai Lingang"})}),t.jsx(N.Item,{name:"target_vehicle_count",label:"Target Vehicle Count",children:t.jsx(we,{min:1,style:{width:"100%"},placeholder:"Optional"})})]})]})})]})}const zd=["Completed","Cancelled"];function Ld(){const{id:e}=cs(),s=qe(),{data:n,isLoading:a}=na("task",e,Oc),{data:r}=B({queryKey:["runs",{taskId:e}],queryFn:()=>Ts({taskId:e}),enabled:!!e}),{data:i}=B({queryKey:["project",n==null?void 0:n.projectId],queryFn:()=>Vr(n.projectId),enabled:!!(n!=null&&n.projectId)}),l=fe({mutationFn:()=>Lc(e),onSuccess:()=>{s.invalidateQueries({queryKey:["task",e]}),s.invalidateQueries({queryKey:["tasks"]}),Z.success("Status advanced")},onError:u=>Z.error(u.message||"Failed to advance status")});if(a)return t.jsx(Fs,{});if(!n)return t.jsx(sa,{entity:"Task"});const o=!zd.includes(n.stage),d=[{title:"Run ID",dataIndex:"id",key:"id",width:120,render:u=>t.jsx(We,{to:`/runs/${u}`,mono:!0,children:u.slice(0,8)})},{title:"Status",dataIndex:"status",key:"status",width:120,render:u=>t.jsx(K,{color:Ee[u]??"default",children:u})},{title:"Result",dataIndex:"result",key:"result",width:100,render:u=>u??t.jsx(he,{})},{title:"Started",dataIndex:"startedAt",key:"startedAt",render:u=>u?new Date(u).toLocaleString():t.jsx(he,{})}];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:n.title}),t.jsx("p",{className:"page-subtitle",children:n.description??"No description"})]}),t.jsxs(H,{children:[t.jsx(K,{color:Ys[n.stage]??"default",style:{fontSize:13,padding:"3px 10px"},children:n.stage}),t.jsx(K,{color:Xs[n.priority]??"default",style:{fontSize:13,padding:"3px 10px"},children:n.priority}),o&&t.jsx(q,{size:"small",loading:l.isPending,onClick:()=>l.mutate(),style:{borderColor:"var(--glass-border-light)",color:"var(--text-secondary)"},children:"Advance Status â†’"})]})]}),t.jsxs(re,{gutter:[24,24],children:[t.jsx(O,{xs:24,lg:16,children:t.jsx(z,{title:t.jsx(et,{children:"Test Runs"}),className:"glass-panel",styles:{body:{padding:0}},children:t.jsx(Se,{columns:d,dataSource:r,rowKey:"id",pagination:!1,locale:{emptyText:t.jsx(le,{description:"No runs executed yet"})}})})}),t.jsx(O,{xs:24,lg:8,children:t.jsx(z,{title:t.jsx(et,{children:"Details"}),className:"glass-panel",children:t.jsxs(A,{column:1,size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Ys[n.stage]??"default",children:n.stage})}),t.jsx(A.Item,{label:"Task Type",children:n.taskType?t.jsx(K,{children:n.taskType}):t.jsx(he,{})}),t.jsx(A.Item,{label:"Priority",children:t.jsx(K,{color:Xs[n.priority]??"default",children:n.priority})}),t.jsx(A.Item,{label:"Project",children:n.projectId?t.jsx(We,{to:`/projects/${n.projectId}`,children:(i==null?void 0:i.name)??n.projectId}):t.jsx(he,{})}),t.jsx(A.Item,{label:"Execution Region",children:n.executionRegion??t.jsx(he,{})}),t.jsx(A.Item,{label:"Target Vehicles",children:n.targetVehicleCount??t.jsx(he,{})}),t.jsx(A.Item,{label:"Created",children:new Date(n.createdAt).toLocaleString()}),t.jsx(A.Item,{label:"Updated",children:new Date(n.updatedAt).toLocaleString()})]})})})]})]})}function Nd(){const{data:e,isLoading:s}=B({queryKey:["runs"],queryFn:()=>Ts()}),n=[{title:"Run ID",dataIndex:"id",key:"id",width:120,render:a=>t.jsx(We,{to:`/runs/${a}`,mono:!0,children:a.slice(0,8)})},{title:"Task",dataIndex:"taskId",key:"taskId",width:120,render:a=>a?t.jsx(We,{to:`/tasks/${a}`,mono:!0,children:a.slice(0,8)}):t.jsx(he,{})},{title:"Status",dataIndex:"status",key:"status",width:120,render:a=>t.jsx(K,{color:Ee[a]??"default",children:a})},{title:"Result",dataIndex:"result",key:"result",width:100,render:a=>a??t.jsx(he,{})},{title:"Vehicles",dataIndex:"vehicleIds",key:"vehicles",width:90,render:a=>(a==null?void 0:a.length)??0},{title:"Started",dataIndex:"startedAt",key:"startedAt",width:160,render:a=>a?new Date(a).toLocaleString():t.jsx(he,{})},{title:"Completed",dataIndex:"completedAt",key:"completedAt",width:160,render:a=>a?new Date(a).toLocaleString():t.jsx(he,{})}];return t.jsxs("div",{children:[t.jsx(rt,{title:"Test Runs",subtitle:"Monitor and manage test execution runs"}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:n,dataSource:e,rowKey:"id",loading:s,pagination:{pageSize:15,showSizeChanger:!1},scroll:{x:900},locale:{emptyText:t.jsx(le,{image:t.jsx(an,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No test runs yet. Runs will appear here once tasks are executed."})})}})})]})}function Dd(){var a;const{id:e}=cs(),{data:s,isLoading:n}=na("run",e,Nc);return n?t.jsx(Fs,{}):s?t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"page-title",children:["Run ",s.id.slice(0,8)]}),t.jsx("p",{className:"page-subtitle",children:"Detailed execution information"})]}),t.jsx(K,{color:Ee[s.status]??"default",style:{fontSize:14,padding:"4px 12px"},children:s.status})]}),t.jsx(re,{gutter:[24,24],children:t.jsx(O,{xs:24,lg:16,children:t.jsx(z,{title:t.jsx(et,{children:"Run Overview"}),className:"glass-panel",children:t.jsxs(A,{column:{xs:1,sm:2},size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Run ID",children:t.jsx("code",{style:{color:"#818cf8",fontSize:13},children:s.id})}),t.jsx(A.Item,{label:"Task",children:s.taskId?t.jsx(We,{to:`/tasks/${s.taskId}`,mono:!0,children:s.taskId}):"â€”"}),t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Ee[s.status]??"default",children:s.status})}),t.jsx(A.Item,{label:"Result",children:s.result??"â€”"}),t.jsx(A.Item,{label:"Vehicles",children:((a=s.vehicleIds)==null?void 0:a.length)??0}),t.jsx(A.Item,{label:"Started",children:s.startedAt?new Date(s.startedAt).toLocaleString():"â€”"}),t.jsx(A.Item,{label:"Completed",children:s.completedAt?new Date(s.completedAt).toLocaleString():"â€”"})]})})})})]}):t.jsx(sa,{entity:"Run"})}function $d(){const[e,s]=m.useState(""),[n,a]=m.useState(),[r,i]=m.useState(),{data:l,isLoading:o}=B({queryKey:["issues"],queryFn:()=>Wc()}),d=l==null?void 0:l.filter(c=>!(e&&!c.title.toLowerCase().includes(e.toLowerCase())||n&&c.status!==n||r&&c.severity!==r)),u=[{title:"Title",dataIndex:"title",key:"title",ellipsis:!0,render:(c,h)=>t.jsx(We,{to:`/issues/${h.id}`,children:c})},{title:"Status",dataIndex:"status",key:"status",width:150,render:c=>t.jsx(K,{color:Ee[c]??"default",children:c})},{title:"Severity",dataIndex:"severity",key:"severity",width:110,render:c=>t.jsx(K,{color:Hr[c]??"default",children:c})},{title:"Assignee",dataIndex:"assignee",key:"assignee",width:140,render:c=>c??t.jsx(he,{})},{title:"Updated",dataIndex:"updatedAt",key:"updatedAt",width:140,render:c=>new Date(c).toLocaleDateString()}];return t.jsxs("div",{children:[t.jsx(rt,{title:"Issues",subtitle:"Track defects and issues found during testing",action:t.jsx(q,{type:"primary",icon:t.jsx($t,{}),size:"large",children:"Report Issue"})}),t.jsxs(H,{direction:"vertical",size:16,style:{width:"100%"},children:[t.jsxs(H,{wrap:!0,children:[t.jsx(J,{placeholder:"Search issues...",prefix:t.jsx(Zs,{style:{color:"var(--text-muted)"}}),value:e,onChange:c=>s(c.target.value),allowClear:!0,style:{width:280}}),t.jsx(ee,{placeholder:"Status",allowClear:!0,value:n,onChange:a,style:{width:160},options:[{value:"New",label:"New"},{value:"Triage",label:"Triage"},{value:"Assigned",label:"Assigned"},{value:"InProgress",label:"In Progress"},{value:"Fixed",label:"Fixed"},{value:"RegressionTracking",label:"Regression"},{value:"Closed",label:"Closed"},{value:"Reopened",label:"Reopened"},{value:"Rejected",label:"Rejected"}]}),t.jsx(ee,{placeholder:"Severity",allowClear:!0,value:r,onChange:i,style:{width:140},options:[{value:"Critical",label:"Critical"},{value:"High",label:"High"},{value:"Medium",label:"Medium"},{value:"Low",label:"Low"},{value:"Trivial",label:"Trivial"}]})]}),t.jsx("div",{className:"glass-panel",style:{overflow:"hidden"},children:t.jsx(Se,{columns:u,dataSource:d,rowKey:"id",loading:o,pagination:{pageSize:15,showSizeChanger:!1},locale:{emptyText:t.jsx(le,{image:t.jsx(Er,{size:48,style:{color:"var(--text-muted)",opacity:.4}}),description:t.jsx("span",{style:{color:"var(--text-muted)"},children:"No issues reported. Issues from test runs will appear here."})})}})})]})]})}const Pa=["#818cf8","#34d399","#f472b6","#fbbf24","#60a5fa","#f87171","#a78bfa","#22d3ee"];function qd({channel:e}){const{chartData:s,valueKeys:n}=m.useMemo(()=>{const a=new Set;return{chartData:e.data_points.map(i=>{const l={t:i.t/1e3};for(const[o,d]of Object.entries(i.values))typeof d=="number"&&(l[o]=d,a.add(o));return l}),valueKeys:Array.from(a)}},[e.data_points]);return n.length===0?t.jsx(le,{description:"No numeric data",image:le.PRESENTED_IMAGE_SIMPLE}):t.jsx(Ft,{width:"100%",height:250,children:t.jsxs(tr,{data:s,children:[t.jsx(rs,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),t.jsx(vt,{dataKey:"t",tick:{fill:"#64748b",fontSize:11},unit:"s"}),t.jsx(Ve,{tick:{fill:"#64748b",fontSize:11}}),t.jsx(Ae,{contentStyle:{background:"rgba(15,23,42,0.9)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8},labelStyle:{color:"#94a3b8"}}),t.jsx(at,{}),n.map((a,r)=>t.jsx(Nn,{type:"monotone",dataKey:a,stroke:Pa[r%Pa.length],dot:!1,strokeWidth:1.5},a))]})})}const Kd={New:["Triage","Rejected"],Triage:["Assigned","Rejected"],Assigned:["InProgress"],InProgress:["Fixed"],Fixed:["RegressionTracking"],RegressionTracking:["Closed","Reopened"],Reopened:["InProgress"],Closed:[],Rejected:[]};function Bd(){var C,w,P,j,S,I,F,k;const{id:e}=cs(),s=qe(),[n,a]=m.useState(!1),[r]=N.useForm(),[i,l]=m.useState(""),{data:o,isLoading:d,error:u}=B({queryKey:["issue",e],queryFn:()=>Hc(e),enabled:!!e}),{data:c}=B({queryKey:["issue-transitions",e],queryFn:()=>Jc(e),enabled:!!e}),h=fe({mutationFn:({toStatus:x,reason:E})=>Qc(e,{to_status:x,triggered_by:"ui-user",reason:E}),onSuccess:()=>{s.invalidateQueries({queryKey:["issue",e]}),s.invalidateQueries({queryKey:["issue-transitions",e]}),l("")}}),y=fe({mutationFn:x=>Gc(e,x),onSuccess:()=>{s.invalidateQueries({queryKey:["issue",e]}),s.invalidateQueries({queryKey:["issue-transitions",e]}),a(!1),r.resetFields()}}),{data:f}=B({queryKey:["issue-snapshot",e],queryFn:()=>ld(e),enabled:!!e}),{data:g}=B({queryKey:["issue-timeseries",e],queryFn:()=>od(e),enabled:!!e}),v=m.useMemo(()=>{if(!g)return{};const x={};for(const E of g){const $=E.channel_type||"other";(x[$]??(x[$]=[])).push(E)}return x},[g]);if(d)return t.jsx(Fs,{});if(u||!o)return t.jsx(jt,{type:"error",message:"Failed to load issue",showIcon:!0,style:{borderRadius:12}});const b=o.status,_=Kd[b]??[],R=b==="Triage";return t.jsxs("div",{children:[t.jsxs(ss,{to:"/issues",style:{display:"inline-flex",alignItems:"center",gap:6,color:"var(--text-secondary)",marginBottom:20,fontSize:13},children:[t.jsx(ri,{})," Back to Issues"]}),t.jsxs(z,{className:"glass-panel",style:{marginBottom:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[t.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[t.jsx(Dr,{size:24,style:{color:"#6366f1"}}),t.jsxs("div",{children:[t.jsxs("h1",{style:{fontFamily:"var(--font-mono)",fontSize:"1.15rem",fontWeight:700,color:"var(--text-primary)",margin:0,textTransform:"uppercase",letterSpacing:"0.02em"},children:["Issue ",o.id.slice(0,12)]}),t.jsx("code",{style:{fontSize:12,color:"var(--text-muted)"},children:o.id})]})]}),t.jsxs(H,{children:[t.jsx(K,{color:Hr[o.severity]??"default",style:{fontSize:13,padding:"2px 10px"},children:o.severity}),t.jsx(K,{color:Ee[b]??"default",style:{fontSize:13,padding:"2px 10px"},children:b})]})]}),o.description&&t.jsx("p",{style:{marginTop:16,color:"var(--text-secondary)",fontSize:14},children:o.description}),t.jsx(qs,{style:{borderColor:"rgba(255,255,255,0.06)",margin:"20px 0"}}),t.jsxs(A,{column:{xs:1,sm:2,lg:4},size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Category",children:o.category??"â€”"}),t.jsx(A.Item,{label:"Takeover Type",children:o.takeoverType??"â€”"}),t.jsx(A.Item,{label:"Assignee",children:o.assignee??"â€”"}),t.jsx(A.Item,{label:"Module",children:o.module??"â€”"}),o.gpsLat!=null&&o.gpsLng!=null&&t.jsx(A.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(ii,{})," GPS"]}),children:t.jsxs("code",{children:[Number(o.gpsLat).toFixed(6),", ",Number(o.gpsLng).toFixed(6)]})}),o.dataSnapshotUri&&t.jsx(A.Item,{label:"Snapshot",children:t.jsxs("a",{href:o.dataSnapshotUri,target:"_blank",rel:"noopener noreferrer",style:{color:"#818cf8"},children:["View ",t.jsx(li,{})]})}),t.jsx(A.Item,{label:"Run",children:t.jsx("code",{children:o.runId?o.runId.slice(0,8):"â€”"})}),t.jsx(A.Item,{label:"Triggered At",children:o.triggerTimestamp?new Date(o.triggerTimestamp).toLocaleString():"â€”"})]}),o.faultCodes&&o.faultCodes.length>0&&t.jsxs("div",{style:{marginTop:16},children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",marginBottom:8},children:"Fault Codes"}),t.jsx(H,{wrap:!0,children:o.faultCodes.map(x=>t.jsx(K,{color:"red",style:{fontFamily:"monospace"},children:x},x))})]}),o.environmentTags&&o.environmentTags.length>0&&t.jsxs("div",{style:{marginTop:12},children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",marginBottom:8},children:"Environment Tags"}),t.jsx(H,{wrap:!0,children:o.environmentTags.map(x=>t.jsx(K,{children:x},x))})]}),(o.triageMode||o.triageHint)&&t.jsx(jt,{type:"warning",style:{marginTop:16,borderRadius:10},message:"Triage Hints",description:t.jsxs(H,{direction:"vertical",size:4,children:[o.triageMode&&t.jsxs("span",{children:["Mode: ",t.jsx("strong",{children:o.triageMode})]}),o.triageHint&&t.jsxs("span",{children:["Hint: ",t.jsx("strong",{children:o.triageHint})]})]})})]}),t.jsxs(re,{gutter:[24,24],children:[_.length>0&&t.jsx(O,{xs:24,lg:12,children:t.jsxs(z,{title:t.jsx(et,{children:"Transition"}),className:"glass-panel",children:[t.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:13,marginBottom:16},children:["Current: ",t.jsx(K,{color:Ee[b],children:b})," â€” Choose next state:"]}),t.jsx(J,{placeholder:"Reason (optional)",value:i,onChange:x=>l(x.target.value),style:{marginBottom:16,maxWidth:400}}),t.jsx(H,{wrap:!0,children:_.map(x=>R&&x==="Assigned"?t.jsx(oi,{title:"Assign owner and module",children:t.jsx(q,{type:"primary",onClick:()=>a(!0),children:"Assign (Triage)"})},x):t.jsx(q,{onClick:()=>h.mutate({toStatus:x,reason:i||void 0}),loading:h.isPending,style:{borderColor:"rgba(255,255,255,0.15)"},children:t.jsx(K,{color:Pd[x],style:{margin:0},children:x})},x))}),h.isError&&t.jsx(jt,{type:"error",message:"Transition failed",style:{marginTop:12,borderRadius:8}})]})}),t.jsx(O,{xs:24,lg:_.length>0?12:24,children:t.jsx(z,{title:t.jsx(et,{children:"Audit Trail"}),className:"glass-panel",children:c!=null&&c.items&&c.items.length>0?t.jsx(Qa,{items:c.items.map(x=>({dot:t.jsx(ci,{style:{color:"#6366f1"}}),children:t.jsxs("div",{children:[t.jsxs(H,{size:4,children:[t.jsx(K,{color:Ee[x.fromStatus]??"default",style:{fontSize:11},children:x.fromStatus}),t.jsx("span",{style:{color:"var(--text-muted)"},children:"â†’"}),t.jsx(K,{color:Ee[x.toStatus]??"default",style:{fontSize:11},children:x.toStatus})]}),t.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:["by ",t.jsx("span",{style:{color:"var(--text-secondary)"},children:x.triggeredBy})," at ",x.transitionedAt?new Date(x.transitionedAt).toLocaleString():"â€”"]}),x.reason&&t.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",fontStyle:"italic",marginTop:2},children:["â€œ",x.reason,"â€"]})]})}))}):t.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:"No transitions recorded yet."})})})]}),t.jsx(z,{title:t.jsx(et,{children:"Vehicle Dynamics Snapshot"}),className:"glass-panel",style:{marginTop:24},children:f?t.jsxs(A,{column:{xs:1,sm:2,lg:4},size:"small",colon:!1,children:[t.jsx(A.Item,{label:"Speed (m/s)",children:((C=f.speed_mps)==null?void 0:C.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Acceleration (m/sÂ²)",children:((w=f.acceleration_mps2)==null?void 0:w.toFixed(3))??"â€”"}),t.jsx(A.Item,{label:"Lateral Accel (m/sÂ²)",children:((P=f.lateral_acceleration_mps2)==null?void 0:P.toFixed(3))??"â€”"}),t.jsx(A.Item,{label:"Yaw Rate (Â°/s)",children:((j=f.yaw_rate_dps)==null?void 0:j.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Heading (Â°)",children:((S=f.heading_deg)==null?void 0:S.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Steering Angle (Â°)",children:((I=f.steering_angle_deg)==null?void 0:I.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Throttle (%)",children:((F=f.throttle_pct)==null?void 0:F.toFixed(1))??"â€”"}),t.jsx(A.Item,{label:"Brake (bar)",children:((k=f.brake_pressure_bar)==null?void 0:k.toFixed(2))??"â€”"}),t.jsx(A.Item,{label:"Gear",children:f.gear??"â€”"}),t.jsx(A.Item,{label:"Quaternion",children:f.quaternion?`${f.quaternion.w.toFixed(4)}, ${f.quaternion.x.toFixed(4)}, ${f.quaternion.y.toFixed(4)}, ${f.quaternion.z.toFixed(4)}`:"â€”"})]}):t.jsx(le,{description:"No snapshot data",image:le.PRESENTED_IMAGE_SIMPLE})}),g&&g.length>0&&t.jsx(z,{title:t.jsx(et,{children:"Time-Series Data"}),className:"glass-panel",style:{marginTop:24},children:t.jsx(Ga,{items:Object.entries(v).map(([x,E])=>({key:x,label:t.jsx(K,{children:x}),children:t.jsx(H,{direction:"vertical",size:16,style:{width:"100%"},children:E.map($=>t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--text-secondary)",marginBottom:8},children:$.channel}),t.jsx(qd,{channel:$})]},$.channel))})}))})}),t.jsx(as,{title:"Triage Assignment",open:n,onCancel:()=>a(!1),onOk:()=>r.submit(),confirmLoading:y.isPending,okText:"Assign & Transition",children:t.jsxs(N,{form:r,layout:"vertical",onFinish:x=>y.mutate(x),children:[t.jsx(N.Item,{name:"assignee",label:"Assign To",rules:[{required:!0,message:"Please enter assignee"}],children:t.jsx(J,{placeholder:"Developer name"})}),t.jsx(N.Item,{name:"module",label:"Module",rules:[{required:!0,message:"Please enter module"}],children:t.jsx(J,{placeholder:"e.g. perception, planning"})})]})})]})}const ns=["#8b929a","#60a5fa","#34d399","#fbbf24","#f87171","#a78bfa","#fb923c","#22d3ee","#e879f9","#4ade80"],be="rgba(255,255,255,0.06)",Re="#505660",hs={contentStyle:{background:"rgba(24,25,30,0.95)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:12,backdropFilter:"blur(20px)",color:"#e4e7eb",fontFamily:"'Fira Code', monospace",fontSize:11,boxShadow:"0 8px 32px rgba(0,0,0,0.3)"}};function Me(e,s){return e.color||ns[s%ns.length]}function Ud(e){return e.some(s=>s.axisId==="right")}function aa({thresholds:e}){return!e||e.length===0?null:t.jsx(t.Fragment,{children:e.map((s,n)=>t.jsx(Ii,{y:s.value,yAxisId:"left",stroke:s.color||"#ff0044",strokeDasharray:"6 3",strokeWidth:1.5,label:{value:s.label??`${s.value}`,fill:s.color||"#ff0044",fontSize:10,position:"right"}},n))})}function ra({xField:e,yFields:s,children:n,thresholds:a}){const r=Ud(s);return t.jsxs(t.Fragment,{children:[t.jsx(rs,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:e,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"left",tick:{fontSize:11,fill:Re},stroke:be}),r&&t.jsx(Ve,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(at,{}),t.jsx(aa,{thresholds:a}),n]})}function Vd({data:e,xField:s,yFields:n,thresholds:a}){return t.jsx(Vs,{data:e,children:t.jsx(ra,{xField:s,yFields:n,thresholds:a,children:n.map((r,i)=>t.jsx(Zt,{dataKey:r.key,name:r.label||r.key,fill:Me(r,i),yAxisId:r.axisId||"left",radius:[6,6,0,0],fillOpacity:.85},r.key))})})}function Wd({data:e,xField:s,yFields:n,thresholds:a}){return t.jsx(tr,{data:e,children:t.jsx(ra,{xField:s,yFields:n,thresholds:a,children:n.map((r,i)=>t.jsx(Nn,{type:"monotone",dataKey:r.key,name:r.label||r.key,stroke:Me(r,i),yAxisId:r.axisId||"left",strokeWidth:2,dot:{r:3,fill:Me(r,i)},activeDot:{r:5,stroke:Me(r,i),filter:`drop-shadow(0 0 4px ${Me(r,i)})`}},r.key))})})}function Hd({data:e,xField:s,yFields:n,thresholds:a}){return t.jsxs(sr,{data:e,children:[t.jsx("defs",{children:n.map((r,i)=>{const l=Me(r,i);return t.jsxs("linearGradient",{id:`areaGrad-${r.key}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:l,stopOpacity:.3}),t.jsx("stop",{offset:"100%",stopColor:l,stopOpacity:0})]},r.key)})}),t.jsx(ra,{xField:s,yFields:n,thresholds:a,children:n.map((r,i)=>t.jsx(gn,{type:"monotone",dataKey:r.key,name:r.label||r.key,stroke:Me(r,i),fill:`url(#areaGrad-${r.key})`,yAxisId:r.axisId||"left",strokeWidth:2},r.key))})]})}function Qd({data:e,xField:s,yFields:n}){var a,r,i;return t.jsxs(Ci,{children:[t.jsx(rs,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:s,name:s,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{dataKey:(a=n[0])==null?void 0:a.key,name:((r=n[0])==null?void 0:r.label)||((i=n[0])==null?void 0:i.key),tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(at,{}),n.map((l,o)=>t.jsx(wi,{name:l.label||l.key,data:e,fill:Me(l,o),fillOpacity:.7},l.key))]})}function Gd({data:e,xField:s,yFields:n}){var r;const a=((r=n[0])==null?void 0:r.key)??"value";return t.jsxs(en,{children:[t.jsx(Ae,{...hs}),t.jsx(at,{}),t.jsx(tn,{data:e,dataKey:a,nameKey:s||"name",cx:"50%",cy:"50%",innerRadius:"40%",outerRadius:"75%",strokeWidth:1,stroke:"rgba(255,255,255,0.06)",label:({name:i,percent:l})=>`${i} ${(l*100).toFixed(0)}%`,children:e.map((i,l)=>t.jsx(es,{fill:ns[l%ns.length],fillOpacity:.85},l))})]})}function Jd({data:e,yFields:s}){var o,d,u;const n=Number(((d=e[0])==null?void 0:d[((o=s[0])==null?void 0:o.key)??"value"])??0),r=Math.min(100,Math.max(0,n/100*100)),i=r>=80?"#34d399":r>=50?"#fbbf24":"#f87171",l=[{name:"value",value:r},{name:"remaining",value:100-r}];return t.jsxs(en,{children:[t.jsxs(tn,{data:l,cx:"50%",cy:"70%",startAngle:180,endAngle:0,innerRadius:"60%",outerRadius:"85%",dataKey:"value",strokeWidth:0,children:[t.jsx(es,{fill:i}),t.jsx(es,{fill:"rgba(255,255,255,0.06)"})]}),t.jsx("text",{x:"50%",y:"62%",textAnchor:"middle",fill:i,style:{fontSize:24,fontFamily:"'Fira Code', monospace",fontWeight:700},children:n.toFixed(1)}),t.jsx("text",{x:"50%",y:"78%",textAnchor:"middle",fill:"#505660",style:{fontSize:11,fontFamily:"'Fira Code', monospace"},children:((u=s[0])==null?void 0:u.label)||"Value"})]})}function Yd({data:e,xField:s,yFields:n}){return t.jsxs(ji,{data:e,cx:"50%",cy:"50%",outerRadius:"75%",children:[t.jsx(bi,{stroke:be}),t.jsx(Si,{dataKey:s,tick:{fontSize:11,fill:Re}}),t.jsx(ki,{tick:{fontSize:10,fill:Re}}),t.jsx(Ae,{...hs}),t.jsx(at,{}),n.map((a,r)=>t.jsx(_i,{name:a.label||a.key,dataKey:a.key,stroke:Me(a,r),fill:Me(a,r),fillOpacity:.2,strokeWidth:2},a.key))]})}function Xd({data:e,xField:s,yFields:n,thresholds:a}){return t.jsxs(vi,{data:e,children:[t.jsx(rs,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:s,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"left",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(at,{}),t.jsx(aa,{thresholds:a}),n.map((r,i)=>{const l=r.axisId||(i===0?"left":"right");return i===0?t.jsx(Zt,{dataKey:r.key,name:r.label||r.key,fill:Me(r,i),yAxisId:l,radius:[6,6,0,0],fillOpacity:.85},r.key):t.jsx(Nn,{type:"monotone",dataKey:r.key,name:r.label||r.key,stroke:Me(r,i),yAxisId:l,strokeWidth:2,dot:{r:3}},r.key)})]})}function Zd({data:e,xField:s,yFields:n}){var l,o;const a=((l=n[0])==null?void 0:l.key)??"value",r=[...e].sort((d,u)=>Number(u[a]??0)-Number(d[a]??0)),i=Number(((o=r[0])==null?void 0:o[a])??1);return t.jsx("div",{style:{padding:"20px 0"},children:r.map((d,u)=>{const c=Number(d[a]??0),h=Math.max(10,c/i*100),y=ns[u%ns.length];return t.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8,justifyContent:"center"},children:[t.jsx("span",{style:{width:100,textAlign:"right",paddingRight:12,fontSize:11,color:Re,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontFamily:"'Fira Code', monospace"},children:String(d[s||"name"]??`Step ${u+1}`)}),t.jsx("div",{style:{width:`${h}%`,maxWidth:400,height:28,background:y,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",color:"#000",fontSize:10,fontWeight:700,opacity:.85,transition:"width 0.3s ease",fontFamily:"'Fira Code', monospace"},children:c})]},u)})})}function eu({data:e,xField:s,yFields:n,thresholds:a}){var o,d;const r=((o=n[0])==null?void 0:o.key)??"value";let i=0;const l=e.map(u=>{const c=Number(u[r]??0),h=i;return i+=c,{...u,_wf_start:h,_wf_end:i,_wf_value:c}});return t.jsxs(Vs,{data:l,children:[t.jsx(rs,{strokeDasharray:"3 3",stroke:be}),t.jsx(vt,{dataKey:s,tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ve,{yAxisId:"left",tick:{fontSize:11,fill:Re},stroke:be}),t.jsx(Ae,{...hs}),t.jsx(at,{}),t.jsx(aa,{thresholds:a}),t.jsx(Zt,{dataKey:"_wf_start",stackId:"wf",fill:"transparent",yAxisId:"left"}),t.jsx(Zt,{dataKey:"_wf_value",stackId:"wf",name:((d=n[0])==null?void 0:d.label)||r,yAxisId:"left",radius:[6,6,0,0],children:l.map((u,c)=>t.jsx(es,{fill:Number(u._wf_value)>=0?"#34d399":"#f87171",fillOpacity:.85},c))})]})}const tu={bar:Vd,line:Wd,area:Hd,scatter:Qd,pie:Gd,gauge:Jd,radar:Yd,dual_axes:Xd,funnel:Zd,waterfall:eu};function su(e){const{chartType:s,data:n,title:a}=e,r=tu[s];return!r||!n.length?t.jsx(z,{className:"glass-panel",children:t.jsx(le,{description:n.length===0?"No data":`Unknown chart type: ${s}`})}):t.jsx(z,{className:"glass-panel",title:a?t.jsx("span",{className:"font-display",style:{fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em"},children:a}):void 0,children:t.jsx(Ft,{width:"100%",height:340,children:t.jsx(r,{...e})})})}function Ta({title:e,value:s,unit:n,loading:a}){return t.jsx(z,{className:"glass-panel",style:{height:"100%"},children:a?t.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:t.jsx(Ot,{})}):t.jsx(Nt,{title:t.jsx("span",{className:"font-display",style:{fontWeight:600,fontSize:11,textTransform:"uppercase",letterSpacing:"0.06em"},children:e}),value:s??void 0,precision:2,suffix:n?t.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:n}):void 0,valueStyle:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--accent-strong)"},formatter:r=>r==null?"â€”":String(r)})})}function nu({groups:e,title:s}){const n=m.useMemo(()=>{const r=new Set;return e.forEach(l=>Object.keys(l.group).forEach(o=>r.add(o))),[...[...r].map(l=>({title:t.jsx("span",{style:{fontFamily:"var(--font-mono)"},children:l}),dataIndex:["group",l],key:l,render:o=>String(o??"â€”")})),{title:t.jsx("span",{style:{fontFamily:"var(--font-mono)"},children:"Value"}),dataIndex:"value",key:"_value",align:"right",render:l=>t.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:600,color:"var(--accent-strong)"},children:l.toLocaleString(void 0,{maximumFractionDigits:2})})}]},[e]),a=m.useMemo(()=>e.map((r,i)=>({...r,_key:String(i)})),[e]);return t.jsx(z,{className:"glass-panel",title:s?t.jsx("span",{className:"font-display",style:{fontWeight:600},children:s}):void 0,children:t.jsx(Se,{dataSource:a,columns:n,rowKey:"_key",pagination:e.length>20?{pageSize:20,size:"small"}:!1,size:"small"})})}function Qr(e,s=""){return e.map(n=>{const a=s?`${s}.${n.name}`:n.name,r=n.children&&n.children.length>0;return{title:`${n.name} (${n.type})`,value:a,selectable:!r,children:r?Qr(n.children,a):void 0}})}function au({entity:e,value:s,onChange:n}){const{data:a,isLoading:r}=B({queryKey:["schema-fields",e],queryFn:()=>cd(e),enabled:!!e}),i=m.useMemo(()=>{if(!a)return[];const l="fields"in a?a:void 0;return l?Qr(l.fields):[]},[a]);return t.jsx(di,{value:s||void 0,onChange:n,treeData:i,loading:r,placeholder:e?"Select field...":"Choose entity first",disabled:!e,showSearch:!0,treeDefaultExpandAll:!0,style:{width:"100%"},dropdownStyle:{maxHeight:360,overflow:"auto"},popupClassName:"glass-panel-elevated"})}const Fa=[{value:"project",label:"Project"},{value:"task",label:"Task"},{value:"run",label:"Run"},{value:"issue",label:"Issue"},{value:"cross",label:"Cross-Entity"}],ru=[{value:"sum",label:"Sum"},{value:"avg",label:"Average"},{value:"count",label:"Count"},{value:"min",label:"Min"},{value:"max",label:"Max"},{value:"distinct_count",label:"Distinct Count"},{value:"raw",label:"Raw"},{value:"percentile_50",label:"P50 (Median)"},{value:"percentile_90",label:"P90"},{value:"percentile_99",label:"P99"},{value:"stddev",label:"Std Dev"}],iu=[{value:"stat",label:"Stat Card"},{value:"table",label:"Table"},{value:"bar",label:"Bar Chart"},{value:"line",label:"Line Chart"},{value:"area",label:"Area Chart"},{value:"scatter",label:"Scatter Plot"},{value:"pie",label:"Pie Chart"},{value:"gauge",label:"Gauge"},{value:"radar",label:"Radar"},{value:"dual_axes",label:"Dual Axes (Bar+Line)"},{value:"funnel",label:"Funnel"},{value:"waterfall",label:"Waterfall"}],lu=[{label:"+",value:" + ",title:"Add"},{label:"âˆ’",value:" - ",title:"Subtract"},{label:"Ã—",value:" * ",title:"Multiply"},{label:"Ã·",value:" / ",title:"Divide"},{label:"(",value:"(",title:"Open paren"},{label:")",value:")",title:"Close paren"},{label:"âˆš",value:"sqrt(",title:"Square root"},{label:"xÂ²",value:"^2",title:"Square"},{label:"pow",value:"pow(",title:"Power"},{label:"abs",value:"abs(",title:"Absolute value"},{label:"log",value:"log(",title:"Natural log"},{label:"round",value:"round(",title:"Round"},{label:"ceil",value:"ceil(",title:"Ceiling"},{label:"floor",value:"floor(",title:"Floor"},{label:"min",value:"min(",title:"Minimum"},{label:"max",value:"max(",title:"Maximum"}],ou=[{name:"Issue Count by Category (Bar)",template:{name:"Issue Count by Category",data_source:"issue",formula:"issue_count",variables:[{name:"issue_count",source_entity:"issue",field:"issue_id",aggregation:"count"}],visualization:{chart_type:"bar",x_axis:{field:"category"},y_axes:[{variable:"value",label:"Issues"}]}}},{name:"Issue Severity Distribution (Pie)",template:{name:"Issue Severity Distribution",data_source:"issue",formula:"severity_count",variables:[{name:"severity_count",source_entity:"issue",field:"issue_id",aggregation:"count"}],visualization:{chart_type:"pie",x_axis:{field:"severity"},y_axes:[{variable:"value",label:"Count"}]}}},{name:"Total Mileage by Task (Bar)",template:{name:"Total Mileage by Task",data_source:"run",formula:"total_km",variables:[{name:"total_km",source_entity:"run",field:"total_auto_mileage_km",aggregation:"sum"}],visualization:{chart_type:"bar",x_axis:{field:"task_id"},y_axes:[{variable:"value",label:"Mileage (km)"}]}}},{name:"Fleet Utilization Gauge",template:{name:"Fleet Utilization",data_source:"run",formula:"utilization",variables:[{name:"utilization",source_entity:"run",field:"total_auto_mileage_km",aggregation:"avg"}],visualization:{chart_type:"gauge",y_axes:[{variable:"value",label:"Utilization %"}]}}}],cu=[{value:"left",label:"Left"},{value:"right",label:"Right"}],xe={fontFamily:"var(--font-mono)",fontWeight:500};function Ls(){return{name:"",source_entity:"",field:"",aggregation:"count"}}function Ns(){return{variable:"",label:"",color:"",axis_id:"left"}}function du({open:e,onClose:s,onSaved:n,editingDef:a}){const[r]=N.useForm(),[i,l]=m.useState(!1),[o,d]=m.useState(!1),[u,c]=m.useState(null),[h,y]=m.useState([Ls()]),[f,g]=m.useState([Ns()]),[v,b]=m.useState("issue"),[_,R]=m.useState([]);m.useEffect(()=>{var k,x;e&&(a?(r.setFieldsValue({name:a.name,description:a.description,data_source:a.data_source,formula:a.formula,chart_type:a.visualization.chart_type,x_axis_field:(k=a.visualization.x_axis)==null?void 0:k.field}),b(a.data_source),y(a.variables.length>0?a.variables.map(E=>({...E})):[Ls()]),g(a.visualization.y_axes&&a.visualization.y_axes.length>0?a.visualization.y_axes.map(E=>({variable:E.variable,label:E.label??"",color:E.color??"",axis_id:E.axis_id??"left"})):[Ns()]),R(((x=a.visualization.thresholds)==null?void 0:x.map(E=>({value:E.value,label:E.label??"",color:E.color??"#ef4444"})))??[])):(r.resetFields(),y([Ls()]),g([Ns()]),R([]),b("issue"),c(null)))},[e,a,r]);const C=(k,x)=>{y(E=>E.map(($,se)=>se===k?{...$,...x}:$))},w=k=>{y(x=>x.length<=1?x:x.filter((E,$)=>$!==k))},P=(k,x)=>{g(E=>E.map(($,se)=>se===k?{...$,...x}:$))},j=k=>{g(x=>x.length<=1?x:x.filter((E,$)=>$!==k))},S=()=>{const k=r.getFieldsValue();return{name:k.name,description:k.description,data_source:k.data_source,formula:k.formula,variables:h.filter(x=>x.name&&x.field),visualization:{chart_type:k.chart_type||"stat",x_axis:k.x_axis_field?{field:k.x_axis_field}:void 0,y_axes:f.filter(x=>x.variable).map(x=>({variable:x.variable,label:x.label||void 0,color:x.color||void 0,axis_id:x.axis_id||void 0})),thresholds:_.length>0?_.filter(x=>x.value!=null).map(x=>({value:x.value,label:x.label||void 0,color:x.color||"#ef4444"})):void 0,format:k.format_suffix?{suffix:k.format_suffix,precision:k.format_precision}:void 0},enabled:!0}},I=async()=>{try{const k=r.getFieldsValue();if(!k.formula){Z.warning("Enter a formula first");return}d(!0);const x=await fd({formula:k.formula,variables:h.filter(E=>E.name&&E.field)});c(x)}catch(k){const x=k instanceof Error?k.message:"Preview failed";Z.error(x)}finally{d(!1)}},F=async()=>{try{await r.validateFields(),l(!0);const k=S();a?(await hd(a.kpi_id,k),Z.success("KPI definition updated")):(await ud(k),Z.success("KPI definition created")),n(),s()}catch(k){if(k&&typeof k=="object"&&"errorFields"in k)return;const x=k instanceof Error?k.message:"Save failed";Z.error(x)}finally{l(!1)}};return t.jsx(as,{open:e,onCancel:s,title:t.jsx("span",{className:"font-display",style:{fontWeight:600},children:a?"Edit KPI Definition":"New KPI Definition"}),width:780,footer:t.jsxs(H,{children:[t.jsx(q,{onClick:s,children:"Cancel"}),t.jsx(q,{icon:t.jsx(ui,{}),onClick:I,loading:o,children:"Preview"}),t.jsx(q,{type:"primary",onClick:F,loading:i,children:a?"Update":"Create"})]}),destroyOnClose:!0,children:t.jsxs(N,{form:r,layout:"vertical",requiredMark:"optional",children:[!a&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("div",{style:{...xe,fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Quick Start from Template"}),t.jsx(H,{wrap:!0,size:[6,6],children:ou.map(k=>t.jsx(q,{size:"small",onClick:()=>{var E,$,se,ce;const x=k.template;r.setFieldsValue({name:x.name,data_source:x.data_source,formula:x.formula,chart_type:(E=x.visualization)==null?void 0:E.chart_type,x_axis_field:(se=($=x.visualization)==null?void 0:$.x_axis)==null?void 0:se.field}),x.data_source&&b(x.data_source),x.variables&&y(x.variables.map(de=>({...de}))),(ce=x.visualization)!=null&&ce.y_axes&&g(x.visualization.y_axes.map(de=>({variable:de.variable??"",label:de.label??"",color:de.color??"",axis_id:de.axis_id??"left"})))},children:k.name},k.name))})]}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:16,children:t.jsx(N.Item,{name:"name",label:t.jsx("span",{style:xe,children:"Name"}),rules:[{required:!0,message:"Name is required"}],children:t.jsx(J,{placeholder:"e.g. Issue Resolution Rate"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"data_source",label:t.jsx("span",{style:xe,children:"Data Source"}),rules:[{required:!0}],initialValue:"issue",children:t.jsx(ee,{options:Fa,onChange:k=>b(k)})})})]}),t.jsx(N.Item,{name:"description",label:t.jsx("span",{style:xe,children:"Description"}),children:t.jsx(J.TextArea,{rows:2,placeholder:"What does this KPI measure?"})}),t.jsx(qs,{titlePlacement:"left",style:{...xe,fontSize:13},children:"Variables"}),h.map((k,x)=>t.jsx(z,{size:"small",className:"glass-panel",style:{marginBottom:12},extra:h.length>1&&t.jsx(q,{type:"text",size:"small",icon:t.jsx(cn,{}),danger:!0,onClick:()=>w(x)}),children:t.jsxs(re,{gutter:12,children:[t.jsx(O,{span:5,children:t.jsx(J,{placeholder:"Variable name",value:k.name,onChange:E=>C(x,{name:E.target.value})})}),t.jsx(O,{span:5,children:t.jsx(ee,{value:k.source_entity||void 0,onChange:E=>C(x,{source_entity:E,field:""}),placeholder:"Entity",options:Fa,style:{width:"100%"}})}),t.jsx(O,{span:8,children:t.jsx(au,{entity:k.source_entity||v,value:k.field,onChange:E=>C(x,{field:E})})}),t.jsx(O,{span:6,children:t.jsx(ee,{value:k.aggregation,onChange:E=>C(x,{aggregation:E}),options:ru,style:{width:"100%"}})})]})},x)),t.jsx(q,{type:"dashed",icon:t.jsx($t,{}),onClick:()=>y(k=>[...k,Ls()]),block:!0,style:{marginBottom:16},children:"Add Variable"}),t.jsx(N.Item,{name:"formula",label:t.jsx("span",{style:xe,children:"Formula"}),rules:[{required:!0,message:"Formula is required"}],extra:t.jsx("span",{style:{color:"var(--text-muted)",fontSize:12},children:"Reference variables by name, e.g. closed_count / total_count * 100"}),children:t.jsx(J.TextArea,{rows:2,placeholder:"closed_count / total_count * 100",style:{fontFamily:"monospace"}})}),t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("div",{style:{...xe,fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Operator Palette"}),t.jsxs(H,{wrap:!0,size:[4,4],children:[lu.map(k=>t.jsx(q,{size:"small",title:k.title,style:{fontFamily:"monospace",minWidth:36},onClick:()=>{const x=r.getFieldValue("formula")||"";r.setFieldsValue({formula:x+k.value})},children:k.label},k.value)),h.filter(k=>k.name).map(k=>t.jsx(q,{size:"small",type:"dashed",style:{fontFamily:"monospace",color:"var(--accent-strong)"},onClick:()=>{const x=r.getFieldValue("formula")||"";r.setFieldsValue({formula:x+k.name})},children:k.name},`var-${k.name}`))]})]}),t.jsx(qs,{titlePlacement:"left",style:{...xe,fontSize:13},children:"Visualization"}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"chart_type",label:t.jsx("span",{style:xe,children:"Chart Type"}),initialValue:"stat",children:t.jsx(ee,{options:iu})})}),t.jsx(O,{span:16,children:t.jsx(N.Item,{name:"x_axis_field",label:t.jsx("span",{style:xe,children:"X-Axis Field"}),children:t.jsx(J,{placeholder:"e.g. date, category, status"})})})]}),t.jsx("div",{style:{...xe,fontSize:13,marginBottom:8},children:"Y-Axes"}),f.map((k,x)=>t.jsx(z,{size:"small",className:"glass-panel",style:{marginBottom:12},extra:f.length>1&&t.jsx(q,{type:"text",size:"small",icon:t.jsx(cn,{}),danger:!0,onClick:()=>j(x)}),children:t.jsxs(re,{gutter:12,children:[t.jsx(O,{span:7,children:t.jsx(J,{placeholder:"Variable ref",value:k.variable,onChange:E=>P(x,{variable:E.target.value})})}),t.jsx(O,{span:7,children:t.jsx(J,{placeholder:"Label",value:k.label,onChange:E=>P(x,{label:E.target.value})})}),t.jsx(O,{span:5,children:t.jsx(J,{placeholder:"#6366f1",value:k.color,onChange:E=>P(x,{color:E.target.value})})}),t.jsx(O,{span:5,children:t.jsx(ee,{value:k.axis_id,onChange:E=>P(x,{axis_id:E}),options:cu,style:{width:"100%"}})})]})},x)),t.jsx(q,{type:"dashed",icon:t.jsx($t,{}),onClick:()=>g(k=>[...k,Ns()]),block:!0,style:{marginBottom:16},children:"Add Y-Axis"}),t.jsx("div",{style:{...xe,fontSize:13,marginBottom:8},children:"Thresholds (Reference Lines)"}),_.map((k,x)=>t.jsx(z,{size:"small",className:"glass-panel",style:{marginBottom:8},children:t.jsxs(re,{gutter:8,children:[t.jsx(O,{span:8,children:t.jsx(J,{type:"number",placeholder:"Value",value:k.value,onChange:E=>{const $=[..._];$[x]={...$[x],value:Number(E.target.value)},R($)}})}),t.jsx(O,{span:8,children:t.jsx(J,{placeholder:"Label",value:k.label,onChange:E=>{const $=[..._];$[x]={...$[x],label:E.target.value},R($)}})}),t.jsx(O,{span:5,children:t.jsx(J,{placeholder:"#ef4444",value:k.color,onChange:E=>{const $=[..._];$[x]={...$[x],color:E.target.value},R($)}})}),t.jsx(O,{span:3,children:t.jsx(q,{type:"text",danger:!0,size:"small",icon:t.jsx(cn,{}),onClick:()=>R(_.filter((E,$)=>$!==x))})})]})},x)),t.jsx(q,{type:"dashed",size:"small",icon:t.jsx($t,{}),onClick:()=>R([..._,{value:0,label:"",color:"#ef4444"}]),style:{marginBottom:16},children:"Add Threshold"}),t.jsxs(re,{gutter:16,style:{marginBottom:16},children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"format_suffix",label:t.jsx("span",{style:xe,children:"Unit Suffix"}),children:t.jsx(J,{placeholder:"%, km, hours"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{name:"format_precision",label:t.jsx("span",{style:xe,children:"Precision"}),children:t.jsx(ee,{options:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"}],placeholder:"Auto",allowClear:!0})})})]}),u&&t.jsxs(t.Fragment,{children:[t.jsx(qs,{titlePlacement:"left",style:{...xe,fontSize:13},children:"Preview Result"}),t.jsx(z,{size:"small",className:"glass-panel",children:u.error?t.jsx("span",{style:{color:"var(--danger)"},children:u.error}):t.jsxs("div",{children:[t.jsx("span",{style:{fontFamily:"var(--font-mono)",color:"var(--text-muted)",marginRight:8},children:"Value:"}),t.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,fontSize:18,color:"var(--accent-strong)"},children:u.value!=null?u.value.toLocaleString():"â€”"}),u.groups&&u.groups.length>0&&t.jsxs("div",{style:{marginTop:8,fontSize:12,color:"var(--text-secondary)"},children:[u.groups.length," group(s) returned"]})]})})]})]})})}const{Text:yn}=Ja,{Dragger:uu}=hi,hu={dashboards:[{dashboard_id:"demo-quality",name:"Quality Metrics",description:"Issue quality analysis dashboard",kpis:[{name:"Issues by Severity",data_source:"issue",variables:[{name:"count",source_entity:"issue",field:"issue_id",aggregation:"count"}],formula:"count",group_by:["severity"],vchart_spec:{type:"pie",categoryField:"severity",valueField:"value",legends:{visible:!0,orient:"right"},label:{visible:!0}}},{name:"Issues by Category (Bar)",data_source:"issue",variables:[{name:"total",source_entity:"issue",field:"issue_id",aggregation:"count"}],formula:"total",group_by:["category"],vchart_spec:{type:"bar",xField:"category",yField:"value",label:{visible:!0,position:"top"}}},{name:"Issue Status Distribution",data_source:"issue",variables:[{name:"cnt",source_entity:"issue",field:"issue_id",aggregation:"count"}],formula:"cnt",group_by:["status"],vchart_spec:{type:"rose",categoryField:"status",valueField:"value",legends:{visible:!0}}}]},{dashboard_id:"demo-fleet",name:"Fleet Analytics",kpis:[{name:"Mileage by Task Type",data_source:"run",variables:[{name:"mileage",source_entity:"run",field:"total_auto_mileage_km",aggregation:"sum"}],formula:"mileage",group_by:["status"],vchart_spec:{type:"bar",xField:"status",yField:"value",seriesField:"status",label:{visible:!0}}}]}]};function mu({open:e,onClose:s,onImported:n}){const a=qe(),[r,i]=m.useState(null),[l,o]=m.useState(null),[d,u]=m.useState(null),c=fe({mutationFn:v=>yd(v),onSuccess:v=>{u(v),a.invalidateQueries({queryKey:["kpi-definitions"]}),Z.success(`Imported ${v.summary.created} KPIs, updated ${v.summary.updated}`)},onError:v=>{Z.error(v.message||"Import failed")}}),h=m.useCallback(v=>{o(null),i(null),u(null);const b=new FileReader;return b.onload=_=>{var R;try{const C=JSON.parse((R=_.target)==null?void 0:R.result);if(!C.dashboards||!Array.isArray(C.dashboards)){o('JSON must contain a "dashboards" array at the top level.');return}const w=C.dashboards.map(P=>({id:P.dashboard_id??"(unnamed)",name:P.name??"(unnamed)",kpiCount:Array.isArray(P.kpis)?P.kpis.length:0}));i({raw:C,dashboardCount:C.dashboards.length,totalKpis:w.reduce((P,j)=>P+j.kpiCount,0),dashboards:w})}catch{o("Invalid JSON file. Please check the syntax.")}},b.readAsText(v),!1},[]),y=()=>{const v=new Blob([JSON.stringify(hu,null,2)],{type:"application/json"}),b=URL.createObjectURL(v),_=document.createElement("a");_.href=b,_.download="kpi-dashboard-example.json",_.click(),URL.revokeObjectURL(b)},f=()=>{i(null),o(null),u(null),s()},g=()=>{r!=null&&r.raw&&c.mutate(r.raw)};return t.jsxs(as,{open:e,title:t.jsxs(H,{children:[t.jsx(nc,{size:16,style:{color:"var(--accent)"}}),t.jsx("span",{className:"font-display",style:{fontWeight:600},children:"Import KPI Dashboards"})]}),onCancel:f,width:640,footer:d?t.jsx(q,{type:"primary",onClick:()=>{f(),n()},children:"Done"}):t.jsxs(H,{children:[t.jsx(q,{onClick:f,children:"Cancel"}),t.jsxs(q,{type:"primary",onClick:g,disabled:!r||c.isPending,loading:c.isPending,children:["Import ",r?`(${r.totalKpis} KPIs)`:""]})]}),children:[!d&&t.jsxs(t.Fragment,{children:[t.jsx(uu,{accept:".json",showUploadList:!1,beforeUpload:h,style:{background:"var(--bg-glass)",borderColor:"var(--glass-border-light)",borderStyle:"dashed",borderRadius:16},children:t.jsxs("div",{style:{padding:"20px 0"},children:[t.jsx($r,{size:32,style:{color:"var(--accent)",marginBottom:10}}),t.jsx("p",{style:{color:"var(--text-primary)",fontSize:12,marginBottom:4},children:"Drop JSON file here or click to browse"}),t.jsx("p",{style:{color:"var(--text-muted)",fontSize:11},children:"Supports batch import of multiple dashboards with VChart specs"})]})}),t.jsx("div",{style:{marginTop:12,textAlign:"right"},children:t.jsx(q,{type:"link",size:"small",icon:t.jsx(tc,{size:12}),onClick:y,style:{color:"var(--accent-strong)",fontSize:11},children:"Download sample JSON"})}),l&&t.jsx(jt,{type:"error",showIcon:!0,icon:t.jsx(ec,{size:16}),message:l,style:{marginTop:12}}),r&&t.jsxs("div",{style:{marginTop:16},children:[t.jsx(jt,{type:"success",showIcon:!0,icon:t.jsx(On,{size:16}),message:`Parsed ${r.dashboardCount} dashboard(s), ${r.totalKpis} KPI(s)`}),t.jsx(Ya,{ghost:!0,style:{marginTop:8},items:r.dashboards.map(v=>({key:v.id,label:t.jsxs(H,{children:[t.jsx(yn,{style:{color:"var(--text-primary)"},children:v.name}),t.jsxs(K,{color:"cyan",children:[v.kpiCount," KPIs"]})]}),children:t.jsxs(yn,{style:{color:"var(--text-muted)",fontSize:11},children:["Dashboard ID: ",t.jsx("code",{children:v.id})]})}))})]})]}),d&&t.jsxs("div",{children:[t.jsx(jt,{type:d.summary.failed>0?"warning":"success",showIcon:!0,icon:d.summary.failed>0?t.jsx(Dr,{size:16}):t.jsx(On,{size:16}),message:`Created: ${d.summary.created}, Updated: ${d.summary.updated}, Failed: ${d.summary.failed}`}),d.results.map(v=>t.jsxs("div",{style:{marginTop:12},children:[t.jsx(yn,{strong:!0,style:{color:"var(--text-primary)"},children:v.dashboard_id}),t.jsxs("div",{style:{marginLeft:12,marginTop:4},children:[v.created.length>0&&t.jsx("div",{children:v.created.map(b=>t.jsx(K,{color:"green",children:b},b))}),v.failed.length>0&&t.jsx("div",{style:{marginTop:4},children:v.failed.map((b,_)=>t.jsx(jt,{type:"error",message:`${b.name}: ${b.error}`,style:{marginBottom:4,fontSize:12},banner:!0},_))})]})]},v.dashboard_id))]})]})}const pu="modulepreload",fu=function(e){return"/"+e},Ea={},yu=function(s,n,a){let r=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=l(n.map(u=>{if(u=fu(u),u in Ea)return;Ea[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const y=document.createElement("link");if(y.rel=c?"stylesheet":pu,c||(y.as="script"),y.crossOrigin="",y.href=u,d&&y.setAttribute("nonce",d),document.head.appendChild(y),c)return new Promise((f,g)=>{y.addEventListener("load",f),y.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return r.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return s().catch(i)})},Gr=["#8b929a","#60a5fa","#34d399","#fbbf24","#f87171","#a78bfa","#fb923c","#22d3ee","#e879f9","#4ade80"],gu={background:"transparent",colorScheme:{default:Gr},series:{bar:{style:{fillOpacity:.85}},line:{style:{lineWidth:2}},area:{style:{fillOpacity:.2}},pie:{style:{stroke:"rgba(255,255,255,0.06)",lineWidth:1}}},component:{axis:{domainLine:{style:{stroke:"rgba(255,255,255,0.1)"}},grid:{style:{stroke:"rgba(255,255,255,0.05)",lineDash:[3,3]}},label:{style:{fill:"#505660",fontSize:10}},title:{style:{fill:"#8b929a",fontSize:11}}},legend:{item:{label:{style:{fill:"#8b929a",fontSize:10}}}},tooltip:{panel:{style:{background:"rgba(24,25,30,0.95)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)"}},titleLabel:{style:{fill:"#e4e7eb",fontSize:11}},contentLabel:{style:{fill:"#8b929a",fontSize:10}},contentValue:{style:{fill:"#e4e7eb",fontSize:10}}}}};let gt=null;const xu=async()=>gt||(gt=(await yu(()=>import("./index-CKCHFLk5.js"),__vite__mapDeps([0,1,2]))).default,gt);function vu({spec:e,data:s,title:n,height:a=340,loading:r}){const i=m.useRef(null),l=m.useRef(null),[o,d]=m.useState(!!gt);m.useEffect(()=>{gt||xu().then(()=>d(!0))},[]);const u=m.useMemo(()=>{const c={...e};return s&&s.length>0&&(Array.isArray(c.data)?c.data=c.data.map((h,y)=>y===0?{...h,values:s}:h):c.data&&typeof c.data=="object"?c.data={...c.data,values:s}:c.data={id:"kpiData",values:s}),c.background="transparent",c.padding=c.padding??12,c.width=void 0,c.height=a,c.color||(c.color=Gr),c.theme={...gu},c},[e,s,a]);return m.useEffect(()=>{if(!i.current||!o||!gt)return;if(l.current){l.current.updateSpec(u);return}const c=new gt(u,{dom:i.current});return c.renderSync(),l.current=c,()=>{c.release(),l.current=null}},[u,o]),r||!o?t.jsx(z,{className:"glass-panel",children:t.jsx("div",{style:{display:"flex",justifyContent:"center",padding:40},children:t.jsx(Ot,{})})}):!e||!e.type?t.jsx(z,{className:"glass-panel",children:t.jsx(le,{description:"Invalid VChart spec"})}):t.jsx(z,{className:"glass-panel",title:n?t.jsx("span",{className:"font-display",style:{fontWeight:600},children:n}):void 0,children:t.jsx("div",{ref:i,style:{width:"100%",height:a}})})}function Ma(e){return e>=80?"#34d399":e>=50?"#fbbf24":"#f87171"}function ju({projectId:e,startDate:s,endDate:n,interval:a}){const r={project_id:e,start_date:s||void 0,end_date:n||void 0},{data:i}=B({queryKey:["kpi-mpi",e,s,n],queryFn:()=>sd(r),enabled:!!e}),{data:l}=B({queryKey:["kpi-mttr",e,s,n],queryFn:()=>nd(r),enabled:!!e}),{data:o}=B({queryKey:["kpi-rpr",e],queryFn:()=>ad({project_id:e}),enabled:!!e}),{data:d}=B({queryKey:["kpi-fleet",e,s,n],queryFn:()=>rd(r),enabled:!!e}),{data:u}=B({queryKey:["kpi-convergence",e,s,n,a],queryFn:()=>id({...r,interval:a}),enabled:!!e}),c=m.useMemo(()=>{var f;return((f=u==null?void 0:u.points)==null?void 0:f.map(g=>{var v,b;return{timestamp:g.timestamp,open:Number(((v=g.dimensions)==null?void 0:v.open_count)??g.value??0),closed:Number(((b=g.dimensions)==null?void 0:b.closed_count)??0)}}))??[]},[u]),h=[{title:"Miles Per Intervention",value:i==null?void 0:i.value,unit:"km"},{title:"Mean Time To Resolution",value:l==null?void 0:l.value,unit:"hours"}],y=[{title:"Regression Pass Rate",value:o==null?void 0:o.value,unit:"%"},{title:"Fleet Utilization",value:d==null?void 0:d.value,unit:"%"}];return t.jsxs(t.Fragment,{children:[t.jsxs(re,{gutter:[16,16],style:{marginBottom:24},children:[h.map(f=>t.jsx(O,{xs:24,sm:12,lg:6,children:t.jsx(z,{className:"glass-panel",style:{height:"100%"},children:t.jsx(Nt,{title:t.jsx("span",{className:"font-display",style:{fontWeight:600,fontSize:9,textTransform:"uppercase",letterSpacing:"0.06em"},children:f.title}),value:f.value!=null?Number(f.value):void 0,precision:1,suffix:t.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:f.unit}),valueStyle:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--accent-strong)"}})})},f.title)),y.map(f=>{const g=f.value!=null?Number(f.value):null;return t.jsx(O,{xs:24,sm:12,lg:6,children:t.jsxs(z,{className:"glass-panel",style:{height:"100%"},children:[t.jsx("div",{className:"font-display",style:{fontWeight:600,fontSize:9,color:"var(--text-muted)",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.06em"},children:f.title}),t.jsxs("div",{style:{fontFamily:"var(--font-mono)",fontSize:24,fontWeight:700,color:g!=null?Ma(g):"var(--text-primary)",marginBottom:8},children:[g!=null?g.toFixed(1):"â€”",t.jsx("span",{style:{fontSize:12,color:"var(--text-muted)",marginLeft:4},children:f.unit})]}),t.jsx(er,{percent:g!=null?Math.min(100,Math.max(0,g)):0,showInfo:!1,strokeColor:g!=null?Ma(g):"#34d399",size:"small"})]})},f.title)})]}),t.jsx(z,{className:"glass-panel",title:t.jsx("span",{className:"font-display",style:{fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Issue Convergence"}),children:c.length>0?t.jsx(Ft,{width:"100%",height:300,children:t.jsxs(sr,{data:c,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"openGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#f87171",stopOpacity:.2}),t.jsx("stop",{offset:"100%",stopColor:"#f87171",stopOpacity:0})]}),t.jsxs("linearGradient",{id:"closedGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#34d399",stopOpacity:.2}),t.jsx("stop",{offset:"100%",stopColor:"#34d399",stopOpacity:0})]})]}),t.jsx(rs,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),t.jsx(vt,{dataKey:"timestamp",tick:{fontSize:10,fill:"#505660"},tickFormatter:f=>new Date(f).toLocaleDateString(),stroke:"rgba(255,255,255,0.06)"}),t.jsx(Ve,{tick:{fontSize:10,fill:"#505660"},stroke:"rgba(255,255,255,0.06)"}),t.jsx(Ae,{labelFormatter:f=>new Date(f).toLocaleDateString(),contentStyle:{background:"rgba(24,25,30,0.95)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:12,color:"#e4e7eb"}}),t.jsx(at,{}),t.jsx(gn,{type:"monotone",dataKey:"open",stroke:"#f87171",fill:"url(#openGrad)",name:"Open",strokeWidth:2}),t.jsx(gn,{type:"monotone",dataKey:"closed",stroke:"#34d399",fill:"url(#closedGrad)",name:"Closed",strokeWidth:2})]})}):t.jsx(le,{description:"No convergence data available"})})]})}function bu({def:e,projectId:s}){var o,d,u,c,h,y,f;const n={};s&&(n.project_id=s);const{data:a,isLoading:r}=B({queryKey:["kpi-custom",e.kpi_id,s],queryFn:()=>pd(e.kpi_id,n),enabled:e.enabled}),i=e.renderer==="vchart"&&e.vchart_spec,l=((o=e.visualization)==null?void 0:o.chart_type)??"stat";if(i&&e.vchart_spec){const g=a!=null&&a.groups?a.groups.map(v=>({...v.group,value:v.value})):(a==null?void 0:a.value)!=null?[{value:a.value}]:[];return t.jsx(vu,{spec:e.vchart_spec,data:g,title:e.name,loading:r})}if(l==="stat")return t.jsx(Ta,{title:e.name,value:(a==null?void 0:a.value)??null,loading:r});if(l==="table"&&(a!=null&&a.groups))return t.jsx(z,{className:"glass-panel",title:t.jsx("span",{className:"font-display",style:{fontWeight:600},children:e.name}),children:t.jsx(nu,{groups:a.groups})});if(a!=null&&a.groups&&a.groups.length>0){const g=a.groups.map(R=>({...R.group,value:R.value})),v=((u=(d=e.visualization)==null?void 0:d.x_axis)==null?void 0:u.field)??Object.keys(((c=a.groups[0])==null?void 0:c.group)??{})[0]??"group",b=((y=(h=e.visualization)==null?void 0:h.y_axes)==null?void 0:y.map(R=>({key:R.variable??"value",label:R.label,color:R.color,axisId:R.axis_id})))??[{key:"value",label:e.name}],_=(f=e.visualization)==null?void 0:f.thresholds;return t.jsx(z,{className:"glass-panel",title:t.jsx("span",{className:"font-display",style:{fontWeight:600},children:e.name}),children:t.jsx(su,{chartType:l,data:g,xField:v,yFields:b,thresholds:_})})}return t.jsx(Ta,{title:e.name,value:(a==null?void 0:a.value)??null,loading:r})}function Su(){const e=qe(),[s,n]=m.useState(""),[a,r]=m.useState(""),[i,l]=m.useState(""),[o,d]=m.useState("day"),[u,c]=m.useState(!0),[h,y]=m.useState(!1),[f,g]=m.useState(!1),[v,b]=m.useState(),{data:_}=B({queryKey:["projects"],queryFn:()=>us({})}),{data:R}=B({queryKey:["kpi-definitions"],queryFn:dd}),C=fe({mutationFn:P=>md(P),onSuccess:()=>e.invalidateQueries({queryKey:["kpi-definitions"]})}),w=m.useMemo(()=>{if(!R)return new Map;const P=new Map;for(const j of R.filter(S=>S.enabled)){const S=j.dashboard_id??"__ungrouped__",I=P.get(S)??[];I.push(j),P.set(S,I)}return P},[R]);return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24,flexWrap:"wrap",gap:16},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx(Mr,{size:24,style:{color:"var(--text-secondary)"}}),t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:"KPI Overview"}),t.jsx("p",{className:"page-subtitle",children:"Key performance indicators for autonomous driving test campaigns"})]})]}),t.jsxs(H,{wrap:!0,children:[t.jsx(ee,{value:s||void 0,onChange:n,placeholder:"Select Project",style:{width:200},allowClear:!0,options:_==null?void 0:_.map(P=>({value:P.id,label:P.name}))}),t.jsx(xs,{placeholder:"Start date",onChange:(P,j)=>r(typeof j=="string"?j:""),style:{width:140}}),t.jsx(xs,{placeholder:"End date",onChange:(P,j)=>l(typeof j=="string"?j:""),style:{width:140}}),t.jsx(ee,{value:o,onChange:P=>d(P),style:{width:110},options:[{value:"day",label:"Daily"},{value:"week",label:"Weekly"},{value:"month",label:"Monthly"}]})]})]}),t.jsx(z,{className:"glass-panel",style:{marginBottom:24},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-display",style:{fontWeight:600,fontSize:13,marginBottom:4,textTransform:"uppercase",letterSpacing:"0.06em"},children:"Panel Configuration"}),t.jsxs(H,{children:[t.jsx("span",{style:{color:"var(--text-muted)",fontSize:12},children:"Built-in metrics"}),t.jsx(Xa,{size:"small",checked:u,onChange:c})]})]}),t.jsxs(H,{children:[t.jsx(q,{icon:t.jsx($r,{size:14}),onClick:()=>g(!0),style:{borderColor:"var(--glass-border-light)",color:"var(--accent-strong)"},children:"Import JSON"}),t.jsx(q,{type:"primary",icon:t.jsx(Nr,{size:14}),onClick:()=>{b(void 0),y(!0)},children:"Add Custom KPI"})]})]})}),!s&&t.jsxs(z,{className:"glass-panel",style:{textAlign:"center",padding:"40px 0"},children:[t.jsx(pc,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:16}}),t.jsx("p",{style:{color:"var(--text-muted)",fontSize:14},children:"Select a project to view KPI metrics"})]}),s&&t.jsxs(t.Fragment,{children:[u&&t.jsx(ju,{projectId:s,startDate:a,endDate:i,interval:o}),w.size>0&&t.jsxs("div",{style:{marginTop:24},children:[t.jsx("div",{className:"font-display",style:{fontWeight:600,fontSize:12,marginBottom:12,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.04em"},children:"Custom KPIs"}),Array.from(w.entries()).map(([P,j])=>{var k;const S=(k=j[0])==null?void 0:k.dashboard_name,I=P!=="__ungrouped__",F=t.jsx(re,{gutter:[16,16],children:j.map(x=>{var $;const E=x.renderer==="vchart"||(($=x.visualization)==null?void 0:$.chart_type)!=="stat";return t.jsx(O,{xs:24,md:E?24:8,children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx(bu,{def:x,projectId:s}),t.jsxs("div",{style:{position:"absolute",top:8,right:8,display:"flex",gap:4},children:[t.jsx(q,{size:"small",type:"text",icon:t.jsx(Lr,{size:12}),onClick:()=>{b(x),y(!0)},style:{color:"var(--text-muted)"}}),t.jsx(Za,{title:"Delete this KPI?",onConfirm:()=>C.mutate(x.kpi_id),okText:"Delete",cancelText:"Cancel",children:t.jsx(q,{size:"small",type:"text",danger:!0,icon:t.jsx(Js,{size:12})})})]})]})},x.kpi_id)})});return I?t.jsx(Ya,{ghost:!0,defaultActiveKey:[P],style:{marginBottom:16},items:[{key:P,label:t.jsxs(H,{children:[t.jsx("span",{style:{color:"#e2e8f0",fontWeight:600},children:S??P}),t.jsxs(K,{color:"cyan",children:[j.length," KPIs"]}),j.some(x=>x.renderer==="vchart")&&t.jsx(K,{color:"magenta",children:"VChart"})]}),children:F}]},P):t.jsx("div",{children:F},P)})]})]}),t.jsx(du,{open:h,onClose:()=>{y(!1),b(void 0)},onSaved:()=>{e.invalidateQueries({queryKey:["kpi-definitions"]}),y(!1),b(void 0)},editingDef:v}),t.jsx(mu,{open:f,onClose:()=>g(!1),onImported:()=>e.invalidateQueries({queryKey:["kpi-definitions"]})})]})}const Aa={requirement:"#3b82f6",commit:"#64748b",build:"#f59e0b",project:"#6366f1",task:"#8b5cf6",run:"#22c55e",issue:"#ef4444"},ku={requirement:"REQ",commit:"CMT",build:"BLD",project:"PRJ",task:"TSK",run:"RUN",issue:"ISS"};function _u(){const[e,s]=m.useState("forward"),[n,a]=m.useState(""),[r,i]=m.useState(""),{data:l,isLoading:o}=B({queryKey:["trace-forward",r],queryFn:()=>Zc(r),enabled:e==="forward"&&!!r}),{data:d,isLoading:u}=B({queryKey:["trace-backward",r],queryFn:()=>ed(r),enabled:e==="backward"&&!!r}),{data:c}=B({queryKey:["trace-coverage"],queryFn:()=>td()}),h=()=>{i(n.trim())},y=e==="forward"?l:d,f=e==="forward"?o:u,g=(y==null?void 0:y.links)??[];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[t.jsx(ac,{size:28,style:{color:"var(--accent)"}}),t.jsx("h1",{className:"page-title",children:"Traceability"})]}),t.jsx("p",{className:"page-subtitle",style:{marginBottom:24},children:"End-to-end links between requirements, tasks, runs, and issues for coverage and impact analysis."}),c&&t.jsxs(z,{className:"glass-panel",style:{marginBottom:24},children:[t.jsx("div",{style:{fontFamily:"var(--font-mono)",fontWeight:500,fontSize:11,color:"var(--text-muted)",marginBottom:10,textTransform:"uppercase",letterSpacing:"0.04em"},children:"Requirement Verification Coverage"}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:20},children:[t.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:24,fontWeight:700,color:"var(--accent-strong)"},children:c.percentage!=null?`${Number(c.percentage).toFixed(1)}%`:"â€”"}),t.jsx("div",{style:{flex:1},children:t.jsx(er,{percent:Number(c.percentage??0),showInfo:!1,strokeColor:{from:"#34d399",to:"#059669"}})}),t.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",whiteSpace:"nowrap"},children:[c.covered??0," / ",c.total??0," verified"]})]})]}),t.jsx(Ga,{activeKey:e,onChange:v=>{s(v),i(""),a("")},items:[{key:"forward",label:"Forward Trace"},{key:"backward",label:"Backward Trace"}],style:{marginBottom:16}}),t.jsxs(H.Compact,{style:{width:"100%",maxWidth:500,marginBottom:24},children:[t.jsx(J,{value:n,onChange:v=>a(v.target.value),placeholder:e==="forward"?"Enter Requirement ID...":"Enter Issue ID...",onPressEnter:h,size:"large"}),t.jsx(q,{type:"primary",icon:t.jsx(Zs,{}),onClick:h,disabled:!n.trim(),size:"large",children:"Trace"})]}),f&&t.jsx(Fs,{}),y&&y.nodes&&y.nodes.length>0&&t.jsx(z,{className:"glass-panel",title:t.jsxs("span",{className:"font-display",style:{fontWeight:600},children:[e==="forward"?"Forward":"Backward"," Trace from"," ",t.jsx("code",{style:{color:"var(--accent-strong)"},children:y.origin_id})]}),children:t.jsx(Qa,{items:y.nodes.map((v,b)=>{const _=v.type,R=b<g.length?g[b]:null;return{dot:t.jsx("div",{style:{width:32,height:32,borderRadius:"50%",background:Aa[_]??"#64748b",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:700,color:"#fff",fontFamily:"var(--font-mono)",boxShadow:`0 0 12px ${Aa[_]??"#64748b"}20`},children:ku[_]??"?"}),children:t.jsxs("div",{style:{paddingBottom:8},children:[t.jsx("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:v.label||v.id}),t.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[_," Â· ",t.jsx("code",{children:v.id})]}),R&&t.jsx(K,{style:{marginTop:4,fontSize:11,fontStyle:"italic"},children:R.relationship})]})}})})}),r&&!f&&y&&(!y.nodes||y.nodes.length===0)&&t.jsx(z,{className:"glass-panel",children:t.jsx(le,{description:`No trace results found for "${r}"`})})]})}function Cu(){return t.jsx(Fd,{icon:Zo,iconColor:"#818cf8",title:"Auto-Triage",description:"Intelligent automated issue classification and assignment powered by rule engine and ML models.",featuresLabel:"Planned Capabilities",features:["Rule-based classification","ML severity prediction","Auto-assignment to team","Historical pattern matching"]})}const Ds=["#6366f1","#22c55e","#f59e0b","#ef4444","#3b82f6","#ec4899","#14b8a6","#a855f7"],wu=(e,s)=>ts.divIcon({className:"",html:`<div style="width:20px;height:20px;border-radius:50%;background:${e};border:2px solid #fff;box-shadow:0 1px 4px rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:bold;color:#fff">${s+1}</div>`,iconSize:[20,20],iconAnchor:[10,10]});function Iu({onAdd:e}){return Ri({click(s){e(s.latlng.lat,s.latlng.lng)}}),null}function Ru({routes:e,onChange:s,mode:n,startPoint:a}){const[r,i]=m.useState(!1),[l,o]=m.useState(-1),[d,u]=m.useState(!1),c=e.length>0&&e[0].waypoints.length>0?[e[0].waypoints[0].lat,e[0].waypoints[0].lng]:a?[a.lat,a.lng]:[31.23,121.47],h=n==="custom"||d,y=l>=0&&l<e.length?l:e.length>0?e.length-1:-1,f=m.useCallback((S,I)=>{if(!h)return;const F=[...e];if(F.length===0)F.push({route_id:`ROUTE-${Date.now().toString(36)}`,name:"Route 1",waypoints:[{lat:S,lng:I}]});else{const k=y>=0?y:F.length-1,x={...F[k],waypoints:[...F[k].waypoints,{lat:S,lng:I}]};delete x.road,F[k]=x}s(F)},[e,s,h,y]),g=(S,I)=>{const F=[...e],k={...F[S],waypoints:F[S].waypoints.filter((x,E)=>E!==I)};delete k.road,F[S]=k,s(F)},v=(S,I,F,k)=>{const x=[...e],E=[...x[S].waypoints];E[I]={lat:F,lng:k};const $={...x[S],waypoints:E};delete $.road,x[S]=$,s(x)},b=()=>{const S=e.length;s([...e,{route_id:`ROUTE-${Date.now().toString(36)}`,name:`Route ${S+1}`,waypoints:[]}]),o(S)},_=S=>{s(e.filter((I,F)=>F!==S)),l>=e.length-1&&o(Math.max(0,e.length-2))},R=async()=>{if(e.filter(I=>I.waypoints.length>=2).length===0){Z.warning("Each route needs at least 2 waypoints to plan a road route");return}i(!0);try{const I=await Rd(e);s(I.routes),Z.success(`${I.routes.length} route(s) snapped to real roads`)}catch(I){Z.error(`Road planning failed: ${I.message}`)}finally{i(!1)}},C=()=>{u(!d),!d&&e.length>0&&o(e.length-1)},w=e.some(S=>S.road),P=e.reduce((S,I)=>{var F;return S+(((F=I.road)==null?void 0:F.total_distance_m)??0)},0),j=e.reduce((S,I)=>{var F;return S+(((F=I.road)==null?void 0:F.total_duration_s)??0)},0);return e.length===0&&n==="random"?t.jsx("div",{style:{marginTop:16},children:t.jsx(le,{description:"Click 'Generate Routes' above to preview"})}):t.jsxs("div",{style:{marginTop:16},children:[t.jsx(Ot,{spinning:r,tip:"Snapping routes to real roads via OSRM...",children:t.jsx("div",{style:{height:400,marginBottom:12,position:"relative"},children:t.jsxs(Dn,{center:c,zoom:12,style:{height:"100%",width:"100%",borderRadius:8},children:[t.jsx($n,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"Â© CartoDB"}),h&&t.jsx(Iu,{onAdd:f}),e.map((S,I)=>{var $;const F=Ds[I%Ds.length],k=($=S.road)==null?void 0:$.coordinates,x=k??S.waypoints,E=I===y;return t.jsxs("span",{children:[t.jsx(vs,{positions:x.map(se=>[se.lat,se.lng]),pathOptions:{color:F,weight:k?4:3,opacity:E?.9:.4,dashArray:k?void 0:"8 4"}}),k&&S.waypoints.length>0&&t.jsx(vs,{positions:S.waypoints.map(se=>[se.lat,se.lng]),pathOptions:{color:F,weight:1,opacity:.3,dashArray:"4 4"}}),S.waypoints.map((se,ce)=>t.jsx(qn,{position:[se.lat,se.lng],icon:wu(F,ce),draggable:h,eventHandlers:{dragend:de=>{const it=de.target.getLatLng();v(I,ce,it.lat,it.lng)}},children:t.jsx(Kn,{children:t.jsxs("div",{style:{fontSize:12,minWidth:180},children:[t.jsx("strong",{children:S.name||S.route_id})," â€” WP ",ce+1,t.jsx("br",{}),t.jsxs(H,{size:4,style:{marginTop:4},children:[t.jsx(we,{size:"small",style:{width:90},step:1e-4,value:Number(se.lat.toFixed(5)),onChange:de=>de!=null&&v(I,ce,de,se.lng)}),t.jsx(we,{size:"small",style:{width:90},step:1e-4,value:Number(se.lng.toFixed(5)),onChange:de=>de!=null&&v(I,ce,se.lat,de)})]}),h&&t.jsx("div",{style:{marginTop:4},children:t.jsx(q,{size:"small",type:"text",danger:!0,icon:t.jsx(Js,{size:10}),onClick:()=>g(I,ce),children:"Remove"})})]})})},`wp-${S.route_id}-${ce}`)),x.length>0&&t.jsx(xn,{center:[x[0].lat,x[0].lng],radius:7,pathOptions:{color:"#fff",fillColor:F,fillOpacity:1,weight:2},children:t.jsxs(Ws,{children:[S.name||S.route_id," (Start)"]})}),x.length>1&&t.jsx(xn,{center:[x[x.length-1].lat,x[x.length-1].lng],radius:7,pathOptions:{color:"#fff",fillColor:"#ef4444",fillOpacity:1,weight:2},children:t.jsxs(Ws,{children:[S.name||S.route_id," (End)"]})})]},S.route_id)})]})})}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,flexWrap:"wrap",gap:8},children:[t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:[e.length," route(s) Â· ",h?"Click map to add waypoints Â· Drag to move":"View only",w&&t.jsxs("span",{style:{marginLeft:8},children:[t.jsx(Ha,{status:"success",text:"",style:{marginRight:4}}),"Road-planned Â· ",(P/1e3).toFixed(1)," km Â· ~",Math.round(j/60)," min"]})]}),t.jsxs("div",{style:{display:"flex",gap:8},children:[e.length>0&&e.some(S=>S.waypoints.length>=2)&&t.jsx(q,{size:"small",type:w?"default":"primary",icon:t.jsx(cc,{size:12}),loading:r,onClick:R,children:w?"Re-plan Roads":"Plan on Roads"}),n==="random"&&e.length>0&&t.jsx(q,{size:"small",type:d?"primary":"default",icon:d?t.jsx(yc,{size:12}):t.jsx(Lr,{size:12}),onClick:C,children:d?"Done Editing":"Edit Waypoints"}),h&&t.jsx(q,{size:"small",icon:t.jsx(zr,{size:12}),onClick:b,children:"New Route"})]})]}),t.jsx(oa,{size:"small",dataSource:e,renderItem:(S,I)=>{const F=I===y&&h;return t.jsx(oa.Item,{style:{cursor:h?"pointer":void 0,background:F?"rgba(99,102,241,0.1)":void 0,borderRadius:4},onClick:()=>h&&o(I),actions:h?[t.jsx(q,{size:"small",type:"text",danger:!0,icon:t.jsx(Js,{size:12}),onClick:k=>{k.stopPropagation(),_(I)}})]:void 0,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[t.jsx(K,{color:Ds[I%Ds.length],children:S.name||S.route_id}),t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:[S.waypoints.length," waypoints"]}),S.road&&t.jsxs(Ja.Text,{type:"success",style:{fontSize:11},children:[(S.road.total_distance_m/1e3).toFixed(1)," km Â· ",S.road.coordinates.length," pts"]}),F&&t.jsx(K,{color:"processing",style:{fontSize:10},children:"Active"})]})})}})]})}function Pu({vehicles:e,projects:s,tasks:n,assignments:a,onChange:r}){const i=(c,h)=>a.some(y=>y.vin===c&&y.task_id===h),l=(c,h,y)=>{i(c,h)?r(a.filter(f=>!(f.vin===c&&f.task_id===h))):r([...a,{vin:c,project_id:y,task_id:h}])},o=()=>{if(n.length===0)return;const c=n[0],h=s.find(y=>y.id===c.projectId);h&&r(e.map(y=>({vin:y.vin,project_id:h.id,task_id:c.id})))},d=()=>{const c=[];e.forEach((h,y)=>{const f=n[y%n.length],g=s.find(v=>v.id===f.projectId);g&&c.push({vin:h.vin,project_id:g.id,task_id:f.id})}),r(c)},u=[{title:"Vehicle",dataIndex:"vin",key:"vin",fixed:"left",width:180,render:c=>t.jsx("code",{style:{fontSize:11},children:c})},...n.map(c=>{const h=s.find(y=>y.id===c.projectId);return{title:t.jsxs("div",{style:{textAlign:"center",fontSize:11},children:[t.jsx("div",{children:t.jsx(K,{color:"blue",style:{fontSize:10},children:(h==null?void 0:h.name)??c.projectId})}),t.jsx("div",{children:c.title})]}),key:c.id,width:140,render:(y,f)=>t.jsx("div",{style:{textAlign:"center"},children:t.jsx(mi,{checked:i(f.vin,c.id),onChange:()=>l(f.vin,c.id,c.projectId)})})}})];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:[a.length," assignment(s)"]}),t.jsxs(H,{size:"small",children:[t.jsx(q,{size:"small",onClick:o,children:"All â†’ First Task"}),t.jsx(q,{size:"small",onClick:d,children:"Round Robin"})]})]}),t.jsx(Se,{size:"small",dataSource:e,columns:u,rowKey:"vin",pagination:!1,scroll:{x:"max-content"}})]})}const Tu={Draft:"default",Running:"processing",Paused:"warning",Completed:"success",Aborted:"error"};function Fu(){var Ie;const e=zt(),s=qe(),[n,a]=m.useState(!1),[r,i]=m.useState(0),[l]=N.useForm(),[o,d]=m.useState("random"),[u,c]=m.useState("random"),[h,y]=m.useState(!0),[f,g]=m.useState([]),[v,b]=m.useState([]),[_,R]=m.useState([]),[C,w]=m.useState([]),[P,j]=m.useState([]),{data:S,isLoading:I}=B({queryKey:["simulations"],queryFn:()=>gd()}),{data:F}=B({queryKey:["projects"],queryFn:()=>us({})}),{data:k}=B({queryKey:["tasks"],queryFn:()=>Ps({})}),[x,E]=m.useState(!1),$=fe({mutationFn:T=>vd(T),onSuccess:async T=>{if(s.invalidateQueries({queryKey:["simulations"]}),a(!1),ms(),x&&T.session_id)try{await zn(T.session_id),s.invalidateQueries({queryKey:["simulations"]}),Z.success("Simulation created & started")}catch{Z.warning("Created but failed to start â€” start it manually")}else Z.success("Simulation saved as draft");E(!1)},onError:T=>{Z.error(`Failed to create simulation: ${T.message}`),E(!1)}}),se=fe({mutationFn:T=>jd(T),onSuccess:()=>{s.invalidateQueries({queryKey:["simulations"]}),Z.success("Deleted")}}),ce=fe({mutationFn:T=>zn(T),onSuccess:()=>{s.invalidateQueries({queryKey:["simulations"]}),Z.success("Simulation started")}}),de=fe({mutationFn:T=>Id(T),onSuccess:T=>g(T.vehicles)}),it=fe({mutationFn:T=>wd(T),onSuccess:T=>{b(T.routes);const ae=T.routes.some(G=>G.road);Z.success(`${T.routes.length} route(s) generated${ae?" with road planning":""}`)},onError:T=>Z.error(`Route generation failed: ${T.message}`)});function ms(){i(0),d("random"),c("random"),y(!0),g([]),b([]),R([]),w([]),j([]),l.resetFields()}function ps(){const T=l.getFieldsValue(!0),ae={name:T.name||"New Simulation",fleet_config:{mode:o,vehicle_count:T.vehicle_count??5,vehicles:o==="custom"?f:void 0,vehicle_template:o==="random"?{vehicle_platform:T.platform,soc_architecture:T.soc,sensor_suite_version:T.sensor}:void 0},route_config:{mode:u,routes:v.length>0?v.map(G=>({route_id:G.route_id,name:G.name,waypoints:G.waypoints,road:G.road?{total_distance_m:G.road.total_distance_m,total_duration_s:G.road.total_duration_s,coordinates:G.road.coordinates??[],segments:G.road.segments??[]}:void 0})):void 0,random_config:u==="random"?{start_point:{lat:T.start_lat??31.2304,lng:T.start_lng??121.4737},radius_km:T.radius_km??10,min_waypoints:T.min_waypoints??5,max_waypoints:T.max_waypoints??15}:void 0},report_config:{telemetry_interval_ms:(T.telemetry_interval??3)*1e3,issue_interval_range_ms:[(T.issue_min??30)*1e3,(T.issue_max??120)*1e3],status_change_interval_ms:(T.mode_switch??60)*1e3,speed_range_mps:[Math.round((T.speed_min??30)/3.6),Math.round((T.speed_max??120)/3.6)]},assignments:h?[]:_};$.mutate(ae)}const Es=[{title:"Name",dataIndex:"name",key:"name",render:(T,ae)=>t.jsx("a",{onClick:()=>e(`/simulation/${ae.session_id}`),children:T})},{title:"Status",dataIndex:"status",key:"status",render:T=>t.jsx(K,{color:Tu[T]||"default",children:T})},{title:"Vehicles",key:"vehicles",render:(T,ae)=>{var G,ze,ke;return((G=ae.fleet_config)==null?void 0:G.vehicle_count)??((ke=(ze=ae.fleet_config)==null?void 0:ze.vehicles)==null?void 0:ke.length)??0}},{title:"Telemetry Sent",key:"telemetry",render:(T,ae)=>{var G;return((G=ae.stats)==null?void 0:G.telemetry_sent)??0}},{title:"Issues Sent",key:"issues",render:(T,ae)=>{var G;return((G=ae.stats)==null?void 0:G.issues_sent)??0}},{title:"Mileage (km)",key:"mileage",render:(T,ae)=>{var G;return(((G=ae.stats)==null?void 0:G.total_mileage_km)??0).toFixed(1)}},{title:"Actions",key:"actions",render:(T,ae)=>t.jsxs(H,{size:"small",children:[t.jsx(q,{size:"small",icon:t.jsx(sc,{size:12}),onClick:()=>e(`/simulation/${ae.session_id}`)}),ae.status==="Draft"&&t.jsx(q,{size:"small",type:"primary",icon:t.jsx(an,{size:12}),onClick:()=>ce.mutate(ae.session_id)}),t.jsx(Za,{title:"Delete simulation?",onConfirm:()=>se.mutate(ae.session_id),children:t.jsx(q,{size:"small",danger:!0,icon:t.jsx(Js,{size:12})})})]})}],W=(k==null?void 0:k.filter(T=>C.includes(T.projectId)))??[],ne=[{title:"Fleet",content:t.jsxs("div",{children:[t.jsx(N.Item,{label:"Simulation Name",name:"name",rules:[{required:!0}],children:t.jsx(J,{placeholder:"My Fleet Simulation"})}),t.jsx(N.Item,{label:"Fleet Mode",children:t.jsxs(Lt.Group,{value:o,onChange:T=>d(T.target.value),children:[t.jsx(Lt.Button,{value:"random",children:"Random"}),t.jsx(Lt.Button,{value:"custom",children:"Custom"})]})}),o==="random"?t.jsxs(t.Fragment,{children:[t.jsx(N.Item,{label:"Vehicle Count",name:"vehicle_count",initialValue:5,children:t.jsx(dn,{min:1,max:100})}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Platform",name:"platform",children:t.jsx(J,{placeholder:"ORIN-X"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"SoC",name:"soc",children:t.jsx(J,{placeholder:"Orin-SoC-A"})})}),t.jsx(O,{span:8,children:t.jsx(N.Item,{label:"Sensor Suite",name:"sensor",children:t.jsx(J,{placeholder:"LiDAR-v4"})})})]}),t.jsx(q,{onClick:()=>de.mutate({count:l.getFieldValue("vehicle_count")??5,template:{vehicle_platform:l.getFieldValue("platform"),soc_architecture:l.getFieldValue("soc"),sensor_suite_version:l.getFieldValue("sensor")}}),loading:de.isPending,children:"Preview Fleet"}),f.length>0&&t.jsx(Se,{size:"small",dataSource:f,rowKey:"vin",columns:[{title:"VIN",dataIndex:"vin"},{title:"Platform",dataIndex:"vehicle_platform"},{title:"Model",dataIndex:"model_code"}],pagination:!1,style:{marginTop:12}})]}):t.jsx(Se,{size:"small",dataSource:f,rowKey:"vin",columns:[{title:"VIN",dataIndex:"vin",render:(T,ae,G)=>t.jsx(J,{size:"small",value:T,onChange:ze=>{const ke=[...f];ke[G]={...ke[G],vin:ze.target.value},g(ke)}})},{title:"Platform",dataIndex:"vehicle_platform",render:(T,ae,G)=>t.jsx(J,{size:"small",value:T,onChange:ze=>{const ke=[...f];ke[G]={...ke[G],vehicle_platform:ze.target.value},g(ke)}})},{title:"Model",dataIndex:"model_code",render:(T,ae,G)=>t.jsx(J,{size:"small",value:T,onChange:ze=>{const ke=[...f];ke[G]={...ke[G],model_code:ze.target.value},g(ke)}})}],pagination:!1,footer:()=>t.jsx(q,{size:"small",onClick:()=>g([...f,{vin:`SIM-${Date.now().toString(36)}`,plate_type:"temporary",model_code:"AD-SUV-01",vehicle_platform:"ORIN-X",sensor_suite_version:"LiDAR-v4",soc_architecture:"Orin-SoC-A"}]),children:"Add Vehicle"})})]})},{title:"Project/Task",content:t.jsxs("div",{children:[t.jsxs(N.Item,{label:"Use Default Project",children:[t.jsx(Xa,{checked:h,onChange:y}),t.jsx("span",{style:{marginLeft:8,color:"var(--text-muted)",fontSize:12},children:"Auto-create a simulation-specific project and task"})]}),!h&&t.jsxs(t.Fragment,{children:[t.jsx(N.Item,{label:"Select Projects",children:t.jsx(ee,{mode:"multiple",value:C,onChange:w,placeholder:"Select projects",options:(F==null?void 0:F.map(T=>({value:T.id,label:T.name})))??[],style:{width:"100%"}})}),t.jsx(N.Item,{label:"Select Tasks",children:t.jsx(ee,{mode:"multiple",value:P,onChange:j,placeholder:"Select tasks",options:W.map(T=>({value:T.id,label:`${T.title} (${T.taskType??T.stage})`}))??[],style:{width:"100%"}})}),f.length>0&&P.length>0&&t.jsx(Pu,{vehicles:f,projects:(F==null?void 0:F.filter(T=>C.includes(T.id)))??[],tasks:W.filter(T=>P.includes(T.id)),assignments:_,onChange:R})]})]})},{title:"Routes",content:t.jsxs("div",{children:[t.jsx(N.Item,{label:"Route Mode",children:t.jsxs(Lt.Group,{value:u,onChange:T=>c(T.target.value),children:[t.jsx(Lt.Button,{value:"random",children:"Random"}),t.jsx(Lt.Button,{value:"custom",children:"Custom"})]})}),u==="random"?t.jsxs(t.Fragment,{children:[t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:6,children:t.jsx(N.Item,{label:"Start Lat",name:"start_lat",initialValue:31.2304,children:t.jsx(we,{style:{width:"100%"},step:.001})})}),t.jsx(O,{span:6,children:t.jsx(N.Item,{label:"Start Lng",name:"start_lng",initialValue:121.4737,children:t.jsx(we,{style:{width:"100%"},step:.001})})}),t.jsx(O,{span:6,children:t.jsx(N.Item,{label:"Target Distance (km)",name:"target_distance_km",initialValue:500,tooltip:"Total road distance target. Set 0 to use radius mode.",children:t.jsx(we,{min:0,max:2e3,style:{width:"100%"}})})}),t.jsx(O,{span:6,children:t.jsx(N.Item,{label:"Radius (km)",name:"radius_km",initialValue:10,tooltip:"Only used when Target Distance is 0",children:t.jsx(we,{min:1,max:500,style:{width:"100%"}})})})]}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Min Waypoints",name:"min_waypoints",initialValue:3,children:t.jsx(we,{min:2,max:10,style:{width:"100%"}})})}),t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Max Waypoints",name:"max_waypoints",initialValue:8,children:t.jsx(we,{min:2,max:10,style:{width:"100%"}})})})]}),t.jsx(q,{onClick:()=>it.mutate({start_point:{lat:l.getFieldValue("start_lat")??31.2304,lng:l.getFieldValue("start_lng")??121.4737},radius_km:l.getFieldValue("radius_km")??10,count:f.length||l.getFieldValue("vehicle_count")||5,min_waypoints:l.getFieldValue("min_waypoints")??3,max_waypoints:l.getFieldValue("max_waypoints")??8,target_distance_km:l.getFieldValue("target_distance_km")??500}),loading:it.isPending,children:"Generate Routes"})]}):null,t.jsx(Ru,{routes:v,onChange:b,mode:u,startPoint:u==="random"?{lat:l.getFieldValue("start_lat")??31.2304,lng:l.getFieldValue("start_lng")??121.4737}:void 0})]})},{title:"Reporting",content:t.jsxs("div",{children:[t.jsx(N.Item,{label:"Telemetry Interval (seconds)",name:"telemetry_interval",initialValue:3,children:t.jsx(dn,{min:1,max:30})}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Issue Min Interval (sec)",name:"issue_min",initialValue:30,children:t.jsx(we,{min:5,max:600,style:{width:"100%"}})})}),t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Issue Max Interval (sec)",name:"issue_max",initialValue:120,children:t.jsx(we,{min:10,max:600,style:{width:"100%"}})})})]}),t.jsx(N.Item,{label:"Driving Mode Switch Interval (sec)",name:"mode_switch",initialValue:60,children:t.jsx(dn,{min:10,max:300})}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Min Speed (km/h)",name:"speed_min",initialValue:30,children:t.jsx(we,{min:5,max:200,style:{width:"100%"}})})}),t.jsx(O,{span:12,children:t.jsx(N.Item,{label:"Max Speed (km/h)",name:"speed_max",initialValue:120,children:t.jsx(we,{min:10,max:200,style:{width:"100%"}})})})]})]})},{title:"Review",content:t.jsx("div",{children:t.jsx(z,{className:"glass-panel",style:{marginBottom:16},children:t.jsxs(re,{gutter:[16,8],children:[t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Name:"})," ",l.getFieldValue("name")||"New Simulation"]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Fleet:"})," ",o==="random"?`${l.getFieldValue("vehicle_count")??5} random vehicles`:`${f.length} custom vehicles`]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Routes:"})," ",u==="random"?"Auto-generated":`${v.length} custom routes`]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Project:"})," ",h?"Auto-create":`${C.length} selected`]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Telemetry:"})," every ",l.getFieldValue("telemetry_interval")??3,"s"]}),t.jsxs(O,{span:12,children:[t.jsx("strong",{children:"Speed:"})," ",l.getFieldValue("speed_min")??30," - ",l.getFieldValue("speed_max")??120," km/h"]})]})})})}];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24,flexWrap:"wrap",gap:16},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx(lc,{size:28,style:{color:"#22c55e"}}),t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:"Fleet Simulation"}),t.jsx("p",{className:"page-subtitle",children:"Simulate vehicle fleets for demo and stress testing"})]})]}),t.jsx(q,{type:"primary",icon:t.jsx(Nr,{size:14}),onClick:()=>{ms(),a(!0)},children:"New Simulation"})]}),t.jsx(z,{className:"glass-panel",children:t.jsx(Se,{dataSource:S??[],columns:Es,rowKey:"session_id",loading:I,pagination:{pageSize:10},size:"middle"})}),t.jsxs(as,{open:n,onCancel:()=>a(!1),width:900,title:"Create Simulation",footer:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(q,{disabled:r===0,onClick:()=>i(r-1),children:"Previous"}),t.jsxs(H,{children:[r<ne.length-1&&t.jsx(q,{type:"primary",onClick:()=>i(r+1),children:"Next"}),r===ne.length-1&&t.jsxs(t.Fragment,{children:[t.jsx(q,{onClick:()=>{E(!1),ps()},loading:$.isPending&&!x,children:"Save as Draft"}),t.jsx(q,{type:"primary",onClick:()=>{E(!0),ps()},loading:$.isPending&&x,children:"Create & Start"})]})]})]}),destroyOnClose:!0,children:[t.jsx(pi,{current:r,items:ne.map(T=>({title:T.title})),style:{marginBottom:24},size:"small"}),t.jsx(N,{form:l,layout:"vertical",children:(Ie=ne[r])==null?void 0:Ie.content})]})]})}const Eu={Draft:"default",Running:"processing",Paused:"warning",Completed:"success",Aborted:"error"},Dt=["#22c55e","#3b82f6","#f59e0b","#ef4444","#ec4899","#14b8a6","#a855f7","#6366f1"],$s=["#6366f1","#22c55e","#f59e0b","#ef4444","#3b82f6","#ec4899","#14b8a6","#a855f7"];function Oa(e,s){return ts.divIcon({className:"",html:`<div style="width:22px;height:22px;display:flex;align-items:center;justify-content:center;transform:rotate(${s}deg)">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="${e}" stroke="#fff" stroke-width="1.5">
        <path d="M12 2L6 12l6 4 6-4z"/>
      </svg>
    </div>`,iconSize:[22,22],iconAnchor:[11,11]})}function Mu({vehicles:e}){const s=Pi(),n=m.useRef(new Map);return m.useEffect(()=>{const a=new Set;e.forEach((r,i)=>{if(!r.current)return;a.add(r.vin);const l=Dt[i%Dt.length],o=ts.latLng(r.current.lat,r.current.lng),d=r.current.heading_deg??0,u=n.current.get(r.vin);if(u)u.setLatLng(o),u.setIcon(Oa(l,d));else{const h=ts.marker(o,{icon:Oa(l,d)}).bindTooltip(`${r.vin}<br/>${(r.current.speed_mps*3.6).toFixed(0)} km/h Â· ${r.current.driving_mode}`,{direction:"top",offset:[0,-12]}).addTo(s);n.current.set(r.vin,h)}n.current.get(r.vin).setTooltipContent(`${r.vin}<br/>${(r.current.speed_mps*3.6).toFixed(0)} km/h Â· ${r.current.driving_mode}`)}),n.current.forEach((r,i)=>{a.has(i)||(r.remove(),n.current.delete(i))})},[e,s]),m.useEffect(()=>()=>{n.current.forEach(a=>a.remove()),n.current.clear()},[]),null}function Au(){var C,w,P,j,S,I,F,k,x,E,$,se,ce,de,it,ms,ps,Es;const{id:e}=cs(),s=zt(),n=qe(),{data:a,isLoading:r}=B({queryKey:["simulation",e],queryFn:()=>xd(e),enabled:!!e,refetchInterval:W=>{const ne=W.state.data;return(ne==null?void 0:ne.status)==="Running"?5e3:!1}}),{data:i}=B({queryKey:["simulation-stats",e],queryFn:()=>_d(e),enabled:!!e&&(a==null?void 0:a.status)==="Running",refetchInterval:3e3}),l=(a==null?void 0:a.status)==="Running",o=(a==null?void 0:a.status)==="Completed",{data:d}=B({queryKey:["simulation-vehicles",e],queryFn:()=>Cd(e,50),enabled:!!e&&(l||o),refetchInterval:l?3e3:!1}),u=()=>{n.invalidateQueries({queryKey:["simulation",e]}),n.invalidateQueries({queryKey:["simulation-stats",e]}),n.invalidateQueries({queryKey:["simulation-vehicles",e]}),n.invalidateQueries({queryKey:["simulations"]})},c=fe({mutationFn:()=>zn(e),onSuccess:()=>{u(),Z.success("Started")}}),h=fe({mutationFn:()=>bd(e),onSuccess:()=>{u(),Z.success("Paused")}}),y=fe({mutationFn:()=>Sd(e),onSuccess:()=>{u(),Z.success("Resumed")}}),f=fe({mutationFn:()=>kd(e),onSuccess:()=>{u(),Z.success("Stopped")}});if(r||!a)return t.jsx(z,{className:"glass-panel",loading:!0});const g=i??a.stats,v=((C=a.route_config)==null?void 0:C.routes)??[],b=(P=(w=a.route_config)==null?void 0:w.random_config)==null?void 0:P.start_point,_=d??[],R=(()=>{const W=_.find(ne=>ne.current);return W!=null&&W.current?[W.current.lat,W.current.lng]:v.length>0&&v[0].waypoints.length>0?[v[0].waypoints[0].lat,v[0].waypoints[0].lng]:b?[b.lat,b.lng]:[31.23,121.47]})();return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[t.jsx(q,{type:"text",icon:t.jsx(Xo,{size:18}),onClick:()=>s("/simulation")}),t.jsxs("div",{style:{flex:1},children:[t.jsx("h1",{className:"page-title",style:{marginBottom:0},children:a.name}),t.jsxs(H,{children:[t.jsx(K,{color:Eu[a.status],children:a.status}),a.started_at&&t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["Started: ",new Date(a.started_at).toLocaleString()]})]})]}),t.jsxs(H,{children:[(a.status==="Draft"||a.status==="Paused")&&t.jsx(q,{type:"primary",icon:t.jsx(an,{size:14}),onClick:()=>a.status==="Draft"?c.mutate():y.mutate(),loading:c.isPending||y.isPending,children:a.status==="Draft"?"Start":"Resume"}),a.status==="Running"&&t.jsxs(t.Fragment,{children:[t.jsx(q,{icon:t.jsx(dc,{size:14}),onClick:()=>h.mutate(),loading:h.isPending,children:"Pause"}),t.jsx(q,{danger:!0,icon:t.jsx(mc,{size:14}),onClick:()=>f.mutate(),loading:f.isPending,children:"Stop"})]})]})]}),t.jsxs(re,{gutter:[16,16],style:{marginBottom:24},children:[t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel",children:t.jsx(Nt,{title:"Vehicles",value:((j=a.fleet_config)==null?void 0:j.vehicle_count)??((I=(S=a.fleet_config)==null?void 0:S.vehicles)==null?void 0:I.length)??0,valueStyle:{fontFamily:"var(--font-mono)",color:"var(--accent-strong)"}})})}),t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel",children:t.jsx(Nt,{title:"Telemetry Sent",value:(g==null?void 0:g.telemetry_sent)??0,valueStyle:{fontFamily:"var(--font-mono)",color:"var(--success)"}})})}),t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel",children:t.jsx(Nt,{title:"Issues Reported",value:(g==null?void 0:g.issues_sent)??0,valueStyle:{fontFamily:"var(--font-mono)",color:"var(--warning)"}})})}),t.jsx(O,{xs:24,sm:6,children:t.jsx(z,{className:"glass-panel",children:t.jsx(Nt,{title:"Total Mileage",value:Number((g==null?void 0:g.total_mileage_km)??0).toFixed(1),suffix:"km",valueStyle:{fontFamily:"var(--font-mono)",color:"var(--success)"}})})})]}),t.jsxs(re,{gutter:[16,16],children:[t.jsx(O,{xs:24,lg:14,children:t.jsx(z,{className:"glass-panel",title:l?"Live Vehicle Map":"Route Map",style:{height:520},children:t.jsx("div",{style:{height:440},children:t.jsxs(Dn,{center:R,zoom:11,style:{height:"100%",width:"100%",borderRadius:8},children:[t.jsx($n,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"Â© CartoDB"}),v.map((W,ne)=>{var G;const Ie=$s[ne%$s.length],T=(G=W.road)==null?void 0:G.coordinates,ae=T??W.waypoints;return t.jsx(vs,{positions:ae.map(ze=>[ze.lat,ze.lng]),pathOptions:{color:Ie,weight:_.length>0?2:4,opacity:_.length>0?.25:.8,dashArray:T?void 0:"8 4"}},`route-${W.route_id}`)}),_.map((W,ne)=>{const Ie=Dt[ne%Dt.length];return W.trail.length<2?null:t.jsx(vs,{positions:W.trail.map(T=>[T.lat,T.lng]),pathOptions:{color:Ie,weight:4,opacity:.9}},`trail-${W.vin}`)}),_.length===0&&v.map((W,ne)=>{var ae;const Ie=$s[ne%$s.length],T=((ae=W.road)==null?void 0:ae.coordinates)??W.waypoints;return t.jsx("span",{children:T.length>0&&t.jsx(xn,{center:[T[0].lat,T[0].lng],radius:6,pathOptions:{color:"#fff",fillColor:Ie,fillOpacity:1,weight:2},children:t.jsxs(Ws,{children:[W.name||W.route_id," (Start)"]})})},`markers-${W.route_id}`)}),t.jsx(Mu,{vehicles:_})]})})})}),t.jsxs(O,{xs:24,lg:10,children:[t.jsx(z,{className:"glass-panel",title:"Configuration",style:{marginBottom:16},children:t.jsxs(A,{column:1,size:"small",labelStyle:{color:"var(--text-muted)"},children:[t.jsx(A.Item,{label:"Fleet Mode",children:(F=a.fleet_config)==null?void 0:F.mode}),t.jsx(A.Item,{label:"Route Mode",children:(k=a.route_config)==null?void 0:k.mode}),t.jsxs(A.Item,{label:"Routes",children:[v.length," route(s)",v.some(W=>W.road)?" (road-planned)":""]}),v.some(W=>W.road)&&t.jsxs(A.Item,{label:"Road Distance",children:[(v.reduce((W,ne)=>{var Ie;return W+(((Ie=ne.road)==null?void 0:Ie.total_distance_m)??0)},0)/1e3).toFixed(1)," km total"]}),t.jsxs(A.Item,{label:"Telemetry Interval",children:[(((x=a.report_config)==null?void 0:x.telemetry_interval_ms)??3e3)/1e3,"s"]}),t.jsxs(A.Item,{label:"Issue Interval",children:[((($=(E=a.report_config)==null?void 0:E.issue_interval_range_ms)==null?void 0:$[0])??3e4)/1e3,"s - ",(((ce=(se=a.report_config)==null?void 0:se.issue_interval_range_ms)==null?void 0:ce[1])??12e4)/1e3,"s"]}),t.jsxs(A.Item,{label:"Mode Switch",children:[(((de=a.report_config)==null?void 0:de.status_change_interval_ms)??6e4)/1e3,"s"]}),t.jsxs(A.Item,{label:"Speed Range",children:[Math.round((((ms=(it=a.report_config)==null?void 0:it.speed_range_mps)==null?void 0:ms[0])??8)*3.6)," - ",Math.round((((Es=(ps=a.report_config)==null?void 0:ps.speed_range_mps)==null?void 0:Es[1])??33)*3.6)," km/h"]})]})}),_.length>0&&t.jsx(z,{className:"glass-panel",title:"Vehicle Status",children:t.jsx(Se,{size:"small",dataSource:_,rowKey:"vin",pagination:!1,columns:[{title:"",width:12,render:(W,ne,Ie)=>t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:Dt[Ie%Dt.length]}})},{title:"VIN",dataIndex:"vin",ellipsis:!0,render:W=>t.jsx("span",{style:{fontSize:11,fontFamily:"monospace"},children:W})},{title:"Speed",render:(W,ne)=>ne.current?`${(ne.current.speed_mps*3.6).toFixed(0)} km/h`:"-"},{title:"Mode",render:(W,ne)=>ne.current?t.jsx(K,{color:"blue",style:{fontSize:10},children:ne.current.driving_mode}):"-"},{title:"Trail",render:(W,ne)=>t.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:[ne.trail.length," pts"]})}]})})]})]})]})}const Ou="https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",zu='&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>';function ln({center:e=[31.23,121.47],zoom:s=11,style:n={width:"100%",height:"100%",minHeight:400},children:a}){return t.jsxs(Dn,{center:e,zoom:s,style:n,scrollWheelZoom:!0,children:[t.jsx($n,{url:Ou,attribution:zu}),a]})}const Et={Manual:"#8c8c8c",ACC:"#1890ff",LCC:"#52c41a",HighwayPilot:"#fa8c16",UrbanPilot:"#722ed1",Standby:"#595959",Autonomous:"#13c2c2"},Jr={Blocker:"#f5222d",High:"#fa8c16",Medium:"#fadb14",Low:"#8c8c8c"};function Yr(e){return Et[e]??"#8c8c8c"}function Lu(e){return Jr[e]??"#8c8c8c"}function Nu(e){const s=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="${e}" stroke="#fff" stroke-width="2" opacity="0.9"/><circle cx="12" cy="12" r="4" fill="#fff"/></svg>`;return ts.divIcon({html:s,className:"",iconSize:[24,24],iconAnchor:[12,12]})}function Xr({vin:e,lat:s,lng:n,drivingMode:a,speed:r,onClick:i}){const l=Yr(a??"Manual");return t.jsx(qn,{position:[s,n],icon:Nu(l),eventHandlers:{click:i},children:t.jsx(Kn,{children:t.jsxs("div",{style:{fontSize:12,lineHeight:1.6,color:"#fff",minWidth:120},children:[t.jsx("strong",{children:e}),t.jsx("br",{}),"Mode: ",a??"â€”",t.jsx("br",{}),"Speed: ",r!=null?`${r.toFixed(1)} m/s`:"â€”"]})})})}const Du="",$u=`${Du}/api/sse/vehicles`,qu={Offline:"#595959",Idle:"#1890ff",Active:"#52c41a",Maintenance:"#fa8c16"};function Ku(){const e=zt(),[s,n]=m.useState(),[a,r]=m.useState(),[i,l]=m.useState(),[o,d]=m.useState(),{data:u,isLoading:c}=B({queryKey:["vehicles"],queryFn:()=>ta(),refetchInterval:15e3}),{data:h}=B({queryKey:["fleet-distribution"],queryFn:Kc}),{data:y}=B({queryKey:["fleet-status-distribution"],queryFn:Bc}),[f,g]=m.useState({}),v=m.useRef(null);m.useEffect(()=>{const j=new EventSource($u);return v.current=j,j.onmessage=S=>{try{const I=JSON.parse(S.data),F=I.vin;if(!F)return;g(k=>({...k,[F]:{currentLocation:I.current_location,currentSpeed:I.current_speed_mps,drivingMode:I.driving_mode,status:I.current_status}}))}catch{}},()=>{j.close()}},[]);const b=(u??[]).map(j=>{const S=f[j.vin];return S?{...j,...S}:j}),_=b.filter(j=>!(s&&j.plateType!==s||a&&j.modelCode!==a||i&&j.status!==i||o&&j.drivingMode!==o)),R=_.filter(j=>{var S,I;return((S=j.currentLocation)==null?void 0:S.lat)&&((I=j.currentLocation)==null?void 0:I.lng)}),C=[{title:"VIN",dataIndex:"vin",key:"vin",width:180,render:j=>t.jsx("a",{onClick:()=>e(`/fleet/vehicles/${j}`),children:j})},{title:"Plate",dataIndex:"plateType",key:"plateType",width:100,render:j=>j?t.jsx(K,{children:j==="permanent"?"Perm":"Temp"}):"â€”"},{title:"Model",dataIndex:"modelCode",key:"modelCode",width:100,render:j=>j??"â€”"},{title:"Status",dataIndex:"status",key:"status",width:100,render:j=>t.jsx(K,{color:qu[j]??"#595959",children:j})},{title:"Mode",dataIndex:"drivingMode",key:"drivingMode",width:120,render:j=>j?t.jsx(K,{color:Et[j],children:j}):"â€”"},{title:"Speed",dataIndex:"currentSpeed",key:"speed",width:100,render:j=>j!=null?`${j.toFixed(1)} m/s`:"â€”"},{title:"Platform",dataIndex:"platform",key:"platform",width:120,render:j=>j??"â€”"}],w=["#1890ff","#52c41a","#fa8c16","#722ed1","#f5222d","#13c2c2","#fadb14","#595959"],P=j=>{const S=Math.floor(j/36e5),I=Math.floor(j%36e5/6e4);return S>0?`${S}h ${I}m`:`${I}m`};return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(rt,{title:"Fleet Dashboard",subtitle:`${b.length} vehicles`}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(z,{title:"Vehicles",size:"small",className:"glass-card",style:{height:520},extra:t.jsxs(H,{size:"small",children:[t.jsx(ee,{allowClear:!0,placeholder:"Plate",style:{width:100},value:s,onChange:n,options:[{value:"permanent",label:"Perm"},{value:"temporary",label:"Temp"}]}),t.jsx(ee,{allowClear:!0,placeholder:"Model",style:{width:100},value:a,onChange:r,options:((h==null?void 0:h.model_code)??[]).map(j=>({value:j.name,label:j.name}))}),t.jsx(ee,{allowClear:!0,placeholder:"Status",style:{width:100},value:i,onChange:l,options:["Offline","Idle","Active","Maintenance"].map(j=>({value:j,label:j}))}),t.jsx(ee,{allowClear:!0,placeholder:"Mode",style:{width:110},value:o,onChange:d,options:Object.keys(Et).map(j=>({value:j,label:j}))})]}),children:t.jsx(Se,{dataSource:_,columns:C,rowKey:"vin",size:"small",loading:c,scroll:{y:380},pagination:!1,onRow:j=>({onClick:()=>e(`/fleet/vehicles/${j.vin}`),style:{cursor:"pointer"}})})})}),t.jsx(O,{span:12,children:t.jsx(z,{title:"Live Map",size:"small",className:"glass-card",style:{height:520},children:t.jsx("div",{style:{height:460},children:t.jsx(ln,{children:R.map(j=>t.jsx(Xr,{vin:j.vin,lat:j.currentLocation.lat,lng:j.currentLocation.lng,drivingMode:j.drivingMode,speed:j.currentSpeed,onClick:()=>e(`/fleet/vehicles/${j.vin}`)},j.vin))})})})})]}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(z,{title:"Plate Type",size:"small",className:"glass-card",children:t.jsx(Ft,{width:"100%",height:200,children:t.jsxs(en,{children:[t.jsx(tn,{data:(h==null?void 0:h.plate_type)??[],dataKey:"count",nameKey:"name",cx:"50%",cy:"50%",outerRadius:70,label:({name:j,count:S})=>`${j}: ${S}`,children:((h==null?void 0:h.plate_type)??[]).map((j,S)=>t.jsx(es,{fill:w[S%w.length]},S))}),t.jsx(Ae,{})]})})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Model Distribution",size:"small",className:"glass-card",children:t.jsx(Ft,{width:"100%",height:200,children:t.jsxs(Vs,{data:(h==null?void 0:h.model_code)??[],children:[t.jsx(vt,{dataKey:"name",tick:{fill:"#aaa",fontSize:11}}),t.jsx(Ve,{tick:{fill:"#aaa",fontSize:11}}),t.jsx(Ae,{}),t.jsx(Zt,{dataKey:"count",fill:"#1890ff",radius:[4,4,0,0]})]})})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Status Duration Distribution",size:"small",className:"glass-card",children:t.jsx(Ft,{width:"100%",height:200,children:t.jsxs(Vs,{data:y??[],layout:"vertical",children:[t.jsx(vt,{type:"number",tick:{fill:"#aaa",fontSize:11},tickFormatter:j=>P(j)}),t.jsx(Ve,{dataKey:"driving_mode",type:"category",tick:{fill:"#aaa",fontSize:11},width:90}),t.jsx(Ae,{formatter:j=>P(j)}),t.jsx(Zt,{dataKey:"total_duration_ms",fill:"#52c41a",radius:[0,4,4,0]})]})})})})]})]})}function Bu(e){const s=e[0];if(!s)return[];const n=[];let a=s.driving_mode,r=[[s.location.lat,s.location.lng]],i=s.speed_mps,l=s.timestamp;for(let d=1;d<e.length;d++){const u=e[d],c=e[d-1];u.driving_mode!==a&&(n.push({mode:a,positions:[...r],startTime:l,endTime:c.timestamp,avgSpeed:i/r.length}),a=u.driving_mode,r=[[c.location.lat,c.location.lng]],i=0,l=u.timestamp),r.push([u.location.lat,u.location.lng]),i+=u.speed_mps}const o=e[e.length-1];return n.push({mode:a,positions:r,startTime:l,endTime:o.timestamp,avgSpeed:i/r.length}),n}function Zr({points:e}){const s=Bu(e);return t.jsx(t.Fragment,{children:s.map((n,a)=>t.jsx(vs,{positions:n.positions,pathOptions:{color:Yr(n.mode),weight:3,opacity:.85},children:t.jsx(Ws,{sticky:!0,children:t.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:[t.jsx("strong",{children:n.mode}),t.jsx("br",{}),"Avg speed: ",n.avgSpeed.toFixed(1)," m/s",t.jsx("br",{}),n.startTime&&new Date(n.startTime).toLocaleTimeString()," â†’ ",n.endTime&&new Date(n.endTime).toLocaleTimeString()]})})},a))})}const Uu={Offline:"#595959",Idle:"#1890ff",Active:"#52c41a",Maintenance:"#fa8c16"};function Vu(){const{vin:e}=cs(),s=zt(),{data:n,isLoading:a}=B({queryKey:["vehicle",e],queryFn:()=>Dc(e),enabled:!!e}),{data:r}=B({queryKey:["vehicle-status-dist",e],queryFn:()=>$c(e),enabled:!!e}),{data:i}=B({queryKey:["vehicle-trajectory",e],queryFn:()=>qc(e,{limit:"2000"}),enabled:!!e}),{data:l}=B({queryKey:["vehicle-runs",e],queryFn:()=>Ts({vehicleVin:e}),enabled:!!e});if(a)return t.jsx("div",{style:{textAlign:"center",padding:80},children:t.jsx(Ot,{size:"large"})});if(!n)return t.jsx(le,{description:"Vehicle not found"});const o=c=>{const h=Math.floor(c/36e5),y=Math.floor(c%36e5/6e4);return h>0?`${h}h ${y}m`:`${y}m`},d=(r??[]).map(c=>({name:c.driving_mode,value:c.total_duration_ms,mileage:c.total_mileage_km})),u=(l??[]).filter(c=>c.status==="Active"||c.status==="Scheduled");return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(rt,{title:n.vin,subtitle:n.modelCode??n.platform??""}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:12,children:t.jsx(z,{title:"Vehicle Info",size:"small",className:"glass-card",children:t.jsxs(A,{column:2,size:"small",labelStyle:{color:"rgba(255,255,255,0.5)"},contentStyle:{color:"#e0e0e0"},children:[t.jsx(A.Item,{label:"VIN",children:n.vin}),t.jsx(A.Item,{label:"Plate Type",children:n.plateType==="permanent"?"Perm":n.plateType==="temporary"?"Temp":"â€”"}),t.jsx(A.Item,{label:"Model Code",children:n.modelCode??"â€”"}),t.jsx(A.Item,{label:"Platform",children:n.platform??"â€”"}),t.jsx(A.Item,{label:"SoC Arch",children:n.socArchitecture??"â€”"}),t.jsx(A.Item,{label:"Sensor Suite",children:n.sensorSuiteVersion??"â€”"}),n.componentVersions&&Object.entries(n.componentVersions).map(([c,h])=>t.jsx(A.Item,{label:c,children:h},c))]})})}),t.jsx(O,{span:12,children:t.jsx(z,{title:"Real-time Status",size:"small",className:"glass-card",children:t.jsxs(A,{column:2,size:"small",labelStyle:{color:"rgba(255,255,255,0.5)"},contentStyle:{color:"#e0e0e0"},children:[t.jsx(A.Item,{label:"Status",children:t.jsx(K,{color:Uu[n.status],children:n.status})}),t.jsx(A.Item,{label:"Mode",children:n.drivingMode?t.jsx(K,{color:Et[n.drivingMode],children:n.drivingMode}):"â€”"}),t.jsx(A.Item,{label:"Speed",children:n.currentSpeed!=null?`${n.currentSpeed.toFixed(1)} m/s`:"â€”"}),t.jsx(A.Item,{label:"Battery",children:n.fuelOrBatteryLevel!=null?`${n.fuelOrBatteryLevel}%`:"â€”"}),t.jsx(A.Item,{label:"Location",span:2,children:n.currentLocation?`${n.currentLocation.lat.toFixed(5)}, ${n.currentLocation.lng.toFixed(5)}`:"â€”"}),t.jsx(A.Item,{label:"Last Heartbeat",children:n.lastHeartbeat?new Date(n.lastHeartbeat).toLocaleString():"â€”"})]})})})]}),t.jsxs(re,{gutter:16,children:[t.jsx(O,{span:8,children:t.jsx(z,{title:"Active Tasks",size:"small",className:"glass-card",style:{height:320},children:u.length===0?t.jsx(le,{description:"No active tasks",image:le.PRESENTED_IMAGE_SIMPLE}):t.jsx(Se,{dataSource:u,columns:[{title:"Run",dataIndex:"id",key:"id",render:c=>t.jsxs("a",{onClick:()=>s(`/runs/${c}`),children:[c.slice(0,12),"â€¦"]})},{title:"Task",dataIndex:"taskId",key:"task",render:c=>t.jsxs("a",{onClick:()=>s(`/tasks/${c}`),children:[c.slice(0,12),"â€¦"]})},{title:"Status",dataIndex:"status",key:"status",render:c=>t.jsx(K,{color:c==="Active"?"#52c41a":"#1890ff",children:c})}],rowKey:"id",size:"small",pagination:!1,scroll:{y:220}})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Driving Mode Distribution",size:"small",className:"glass-card",style:{height:320},children:t.jsx(Ft,{width:"100%",height:260,children:t.jsxs(en,{children:[t.jsx(tn,{data:d,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,label:({name:c})=>c,children:d.map((c,h)=>t.jsx(es,{fill:Et[c.name]??"#595959"},h))}),t.jsx(Ae,{formatter:c=>o(c)}),t.jsx(at,{})]})})})}),t.jsx(O,{span:8,children:t.jsx(z,{title:"Mode Mileage (km)",size:"small",className:"glass-card",style:{height:320},children:t.jsx(Se,{dataSource:r??[],columns:[{title:"Mode",dataIndex:"driving_mode",key:"mode",render:c=>t.jsx(K,{color:Et[c],children:c})},{title:"Duration",dataIndex:"total_duration_ms",key:"dur",render:c=>o(c)},{title:"Mileage",dataIndex:"total_mileage_km",key:"km",render:c=>`${c.toFixed(2)} km`}],rowKey:"driving_mode",size:"small",pagination:!1,scroll:{y:220}})})})]}),t.jsx(z,{title:"Recent Trajectory",size:"small",className:"glass-card",children:t.jsx("div",{style:{height:400},children:t.jsxs(ln,{center:n.currentLocation?[n.currentLocation.lat,n.currentLocation.lng]:void 0,zoom:13,children:[(i==null?void 0:i.data)&&t.jsx(Zr,{points:i.data}),n.currentLocation&&t.jsx(Xr,{vin:n.vin,lat:n.currentLocation.lat,lng:n.currentLocation.lng,drivingMode:n.drivingMode,speed:n.currentSpeed})]})})})]})}const{RangePicker:Wu}=xs;function Hu(){const[e,s]=m.useState(),[n,a]=m.useState(),[r,i]=m.useState(),[l,o]=m.useState(),[d,u]=m.useState(null),[c,h]=m.useState(),{data:y}=B({queryKey:["projects"],queryFn:()=>us()}),{data:f}=B({queryKey:["tasks",e],queryFn:()=>Ps(e?{projectId:e}:void 0)}),{data:g}=B({queryKey:["runs",n],queryFn:()=>Ts(n?{taskId:n}:void 0)}),{data:v}=B({queryKey:["vehicles-list"],queryFn:()=>ta()}),{data:b,isLoading:_}=B({queryKey:["trajectory",c],queryFn:()=>Uc(c),enabled:!!c}),R=()=>{const j={};l&&(j.vin=l),r?j.run_id=r:n?j.task_id=n:e&&(j.project_id=e),d&&(j.start_time=d[0].toISOString(),j.end_time=d[1].toISOString()),h(j)},C=(b==null?void 0:b.data)??[],w=C.length>0?C[Math.floor(C.length/2)]:void 0,P=w?[w.location.lat,w.location.lng]:void 0;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(rt,{title:"Trajectory Query",subtitle:"Vehicle trajectory by project/task/run/vin"}),t.jsx(z,{size:"small",className:"glass-card",children:t.jsxs(H,{wrap:!0,size:"middle",children:[t.jsx(ee,{allowClear:!0,placeholder:"Project",style:{width:180},value:e,onChange:j=>{s(j),a(void 0),i(void 0)},options:(y??[]).map(j=>({value:j.id,label:j.name})),showSearch:!0,optionFilterProp:"label"}),t.jsx(ee,{allowClear:!0,placeholder:"Task",style:{width:180},value:n,onChange:j=>{a(j),i(void 0)},options:(f??[]).map(j=>({value:j.id,label:j.title})),showSearch:!0,optionFilterProp:"label"}),t.jsx(ee,{allowClear:!0,placeholder:"Run",style:{width:180},value:r,onChange:i,options:(g??[]).map(j=>({value:j.id,label:j.id.slice(0,16)})),showSearch:!0}),t.jsx(ee,{allowClear:!0,placeholder:"Vehicle",style:{width:180},value:l,onChange:o,options:(v??[]).map(j=>({value:j.vin,label:j.vin})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Wu,{showTime:!0,value:d,onChange:j=>u(j)}),t.jsx(q,{type:"primary",onClick:R,loading:_,children:"Search"})]})}),t.jsx(z,{size:"small",className:"glass-card",bodyStyle:{padding:0,height:"calc(100vh - 280px)",minHeight:500},children:c?_?t.jsx("div",{style:{textAlign:"center",paddingTop:100},children:t.jsx(Ot,{size:"large"})}):C.length===0?t.jsx(le,{description:"No trajectory points found",style:{paddingTop:100}}):t.jsx(ln,{center:P,zoom:13,style:{width:"100%",height:"100%"},children:t.jsx(Zr,{points:C})}):t.jsx(le,{description:"Set filters and click Search",style:{paddingTop:100}})}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[Object.entries(Et).map(([j,S])=>t.jsx(K,{color:S,children:j},j)),b&&t.jsxs(K,{children:["Total: ",b.total," points"]})]})]})}function Qu(e){const s=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="28" viewBox="0 0 20 28"><path d="M10 0C4.5 0 0 4.5 0 10c0 7.5 10 18 10 18s10-10.5 10-18C20 4.5 15.5 0 10 0z" fill="${e}" stroke="#fff" stroke-width="1.5"/><circle cx="10" cy="10" r="4" fill="#fff"/></svg>`;return ts.divIcon({html:s,className:"",iconSize:[20,28],iconAnchor:[10,28],popupAnchor:[0,-28]})}function Gu({issue:e}){var n,a;if(!((n=e.location)!=null&&n.lat)||!((a=e.location)!=null&&a.lng))return null;const s=Lu(e.severity);return t.jsx(qn,{position:[e.location.lat,e.location.lng],icon:Qu(s),children:t.jsx(Kn,{children:t.jsxs("div",{style:{fontSize:12,lineHeight:1.6,color:"#fff",minWidth:160},children:[t.jsx("strong",{children:e.issue_id}),t.jsx("br",{}),"Category: ",e.category??"â€”",t.jsx("br",{}),"Severity: ",t.jsx("span",{style:{color:s},children:e.severity}),t.jsx("br",{}),e.description&&t.jsxs("span",{children:[e.description.slice(0,80),e.description.length>80?"â€¦":"",t.jsx("br",{})]}),e.triggered_at&&t.jsxs(t.Fragment,{children:["Time: ",new Date(e.triggered_at).toLocaleString(),t.jsx("br",{})]}),t.jsx("a",{href:`/issues/${e.issue_id}`,style:{color:"#1890ff"},children:"View Detail â†’"})]})})})}const{RangePicker:Ju}=xs;function Yu(){const[e,s]=m.useState(),[n,a]=m.useState(),[r,i]=m.useState(),[l,o]=m.useState(),[d,u]=m.useState(null),[c,h]=m.useState(),{data:y}=B({queryKey:["projects"],queryFn:()=>us()}),{data:f}=B({queryKey:["tasks",e],queryFn:()=>Ps(e?{projectId:e}:void 0)}),{data:g}=B({queryKey:["runs",n],queryFn:()=>Ts(n?{taskId:n}:void 0)}),{data:v}=B({queryKey:["vehicles-list-im"],queryFn:()=>ta()}),{data:b,isLoading:_}=B({queryKey:["issue-locations",c],queryFn:()=>Vc(c),enabled:!!c}),R=()=>{const S={};l&&(S.vin=l),r?S.run_id=r:n?S.task_id=n:e&&(S.project_id=e),d&&(S.start_time=d[0].toISOString(),S.end_time=d[1].toISOString()),h(S)},w=((b==null?void 0:b.data)??[]).filter(S=>{var I,F;return((I=S.location)==null?void 0:I.lat)&&((F=S.location)==null?void 0:F.lng)}),P=w[0],j=P!=null&&P.location?[P.location.lat,P.location.lng]:void 0;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[t.jsx(rt,{title:"Issue Map",subtitle:"Issue locations on map"}),t.jsx(z,{size:"small",className:"glass-card",children:t.jsxs(H,{wrap:!0,size:"middle",children:[t.jsx(ee,{allowClear:!0,placeholder:"Project",style:{width:180},value:e,onChange:S=>{s(S),a(void 0),i(void 0)},options:(y??[]).map(S=>({value:S.id,label:S.name})),showSearch:!0,optionFilterProp:"label"}),t.jsx(ee,{allowClear:!0,placeholder:"Task",style:{width:180},value:n,onChange:S=>{a(S),i(void 0)},options:(f??[]).map(S=>({value:S.id,label:S.title})),showSearch:!0,optionFilterProp:"label"}),t.jsx(ee,{allowClear:!0,placeholder:"Run",style:{width:180},value:r,onChange:i,options:(g??[]).map(S=>({value:S.id,label:S.id.slice(0,16)})),showSearch:!0}),t.jsx(ee,{allowClear:!0,placeholder:"Vehicle",style:{width:180},value:l,onChange:o,options:(v??[]).map(S=>({value:S.vin,label:S.vin})),showSearch:!0,optionFilterProp:"label"}),t.jsx(Ju,{showTime:!0,value:d,onChange:S=>u(S)}),t.jsx(q,{type:"primary",onClick:R,loading:_,children:"Search"})]})}),t.jsx(z,{size:"small",className:"glass-card",bodyStyle:{padding:0,height:"calc(100vh - 280px)",minHeight:500},children:c?_?t.jsx("div",{style:{textAlign:"center",paddingTop:100},children:t.jsx(Ot,{size:"large"})}):w.length===0?t.jsx(le,{description:"No issues with location found",style:{paddingTop:100}}):t.jsx(ln,{center:j,zoom:12,style:{width:"100%",height:"100%"},children:w.map(S=>t.jsx(Gu,{issue:S},S.issue_id))}):t.jsx(le,{description:"Set filters and click Search",style:{paddingTop:100}})}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[Object.entries(Jr).map(([S,I])=>t.jsx(K,{color:I,children:S},S)),b&&t.jsxs(K,{children:["Total: ",b.total," issues, ",w.length," with GPS"]})]})]})}function Xu(){return t.jsx(El,{children:t.jsxs(ue,{element:t.jsx(Cc,{}),children:[t.jsx(ue,{index:!0,element:t.jsx(Pl,{to:"/projects",replace:!0})}),t.jsx(ue,{path:"projects",element:t.jsx(Td,{})}),t.jsx(ue,{path:"projects/:id",element:t.jsx(Ad,{})}),t.jsx(ue,{path:"tasks",element:t.jsx(Od,{})}),t.jsx(ue,{path:"tasks/:id",element:t.jsx(Ld,{})}),t.jsx(ue,{path:"runs",element:t.jsx(Nd,{})}),t.jsx(ue,{path:"runs/:id",element:t.jsx(Dd,{})}),t.jsx(ue,{path:"issues",element:t.jsx($d,{})}),t.jsx(ue,{path:"issues/:id",element:t.jsx(Bd,{})}),t.jsx(ue,{path:"kpi",element:t.jsx(Su,{})}),t.jsx(ue,{path:"traceability",element:t.jsx(_u,{})}),t.jsx(ue,{path:"auto-triage",element:t.jsx(Cu,{})}),t.jsx(ue,{path:"simulation",element:t.jsx(Fu,{})}),t.jsx(ue,{path:"simulation/:id",element:t.jsx(Au,{})}),t.jsx(ue,{path:"fleet",element:t.jsx(Ku,{})}),t.jsx(ue,{path:"fleet/vehicles/:vin",element:t.jsx(Vu,{})}),t.jsx(ue,{path:"fleet/trajectory",element:t.jsx(Hu,{})}),t.jsx(ue,{path:"fleet/issues-map",element:t.jsx(Yu,{})})]})})}const Zu=new zo({defaultOptions:{queries:{staleTime:3e4,retry:1,refetchOnWindowFocus:!1}}}),eh={algorithm:gi.darkAlgorithm,token:{colorPrimary:"#8b929a",colorInfo:"#60a5fa",colorSuccess:"#34d399",colorWarning:"#fbbf24",colorError:"#f87171",colorBgContainer:"rgba(255, 255, 255, 0.06)",colorBgElevated:"rgba(255, 255, 255, 0.10)",colorBgLayout:"transparent",colorBorder:"rgba(255, 255, 255, 0.08)",colorBorderSecondary:"rgba(255, 255, 255, 0.05)",colorText:"#e4e7eb",colorTextSecondary:"#8b929a",colorTextTertiary:"#505660",colorTextQuaternary:"#3a3f47",borderRadius:12,borderRadiusLG:16,borderRadiusSM:8,fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif",fontSize:14,controlHeight:36,wireframe:!1},components:{Layout:{headerBg:"transparent",siderBg:"transparent",bodyBg:"transparent",triggerBg:"rgba(255, 255, 255, 0.06)"},Menu:{darkItemBg:"transparent",darkSubMenuItemBg:"transparent",darkItemSelectedBg:"rgba(255, 255, 255, 0.08)",darkItemHoverBg:"rgba(255, 255, 255, 0.05)",darkItemColor:"#8b929a",darkItemSelectedColor:"#e4e7eb",itemBorderRadius:10,itemMarginInline:8,iconSize:16},Table:{headerBg:"rgba(255, 255, 255, 0.03)",headerColor:"#8b929a",rowHoverBg:"rgba(255, 255, 255, 0.04)",borderColor:"rgba(255, 255, 255, 0.06)",cellPaddingBlock:12,cellPaddingInline:16},Card:{colorBgContainer:"rgba(255, 255, 255, 0.06)",colorBorderSecondary:"rgba(255, 255, 255, 0.08)"},Button:{primaryShadow:"0 2px 8px rgba(139, 146, 154, 0.15)",defaultBg:"rgba(255, 255, 255, 0.06)",defaultBorderColor:"rgba(255, 255, 255, 0.10)",borderRadius:12,borderRadiusLG:12},Input:{colorBgContainer:"rgba(255, 255, 255, 0.04)",activeBorderColor:"#8b929a",hoverBorderColor:"rgba(255, 255, 255, 0.2)"},Select:{colorBgContainer:"rgba(255, 255, 255, 0.04)",optionSelectedBg:"rgba(255, 255, 255, 0.08)"},Tag:{borderRadiusSM:8},Descriptions:{colorSplit:"rgba(255, 255, 255, 0.06)",titleColor:"#8b929a",contentColor:"#e4e7eb"},Timeline:{dotBorderWidth:2,tailColor:"rgba(255, 255, 255, 0.08)"},Breadcrumb:{separatorColor:"#3a3f47",linkColor:"#8b929a",linkHoverColor:"#e4e7eb",lastItemColor:"#e4e7eb"},Statistic:{titleFontSize:12,contentFontSize:28},Progress:{remainingColor:"rgba(255, 255, 255, 0.06)"},Tabs:{inkBarColor:"#e4e7eb",itemSelectedColor:"#e4e7eb",itemColor:"#8b929a",itemHoverColor:"#e4e7eb"},Collapse:{headerBg:"rgba(255, 255, 255, 0.03)",contentBg:"transparent"},Modal:{contentBg:"#18191e",headerBg:"transparent"}}};fi.createRoot(document.getElementById("root")).render(t.jsx(m.StrictMode,{children:t.jsx(so,{children:t.jsx(Lo,{client:Zu,children:t.jsx(yi,{theme:eh,children:t.jsx(xi,{children:t.jsx(Ed,{children:t.jsx(Xu,{})})})})})})}));
